!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("rxjs")):"function"==typeof define&&define.amd?define(["rxjs"],t):"object"==typeof exports?exports.gloperate=t(require("rxjs")):e.gloperate=t(e.rxjs)}(self,(e=>(()=>{var t={3659:(e,t,r)=>{"use strict";r.r(t),r.d(t,{glMatrix:()=>i,mat2:()=>n,mat2d:()=>s,mat3:()=>a,mat4:()=>o,quat:()=>l,quat2:()=>u,vec2:()=>d,vec3:()=>c,vec4:()=>h});var i={};r.r(i),r.d(i,{ARRAY_TYPE:()=>f,EPSILON:()=>_,RANDOM:()=>p,equals:()=>b,setMatrixArrayType:()=>m,toRadian:()=>g});var n={};r.r(n),r.d(n,{LDU:()=>C,add:()=>D,adjoint:()=>L,clone:()=>y,copy:()=>x,create:()=>E,determinant:()=>P,equals:()=>U,exactEquals:()=>j,frob:()=>B,fromRotation:()=>I,fromScaling:()=>z,fromValues:()=>A,identity:()=>T,invert:()=>R,mul:()=>X,multiply:()=>F,multiplyScalar:()=>k,multiplyScalarAndAdd:()=>V,rotate:()=>w,scale:()=>O,set:()=>S,str:()=>N,sub:()=>H,subtract:()=>G,transpose:()=>M});var s={};r.r(s),r.d(s,{add:()=>he,clone:()=>$,copy:()=>q,create:()=>W,determinant:()=>Q,equals:()=>fe,exactEquals:()=>_e,frob:()=>ce,fromRotation:()=>ne,fromScaling:()=>se,fromTranslation:()=>ae,fromValues:()=>Z,identity:()=>Y,invert:()=>J,mul:()=>pe,multiply:()=>ee,multiplyScalar:()=>ue,multiplyScalarAndAdd:()=>de,rotate:()=>te,scale:()=>re,set:()=>K,str:()=>oe,sub:()=>me,subtract:()=>le,translate:()=>ie});var a={};r.r(a),r.d(a,{add:()=>Ue,adjoint:()=>Me,clone:()=>be,copy:()=>Ee,create:()=>ve,determinant:()=>Re,equals:()=>We,exactEquals:()=>He,frob:()=>je,fromMat2d:()=>Ne,fromMat4:()=>ge,fromQuat:()=>Be,fromRotation:()=>Ie,fromScaling:()=>ze,fromTranslation:()=>Oe,fromValues:()=>ye,identity:()=>Te,invert:()=>Se,mul:()=>$e,multiply:()=>Le,multiplyScalar:()=>Ve,multiplyScalarAndAdd:()=>Xe,normalFromMat4:()=>Ce,projection:()=>De,rotate:()=>Fe,scale:()=>we,set:()=>xe,str:()=>Ge,sub:()=>qe,subtract:()=>ke,translate:()=>Pe,transpose:()=>Ae});var o={};r.r(o),r.d(o,{add:()=>zt,adjoint:()=>it,clone:()=>Ze,copy:()=>Ke,create:()=>Ye,determinant:()=>nt,equals:()=>Gt,exactEquals:()=>Dt,frob:()=>It,fromQuat:()=>St,fromQuat2:()=>bt,fromRotation:()=>ft,fromRotationTranslation:()=>gt,fromRotationTranslationScale:()=>Tt,fromRotationTranslationScaleOrigin:()=>At,fromScaling:()=>_t,fromTranslation:()=>dt,fromValues:()=>Je,fromXRotation:()=>pt,fromYRotation:()=>mt,fromZRotation:()=>vt,frustum:()=>Mt,getRotation:()=>xt,getScaling:()=>yt,getTranslation:()=>Et,identity:()=>et,invert:()=>rt,lookAt:()=>Ft,mul:()=>jt,multiply:()=>st,multiplyScalar:()=>Bt,multiplyScalarAndAdd:()=>Ct,ortho:()=>Pt,perspective:()=>Rt,perspectiveFromFieldOfView:()=>Lt,rotate:()=>ct,rotateX:()=>ht,rotateY:()=>lt,rotateZ:()=>ut,scale:()=>ot,set:()=>Qe,str:()=>Ot,sub:()=>Ut,subtract:()=>Nt,targetTo:()=>wt,translate:()=>at,transpose:()=>tt});var c={};r.r(c),r.d(c,{add:()=>qt,angle:()=>Tr,bezier:()=>pr,ceil:()=>Jt,clone:()=>Vt,copy:()=>Wt,create:()=>kt,cross:()=>dr,dist:()=>Or,distance:()=>sr,div:()=>wr,divide:()=>Kt,dot:()=>ur,equals:()=>Rr,exactEquals:()=>Mr,floor:()=>Qt,forEach:()=>Br,fromValues:()=>Ht,hermite:()=>fr,inverse:()=>hr,len:()=>zr,length:()=>Xt,lerp:()=>_r,max:()=>tr,min:()=>er,mul:()=>Fr,multiply:()=>Zt,negate:()=>cr,normalize:()=>lr,random:()=>mr,rotateX:()=>Er,rotateY:()=>yr,rotateZ:()=>xr,round:()=>rr,scale:()=>ir,scaleAndAdd:()=>nr,set:()=>$t,sqrDist:()=>Ir,sqrLen:()=>Nr,squaredDistance:()=>ar,squaredLength:()=>or,str:()=>Sr,sub:()=>Pr,subtract:()=>Yt,transformMat3:()=>gr,transformMat4:()=>vr,transformQuat:()=>br,zero:()=>Ar});var h={};r.r(h),r.d(h,{add:()=>kr,ceil:()=>Wr,clone:()=>Dr,copy:()=>jr,create:()=>Cr,cross:()=>oi,dist:()=>bi,distance:()=>Qr,div:()=>gi,divide:()=>Hr,dot:()=>ai,equals:()=>pi,exactEquals:()=>fi,floor:()=>$r,forEach:()=>Ti,fromValues:()=>Gr,inverse:()=>ni,len:()=>yi,length:()=>ti,lerp:()=>ci,max:()=>Yr,min:()=>qr,mul:()=>vi,multiply:()=>Xr,negate:()=>ii,normalize:()=>si,random:()=>hi,round:()=>Zr,scale:()=>Kr,scaleAndAdd:()=>Jr,set:()=>Ur,sqrDist:()=>Ei,sqrLen:()=>xi,squaredDistance:()=>ei,squaredLength:()=>ri,str:()=>_i,sub:()=>mi,subtract:()=>Vr,transformMat4:()=>li,transformQuat:()=>ui,zero:()=>di});var l={};r.r(l),r.d(l,{add:()=>en,calculateW:()=>Ii,clone:()=>Zi,conjugate:()=>ji,copy:()=>Ji,create:()=>Ai,dot:()=>nn,equals:()=>dn,exactEquals:()=>un,exp:()=>zi,fromEuler:()=>ki,fromMat3:()=>Ui,fromValues:()=>Ki,getAngle:()=>Li,getAxisAngle:()=>Ri,identity:()=>Si,invert:()=>Gi,len:()=>on,length:()=>an,lerp:()=>sn,ln:()=>Ni,mul:()=>tn,multiply:()=>Pi,normalize:()=>ln,pow:()=>Bi,random:()=>Di,rotateX:()=>Fi,rotateY:()=>wi,rotateZ:()=>Oi,rotationTo:()=>_n,scale:()=>rn,set:()=>Qi,setAxes:()=>pn,setAxisAngle:()=>Mi,slerp:()=>Ci,sqlerp:()=>fn,sqrLen:()=>hn,squaredLength:()=>cn,str:()=>Vi});var u={};r.r(u),r.d(u,{add:()=>Gn,clone:()=>vn,conjugate:()=>Wn,copy:()=>An,create:()=>mn,dot:()=>Vn,equals:()=>es,exactEquals:()=>Qn,fromMat4:()=>Tn,fromRotation:()=>xn,fromRotationTranslation:()=>En,fromRotationTranslationValues:()=>bn,fromTranslation:()=>yn,fromValues:()=>gn,getDual:()=>Ln,getReal:()=>Rn,getTranslation:()=>wn,identity:()=>Sn,invert:()=>Hn,len:()=>qn,length:()=>$n,lerp:()=>Xn,mul:()=>Un,multiply:()=>jn,normalize:()=>Kn,rotateAroundAxis:()=>Dn,rotateByQuatAppend:()=>Bn,rotateByQuatPrepend:()=>Cn,rotateX:()=>In,rotateY:()=>zn,rotateZ:()=>Nn,scale:()=>kn,set:()=>Mn,setDual:()=>Fn,setReal:()=>Pn,sqrLen:()=>Zn,squaredLength:()=>Yn,str:()=>Jn,translate:()=>On});var d={};r.r(d),r.d(d,{add:()=>as,angle:()=>Is,ceil:()=>ls,clone:()=>rs,copy:()=>ns,create:()=>ts,cross:()=>Ss,dist:()=>ks,distance:()=>vs,div:()=>Us,divide:()=>hs,dot:()=>As,equals:()=>Cs,exactEquals:()=>Bs,floor:()=>us,forEach:()=>Hs,fromValues:()=>is,inverse:()=>xs,len:()=>Ds,length:()=>bs,lerp:()=>Ms,max:()=>_s,min:()=>ds,mul:()=>js,multiply:()=>cs,negate:()=>ys,normalize:()=>Ts,random:()=>Rs,rotate:()=>Os,round:()=>fs,scale:()=>ps,scaleAndAdd:()=>ms,set:()=>ss,sqrDist:()=>Vs,sqrLen:()=>Xs,squaredDistance:()=>gs,squaredLength:()=>Es,str:()=>Ns,sub:()=>Gs,subtract:()=>os,transformMat2:()=>Ls,transformMat2d:()=>Ps,transformMat3:()=>Fs,transformMat4:()=>ws,zero:()=>zs});var _=1e-6,f="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function m(e){f=e}var v=Math.PI/180;function g(e){return e*v}function b(e,t){return Math.abs(e-t)<=_*Math.max(1,Math.abs(e),Math.abs(t))}function E(){var e=new f(4);return f!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function y(e){var t=new f(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function T(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function A(e,t,r,i){var n=new f(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function S(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function M(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function R(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*s-n*i;return a?(a=1/a,e[0]=s*a,e[1]=-i*a,e[2]=-n*a,e[3]=r*a,e):null}function L(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}function P(e){return e[0]*e[3]-e[2]*e[1]}function F(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],c=r[1],h=r[2],l=r[3];return e[0]=i*o+s*c,e[1]=n*o+a*c,e[2]=i*h+s*l,e[3]=n*h+a*l,e}function w(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c+s*o,e[1]=n*c+a*o,e[2]=i*-o+s*c,e[3]=n*-o+a*c,e}function O(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],c=r[1];return e[0]=i*o,e[1]=n*o,e[2]=s*c,e[3]=a*c,e}function I(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e}function z(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function N(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function B(e){return Math.hypot(e[0],e[1],e[2],e[3])}function C(e,t,r,i){return e[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-e[2]*r[1],[e,t,r]}function D(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function G(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function j(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function U(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=t[0],o=t[1],c=t[2],h=t[3];return Math.abs(r-a)<=_*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=_*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-c)<=_*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-h)<=_*Math.max(1,Math.abs(s),Math.abs(h))}function k(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function V(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var X=F,H=G;function W(){var e=new f(6);return f!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function $(e){var t=new f(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function q(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Y(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Z(e,t,r,i,n,s){var a=new f(6);return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a[4]=n,a[5]=s,a}function K(e,t,r,i,n,s,a){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e}function J(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],c=r*s-i*n;return c?(c=1/c,e[0]=s*c,e[1]=-i*c,e[2]=-n*c,e[3]=r*c,e[4]=(n*o-s*a)*c,e[5]=(i*a-r*o)*c,e):null}function Q(e){return e[0]*e[3]-e[1]*e[2]}function ee(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=r[0],l=r[1],u=r[2],d=r[3],_=r[4],f=r[5];return e[0]=i*h+s*l,e[1]=n*h+a*l,e[2]=i*u+s*d,e[3]=n*u+a*d,e[4]=i*_+s*f+o,e[5]=n*_+a*f+c,e}function te(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=Math.sin(r),l=Math.cos(r);return e[0]=i*l+s*h,e[1]=n*l+a*h,e[2]=i*-h+s*l,e[3]=n*-h+a*l,e[4]=o,e[5]=c,e}function re(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=r[0],l=r[1];return e[0]=i*h,e[1]=n*h,e[2]=s*l,e[3]=a*l,e[4]=o,e[5]=c,e}function ie(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=r[0],l=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=i*h+s*l+o,e[5]=n*h+a*l+c,e}function ne(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e}function se(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function ae(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function oe(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function ce(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)}function he(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function le(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function ue(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function de(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e}function _e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function fe(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],c=t[0],h=t[1],l=t[2],u=t[3],d=t[4],f=t[5];return Math.abs(r-c)<=_*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-h)<=_*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-l)<=_*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-u)<=_*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(a-d)<=_*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-f)<=_*Math.max(1,Math.abs(o),Math.abs(f))}var pe=ee,me=le;function ve(){var e=new f(9);return f!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ge(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function be(e){var t=new f(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ee(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ye(e,t,r,i,n,s,a,o,c){var h=new f(9);return h[0]=e,h[1]=t,h[2]=r,h[3]=i,h[4]=n,h[5]=s,h[6]=a,h[7]=o,h[8]=c,h}function xe(e,t,r,i,n,s,a,o,c,h){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=c,e[8]=h,e}function Te(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ae(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Se(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],c=t[6],h=t[7],l=t[8],u=l*a-o*h,d=-l*s+o*c,_=h*s-a*c,f=r*u+i*d+n*_;return f?(f=1/f,e[0]=u*f,e[1]=(-l*i+n*h)*f,e[2]=(o*i-n*a)*f,e[3]=d*f,e[4]=(l*r-n*c)*f,e[5]=(-o*r+n*s)*f,e[6]=_*f,e[7]=(-h*r+i*c)*f,e[8]=(a*r-i*s)*f,e):null}function Me(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],c=t[6],h=t[7],l=t[8];return e[0]=a*l-o*h,e[1]=n*h-i*l,e[2]=i*o-n*a,e[3]=o*c-s*l,e[4]=r*l-n*c,e[5]=n*s-r*o,e[6]=s*h-a*c,e[7]=i*c-r*h,e[8]=r*a-i*s,e}function Re(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],c=e[7],h=e[8];return t*(h*s-a*c)+r*(-h*n+a*o)+i*(c*n-s*o)}function Le(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=t[8],d=r[0],_=r[1],f=r[2],p=r[3],m=r[4],v=r[5],g=r[6],b=r[7],E=r[8];return e[0]=d*i+_*a+f*h,e[1]=d*n+_*o+f*l,e[2]=d*s+_*c+f*u,e[3]=p*i+m*a+v*h,e[4]=p*n+m*o+v*l,e[5]=p*s+m*c+v*u,e[6]=g*i+b*a+E*h,e[7]=g*n+b*o+E*l,e[8]=g*s+b*c+E*u,e}function Pe(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=t[8],d=r[0],_=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=o,e[5]=c,e[6]=d*i+_*a+h,e[7]=d*n+_*o+l,e[8]=d*s+_*c+u,e}function Fe(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=t[8],d=Math.sin(r),_=Math.cos(r);return e[0]=_*i+d*a,e[1]=_*n+d*o,e[2]=_*s+d*c,e[3]=_*a-d*i,e[4]=_*o-d*n,e[5]=_*c-d*s,e[6]=h,e[7]=l,e[8]=u,e}function we(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Oe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Ie(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ze(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ne(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Be(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,c=n+n,h=r*a,l=i*a,u=i*o,d=n*a,_=n*o,f=n*c,p=s*a,m=s*o,v=s*c;return e[0]=1-u-f,e[3]=l-v,e[6]=d+m,e[1]=l+v,e[4]=1-h-f,e[7]=_-p,e[2]=d-m,e[5]=_+p,e[8]=1-h-u,e}function Ce(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],c=t[6],h=t[7],l=t[8],u=t[9],d=t[10],_=t[11],f=t[12],p=t[13],m=t[14],v=t[15],g=r*o-i*a,b=r*c-n*a,E=r*h-s*a,y=i*c-n*o,x=i*h-s*o,T=n*h-s*c,A=l*p-u*f,S=l*m-d*f,M=l*v-_*f,R=u*m-d*p,L=u*v-_*p,P=d*v-_*m,F=g*P-b*L+E*R+y*M-x*S+T*A;return F?(F=1/F,e[0]=(o*P-c*L+h*R)*F,e[1]=(c*M-a*P-h*S)*F,e[2]=(a*L-o*M+h*A)*F,e[3]=(n*L-i*P-s*R)*F,e[4]=(r*P-n*M+s*S)*F,e[5]=(i*M-r*L-s*A)*F,e[6]=(p*T-m*x+v*y)*F,e[7]=(m*E-f*T-v*b)*F,e[8]=(f*x-p*E+v*g)*F,e):null}function De(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Ge(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function je(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Ue(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function ke(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function Ve(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function Xe(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e}function He(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function We(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],l=e[8],u=t[0],d=t[1],f=t[2],p=t[3],m=t[4],v=t[5],g=t[6],b=t[7],E=t[8];return Math.abs(r-u)<=_*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-d)<=_*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(n-f)<=_*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(s-p)<=_*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-m)<=_*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-v)<=_*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(c-g)<=_*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-b)<=_*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(l-E)<=_*Math.max(1,Math.abs(l),Math.abs(E))}var $e=Le,qe=ke;function Ye(){var e=new f(16);return f!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ze(e){var t=new f(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ke(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Je(e,t,r,i,n,s,a,o,c,h,l,u,d,_,p,m){var v=new f(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=i,v[4]=n,v[5]=s,v[6]=a,v[7]=o,v[8]=c,v[9]=h,v[10]=l,v[11]=u,v[12]=d,v[13]=_,v[14]=p,v[15]=m,v}function Qe(e,t,r,i,n,s,a,o,c,h,l,u,d,_,f,p,m){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=c,e[8]=h,e[9]=l,e[10]=u,e[11]=d,e[12]=_,e[13]=f,e[14]=p,e[15]=m,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tt(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=s,e[11]=t[14],e[12]=n,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function rt(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],c=t[6],h=t[7],l=t[8],u=t[9],d=t[10],_=t[11],f=t[12],p=t[13],m=t[14],v=t[15],g=r*o-i*a,b=r*c-n*a,E=r*h-s*a,y=i*c-n*o,x=i*h-s*o,T=n*h-s*c,A=l*p-u*f,S=l*m-d*f,M=l*v-_*f,R=u*m-d*p,L=u*v-_*p,P=d*v-_*m,F=g*P-b*L+E*R+y*M-x*S+T*A;return F?(F=1/F,e[0]=(o*P-c*L+h*R)*F,e[1]=(n*L-i*P-s*R)*F,e[2]=(p*T-m*x+v*y)*F,e[3]=(d*x-u*T-_*y)*F,e[4]=(c*M-a*P-h*S)*F,e[5]=(r*P-n*M+s*S)*F,e[6]=(m*E-f*T-v*b)*F,e[7]=(l*T-d*E+_*b)*F,e[8]=(a*L-o*M+h*A)*F,e[9]=(i*M-r*L-s*A)*F,e[10]=(f*x-p*E+v*g)*F,e[11]=(u*E-l*x-_*g)*F,e[12]=(o*S-a*R-c*A)*F,e[13]=(r*R-i*S+n*A)*F,e[14]=(p*b-f*y-m*g)*F,e[15]=(l*y-u*b+d*g)*F,e):null}function it(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],c=t[6],h=t[7],l=t[8],u=t[9],d=t[10],_=t[11],f=t[12],p=t[13],m=t[14],v=t[15];return e[0]=o*(d*v-_*m)-u*(c*v-h*m)+p*(c*_-h*d),e[1]=-(i*(d*v-_*m)-u*(n*v-s*m)+p*(n*_-s*d)),e[2]=i*(c*v-h*m)-o*(n*v-s*m)+p*(n*h-s*c),e[3]=-(i*(c*_-h*d)-o*(n*_-s*d)+u*(n*h-s*c)),e[4]=-(a*(d*v-_*m)-l*(c*v-h*m)+f*(c*_-h*d)),e[5]=r*(d*v-_*m)-l*(n*v-s*m)+f*(n*_-s*d),e[6]=-(r*(c*v-h*m)-a*(n*v-s*m)+f*(n*h-s*c)),e[7]=r*(c*_-h*d)-a*(n*_-s*d)+l*(n*h-s*c),e[8]=a*(u*v-_*p)-l*(o*v-h*p)+f*(o*_-h*u),e[9]=-(r*(u*v-_*p)-l*(i*v-s*p)+f*(i*_-s*u)),e[10]=r*(o*v-h*p)-a*(i*v-s*p)+f*(i*h-s*o),e[11]=-(r*(o*_-h*u)-a*(i*_-s*u)+l*(i*h-s*o)),e[12]=-(a*(u*m-d*p)-l*(o*m-c*p)+f*(o*d-c*u)),e[13]=r*(u*m-d*p)-l*(i*m-n*p)+f*(i*d-n*u),e[14]=-(r*(o*m-c*p)-a*(i*m-n*p)+f*(i*c-n*o)),e[15]=r*(o*d-c*u)-a*(i*d-n*u)+l*(i*c-n*o),e}function nt(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],c=e[7],h=e[8],l=e[9],u=e[10],d=e[11],_=e[12],f=e[13],p=e[14],m=e[15];return(t*a-r*s)*(u*m-d*p)-(t*o-i*s)*(l*m-d*f)+(t*c-n*s)*(l*p-u*f)+(r*o-i*a)*(h*m-d*_)-(r*c-n*a)*(h*p-u*_)+(i*c-n*o)*(h*f-l*_)}function st(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=t[8],d=t[9],_=t[10],f=t[11],p=t[12],m=t[13],v=t[14],g=t[15],b=r[0],E=r[1],y=r[2],x=r[3];return e[0]=b*i+E*o+y*u+x*p,e[1]=b*n+E*c+y*d+x*m,e[2]=b*s+E*h+y*_+x*v,e[3]=b*a+E*l+y*f+x*g,b=r[4],E=r[5],y=r[6],x=r[7],e[4]=b*i+E*o+y*u+x*p,e[5]=b*n+E*c+y*d+x*m,e[6]=b*s+E*h+y*_+x*v,e[7]=b*a+E*l+y*f+x*g,b=r[8],E=r[9],y=r[10],x=r[11],e[8]=b*i+E*o+y*u+x*p,e[9]=b*n+E*c+y*d+x*m,e[10]=b*s+E*h+y*_+x*v,e[11]=b*a+E*l+y*f+x*g,b=r[12],E=r[13],y=r[14],x=r[15],e[12]=b*i+E*o+y*u+x*p,e[13]=b*n+E*c+y*d+x*m,e[14]=b*s+E*h+y*_+x*v,e[15]=b*a+E*l+y*f+x*g,e}function at(e,t,r){var i,n,s,a,o,c,h,l,u,d,_,f,p=r[0],m=r[1],v=r[2];return t===e?(e[12]=t[0]*p+t[4]*m+t[8]*v+t[12],e[13]=t[1]*p+t[5]*m+t[9]*v+t[13],e[14]=t[2]*p+t[6]*m+t[10]*v+t[14],e[15]=t[3]*p+t[7]*m+t[11]*v+t[15]):(i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=t[8],d=t[9],_=t[10],f=t[11],e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=o,e[5]=c,e[6]=h,e[7]=l,e[8]=u,e[9]=d,e[10]=_,e[11]=f,e[12]=i*p+o*m+u*v+t[12],e[13]=n*p+c*m+d*v+t[13],e[14]=s*p+h*m+_*v+t[14],e[15]=a*p+l*m+f*v+t[15]),e}function ot(e,t,r){var i=r[0],n=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ct(e,t,r,i){var n,s,a,o,c,h,l,u,d,f,p,m,v,g,b,E,y,x,T,A,S,M,R,L,P=i[0],F=i[1],w=i[2],O=Math.hypot(P,F,w);return O<_?null:(P*=O=1/O,F*=O,w*=O,n=Math.sin(r),a=1-(s=Math.cos(r)),o=t[0],c=t[1],h=t[2],l=t[3],u=t[4],d=t[5],f=t[6],p=t[7],m=t[8],v=t[9],g=t[10],b=t[11],E=P*P*a+s,y=F*P*a+w*n,x=w*P*a-F*n,T=P*F*a-w*n,A=F*F*a+s,S=w*F*a+P*n,M=P*w*a+F*n,R=F*w*a-P*n,L=w*w*a+s,e[0]=o*E+u*y+m*x,e[1]=c*E+d*y+v*x,e[2]=h*E+f*y+g*x,e[3]=l*E+p*y+b*x,e[4]=o*T+u*A+m*S,e[5]=c*T+d*A+v*S,e[6]=h*T+f*A+g*S,e[7]=l*T+p*A+b*S,e[8]=o*M+u*R+m*L,e[9]=c*M+d*R+v*L,e[10]=h*M+f*R+g*L,e[11]=l*M+p*R+b*L,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ht(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[4],a=t[5],o=t[6],c=t[7],h=t[8],l=t[9],u=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*n+h*i,e[5]=a*n+l*i,e[6]=o*n+u*i,e[7]=c*n+d*i,e[8]=h*n-s*i,e[9]=l*n-a*i,e[10]=u*n-o*i,e[11]=d*n-c*i,e}function lt(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],a=t[1],o=t[2],c=t[3],h=t[8],l=t[9],u=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n-h*i,e[1]=a*n-l*i,e[2]=o*n-u*i,e[3]=c*n-d*i,e[8]=s*i+h*n,e[9]=a*i+l*n,e[10]=o*i+u*n,e[11]=c*i+d*n,e}function ut(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],a=t[1],o=t[2],c=t[3],h=t[4],l=t[5],u=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n+h*i,e[1]=a*n+l*i,e[2]=o*n+u*i,e[3]=c*n+d*i,e[4]=h*n-s*i,e[5]=l*n-a*i,e[6]=u*n-o*i,e[7]=d*n-c*i,e}function dt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function _t(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ft(e,t,r){var i,n,s,a=r[0],o=r[1],c=r[2],h=Math.hypot(a,o,c);return h<_?null:(a*=h=1/h,o*=h,c*=h,i=Math.sin(t),s=1-(n=Math.cos(t)),e[0]=a*a*s+n,e[1]=o*a*s+c*i,e[2]=c*a*s-o*i,e[3]=0,e[4]=a*o*s-c*i,e[5]=o*o*s+n,e[6]=c*o*s+a*i,e[7]=0,e[8]=a*c*s+o*i,e[9]=o*c*s-a*i,e[10]=c*c*s+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function pt(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mt(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function vt(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gt(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=i+i,c=n+n,h=s+s,l=i*o,u=i*c,d=i*h,_=n*c,f=n*h,p=s*h,m=a*o,v=a*c,g=a*h;return e[0]=1-(_+p),e[1]=u+g,e[2]=d-v,e[3]=0,e[4]=u-g,e[5]=1-(l+p),e[6]=f+m,e[7]=0,e[8]=d+v,e[9]=f-m,e[10]=1-(l+_),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function bt(e,t){var r=new f(3),i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=i*i+n*n+s*s+a*a;return u>0?(r[0]=2*(o*a+l*i+c*s-h*n)/u,r[1]=2*(c*a+l*n+h*i-o*s)/u,r[2]=2*(h*a+l*s+o*n-c*i)/u):(r[0]=2*(o*a+l*i+c*s-h*n),r[1]=2*(c*a+l*n+h*i-o*s),r[2]=2*(h*a+l*s+o*n-c*i)),gt(e,t,r),e}function Et(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function yt(e,t){var r=t[0],i=t[1],n=t[2],s=t[4],a=t[5],o=t[6],c=t[8],h=t[9],l=t[10];return e[0]=Math.hypot(r,i,n),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(c,h,l),e}function xt(e,t){var r=new f(3);yt(r,t);var i=1/r[0],n=1/r[1],s=1/r[2],a=t[0]*i,o=t[1]*n,c=t[2]*s,h=t[4]*i,l=t[5]*n,u=t[6]*s,d=t[8]*i,_=t[9]*n,p=t[10]*s,m=a+l+p,v=0;return m>0?(v=2*Math.sqrt(m+1),e[3]=.25*v,e[0]=(u-_)/v,e[1]=(d-c)/v,e[2]=(o-h)/v):a>l&&a>p?(v=2*Math.sqrt(1+a-l-p),e[3]=(u-_)/v,e[0]=.25*v,e[1]=(o+h)/v,e[2]=(d+c)/v):l>p?(v=2*Math.sqrt(1+l-a-p),e[3]=(d-c)/v,e[0]=(o+h)/v,e[1]=.25*v,e[2]=(u+_)/v):(v=2*Math.sqrt(1+p-a-l),e[3]=(o-h)/v,e[0]=(d+c)/v,e[1]=(u+_)/v,e[2]=.25*v),e}function Tt(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3],c=n+n,h=s+s,l=a+a,u=n*c,d=n*h,_=n*l,f=s*h,p=s*l,m=a*l,v=o*c,g=o*h,b=o*l,E=i[0],y=i[1],x=i[2];return e[0]=(1-(f+m))*E,e[1]=(d+b)*E,e[2]=(_-g)*E,e[3]=0,e[4]=(d-b)*y,e[5]=(1-(u+m))*y,e[6]=(p+v)*y,e[7]=0,e[8]=(_+g)*x,e[9]=(p-v)*x,e[10]=(1-(u+f))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function At(e,t,r,i,n){var s=t[0],a=t[1],o=t[2],c=t[3],h=s+s,l=a+a,u=o+o,d=s*h,_=s*l,f=s*u,p=a*l,m=a*u,v=o*u,g=c*h,b=c*l,E=c*u,y=i[0],x=i[1],T=i[2],A=n[0],S=n[1],M=n[2],R=(1-(p+v))*y,L=(_+E)*y,P=(f-b)*y,F=(_-E)*x,w=(1-(d+v))*x,O=(m+g)*x,I=(f+b)*T,z=(m-g)*T,N=(1-(d+p))*T;return e[0]=R,e[1]=L,e[2]=P,e[3]=0,e[4]=F,e[5]=w,e[6]=O,e[7]=0,e[8]=I,e[9]=z,e[10]=N,e[11]=0,e[12]=r[0]+A-(R*A+F*S+I*M),e[13]=r[1]+S-(L*A+w*S+z*M),e[14]=r[2]+M-(P*A+O*S+N*M),e[15]=1,e}function St(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,c=n+n,h=r*a,l=i*a,u=i*o,d=n*a,_=n*o,f=n*c,p=s*a,m=s*o,v=s*c;return e[0]=1-u-f,e[1]=l+v,e[2]=d-m,e[3]=0,e[4]=l-v,e[5]=1-h-f,e[6]=_+p,e[7]=0,e[8]=d+m,e[9]=_-p,e[10]=1-h-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mt(e,t,r,i,n,s,a){var o=1/(r-t),c=1/(n-i),h=1/(s-a);return e[0]=2*s*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*c,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(n+i)*c,e[10]=(a+s)*h,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*h,e[15]=0,e}function Rt(e,t,r,i,n){var s,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(s=1/(i-n),e[10]=(n+i)*s,e[14]=2*n*i*s):(e[10]=-1,e[14]=-2*i),e}function Lt(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),c=2/(a+o),h=2/(n+s);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=h,e[6]=0,e[7]=0,e[8]=-(a-o)*c*.5,e[9]=(n-s)*h*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function Pt(e,t,r,i,n,s,a){var o=1/(t-r),c=1/(i-n),h=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*h,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*c,e[14]=(a+s)*h,e[15]=1,e}function Ft(e,t,r,i){var n,s,a,o,c,h,l,u,d,f,p=t[0],m=t[1],v=t[2],g=i[0],b=i[1],E=i[2],y=r[0],x=r[1],T=r[2];return Math.abs(p-y)<_&&Math.abs(m-x)<_&&Math.abs(v-T)<_?et(e):(l=p-y,u=m-x,d=v-T,n=b*(d*=f=1/Math.hypot(l,u,d))-E*(u*=f),s=E*(l*=f)-g*d,a=g*u-b*l,(f=Math.hypot(n,s,a))?(n*=f=1/f,s*=f,a*=f):(n=0,s=0,a=0),o=u*a-d*s,c=d*n-l*a,h=l*s-u*n,(f=Math.hypot(o,c,h))?(o*=f=1/f,c*=f,h*=f):(o=0,c=0,h=0),e[0]=n,e[1]=o,e[2]=l,e[3]=0,e[4]=s,e[5]=c,e[6]=u,e[7]=0,e[8]=a,e[9]=h,e[10]=d,e[11]=0,e[12]=-(n*p+s*m+a*v),e[13]=-(o*p+c*m+h*v),e[14]=-(l*p+u*m+d*v),e[15]=1,e)}function wt(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=i[0],c=i[1],h=i[2],l=n-r[0],u=s-r[1],d=a-r[2],_=l*l+u*u+d*d;_>0&&(l*=_=1/Math.sqrt(_),u*=_,d*=_);var f=c*d-h*u,p=h*l-o*d,m=o*u-c*l;return(_=f*f+p*p+m*m)>0&&(f*=_=1/Math.sqrt(_),p*=_,m*=_),e[0]=f,e[1]=p,e[2]=m,e[3]=0,e[4]=u*m-d*p,e[5]=d*f-l*m,e[6]=l*p-u*f,e[7]=0,e[8]=l,e[9]=u,e[10]=d,e[11]=0,e[12]=n,e[13]=s,e[14]=a,e[15]=1,e}function Ot(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function It(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function zt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Nt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Bt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Ct(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function Dt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Gt(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],l=e[8],u=e[9],d=e[10],f=e[11],p=e[12],m=e[13],v=e[14],g=e[15],b=t[0],E=t[1],y=t[2],x=t[3],T=t[4],A=t[5],S=t[6],M=t[7],R=t[8],L=t[9],P=t[10],F=t[11],w=t[12],O=t[13],I=t[14],z=t[15];return Math.abs(r-b)<=_*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-E)<=_*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(n-y)<=_*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(s-x)<=_*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(a-T)<=_*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(o-A)<=_*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(c-S)<=_*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(h-M)<=_*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(l-R)<=_*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(u-L)<=_*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(d-P)<=_*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-F)<=_*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(p-w)<=_*Math.max(1,Math.abs(p),Math.abs(w))&&Math.abs(m-O)<=_*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(v-I)<=_*Math.max(1,Math.abs(v),Math.abs(I))&&Math.abs(g-z)<=_*Math.max(1,Math.abs(g),Math.abs(z))}var jt=st,Ut=Nt;function kt(){var e=new f(3);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Vt(e){var t=new f(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Xt(e){var t=e[0],r=e[1],i=e[2];return Math.hypot(t,r,i)}function Ht(e,t,r){var i=new f(3);return i[0]=e,i[1]=t,i[2]=r,i}function Wt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function $t(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function qt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Yt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Zt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Kt(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Jt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Qt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function er(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function tr(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function rr(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function ir(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function nr(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function sr(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.hypot(r,i,n)}function ar(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function or(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function cr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function hr(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function lr(e,t){var r=t[0],i=t[1],n=t[2],s=r*r+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function ur(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function dr(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],c=r[2];return e[0]=n*c-s*o,e[1]=s*a-i*c,e[2]=i*o-n*a,e}function _r(e,t,r,i){var n=t[0],s=t[1],a=t[2];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e}function fr(e,t,r,i,n,s){var a=s*s,o=a*(2*s-3)+1,c=a*(s-2)+s,h=a*(s-1),l=a*(3-2*s);return e[0]=t[0]*o+r[0]*c+i[0]*h+n[0]*l,e[1]=t[1]*o+r[1]*c+i[1]*h+n[1]*l,e[2]=t[2]*o+r[2]*c+i[2]*h+n[2]*l,e}function pr(e,t,r,i,n,s){var a=1-s,o=a*a,c=s*s,h=o*a,l=3*s*o,u=3*c*a,d=c*s;return e[0]=t[0]*h+r[0]*l+i[0]*u+n[0]*d,e[1]=t[1]*h+r[1]*l+i[1]*u+n[1]*d,e[2]=t[2]*h+r[2]*l+i[2]*u+n[2]*d,e}function mr(e,t){t=t||1;var r=2*p()*Math.PI,i=2*p()-1,n=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e[2]=i*t,e}function vr(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[3]*i+r[7]*n+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*i+r[4]*n+r[8]*s+r[12])/a,e[1]=(r[1]*i+r[5]*n+r[9]*s+r[13])/a,e[2]=(r[2]*i+r[6]*n+r[10]*s+r[14])/a,e}function gr(e,t,r){var i=t[0],n=t[1],s=t[2];return e[0]=i*r[0]+n*r[3]+s*r[6],e[1]=i*r[1]+n*r[4]+s*r[7],e[2]=i*r[2]+n*r[5]+s*r[8],e}function br(e,t,r){var i=r[0],n=r[1],s=r[2],a=r[3],o=t[0],c=t[1],h=t[2],l=n*h-s*c,u=s*o-i*h,d=i*c-n*o,_=n*d-s*u,f=s*l-i*d,p=i*u-n*l,m=2*a;return l*=m,u*=m,d*=m,_*=2,f*=2,p*=2,e[0]=o+l+_,e[1]=c+u+f,e[2]=h+d+p,e}function Er(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0],s[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),s[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function yr(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),s[1]=n[1],s[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function xr(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),s[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),s[2]=n[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function Tr(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],a=t[1],o=t[2],c=Math.sqrt(r*r+i*i+n*n)*Math.sqrt(s*s+a*a+o*o),h=c&&ur(e,t)/c;return Math.acos(Math.min(Math.max(h,-1),1))}function Ar(e){return e[0]=0,e[1]=0,e[2]=0,e}function Sr(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Mr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Rr(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(r-s)<=_*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=_*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-o)<=_*Math.max(1,Math.abs(n),Math.abs(o))}var Lr,Pr=Yt,Fr=Zt,wr=Kt,Or=sr,Ir=ar,zr=Xt,Nr=or,Br=(Lr=kt(),function(e,t,r,i,n,s){var a,o;for(t||(t=3),r||(r=0),o=i?Math.min(i*t+r,e.length):e.length,a=r;a<o;a+=t)Lr[0]=e[a],Lr[1]=e[a+1],Lr[2]=e[a+2],n(Lr,Lr,s),e[a]=Lr[0],e[a+1]=Lr[1],e[a+2]=Lr[2];return e});function Cr(){var e=new f(4);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Dr(e){var t=new f(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Gr(e,t,r,i){var n=new f(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function jr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ur(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function kr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Vr(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Xr(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Hr(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Wr(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function $r(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function qr(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Yr(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Zr(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Kr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Jr(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function Qr(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,i,n,s)}function ei(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return r*r+i*i+n*n+s*s}function ti(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.hypot(t,r,i,n)}function ri(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function ii(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function ni(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function si(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=i*a,e[2]=n*a,e[3]=s*a,e}function ai(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function oi(e,t,r,i){var n=r[0]*i[1]-r[1]*i[0],s=r[0]*i[2]-r[2]*i[0],a=r[0]*i[3]-r[3]*i[0],o=r[1]*i[2]-r[2]*i[1],c=r[1]*i[3]-r[3]*i[1],h=r[2]*i[3]-r[3]*i[2],l=t[0],u=t[1],d=t[2],_=t[3];return e[0]=u*h-d*c+_*o,e[1]=-l*h+d*a-_*s,e[2]=l*c-u*a+_*n,e[3]=-l*o+u*s-d*n,e}function ci(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e[3]=o+i*(r[3]-o),e}function hi(e,t){var r,i,n,s,a,o;t=t||1;do{a=(r=2*p()-1)*r+(i=2*p()-1)*i}while(a>=1);do{o=(n=2*p()-1)*n+(s=2*p()-1)*s}while(o>=1);var c=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*i,e[2]=t*n*c,e[3]=t*s*c,e}function li(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*s+r[12]*a,e[1]=r[1]*i+r[5]*n+r[9]*s+r[13]*a,e[2]=r[2]*i+r[6]*n+r[10]*s+r[14]*a,e[3]=r[3]*i+r[7]*n+r[11]*s+r[15]*a,e}function ui(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],c=r[2],h=r[3],l=h*i+o*s-c*n,u=h*n+c*i-a*s,d=h*s+a*n-o*i,_=-a*i-o*n-c*s;return e[0]=l*h+_*-a+u*-c-d*-o,e[1]=u*h+_*-o+d*-a-l*-c,e[2]=d*h+_*-c+l*-o-u*-a,e[3]=t[3],e}function di(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function _i(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function fi(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function pi(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=t[0],o=t[1],c=t[2],h=t[3];return Math.abs(r-a)<=_*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=_*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-c)<=_*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(s-h)<=_*Math.max(1,Math.abs(s),Math.abs(h))}var mi=Vr,vi=Xr,gi=Hr,bi=Qr,Ei=ei,yi=ti,xi=ri,Ti=function(){var e=Cr();return function(t,r,i,n,s,a){var o,c;for(r||(r=4),i||(i=0),c=n?Math.min(n*r+i,t.length):t.length,o=i;o<c;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function Ai(){var e=new f(4);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Si(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Mi(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function Ri(e,t){var r=2*Math.acos(t[3]),i=Math.sin(r/2);return i>_?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),r}function Li(e,t){var r=nn(e,t);return Math.acos(2*r*r-1)}function Pi(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],c=r[1],h=r[2],l=r[3];return e[0]=i*l+a*o+n*h-s*c,e[1]=n*l+a*c+s*o-i*h,e[2]=s*l+a*h+i*c-n*o,e[3]=a*l-i*o-n*c-s*h,e}function Fi(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c+a*o,e[1]=n*c+s*o,e[2]=s*c-n*o,e[3]=a*c-i*o,e}function wi(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c-s*o,e[1]=n*c+a*o,e[2]=s*c+i*o,e[3]=a*c-n*o,e}function Oi(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c+n*o,e[1]=n*c-i*o,e[2]=s*c+a*o,e[3]=a*c-s*o,e}function Ii(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e}function zi(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=Math.sqrt(r*r+i*i+n*n),o=Math.exp(s),c=a>0?o*Math.sin(a)/a:0;return e[0]=r*c,e[1]=i*c,e[2]=n*c,e[3]=o*Math.cos(a),e}function Ni(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=Math.sqrt(r*r+i*i+n*n),o=a>0?Math.atan2(a,s)/a:0;return e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=.5*Math.log(r*r+i*i+n*n+s*s),e}function Bi(e,t,r){return Ni(e,t),rn(e,e,r),zi(e,e),e}function Ci(e,t,r,i){var n,s,a,o,c,h=t[0],l=t[1],u=t[2],d=t[3],f=r[0],p=r[1],m=r[2],v=r[3];return(s=h*f+l*p+u*m+d*v)<0&&(s=-s,f=-f,p=-p,m=-m,v=-v),1-s>_?(n=Math.acos(s),a=Math.sin(n),o=Math.sin((1-i)*n)/a,c=Math.sin(i*n)/a):(o=1-i,c=i),e[0]=o*h+c*f,e[1]=o*l+c*p,e[2]=o*u+c*m,e[3]=o*d+c*v,e}function Di(e){var t=p(),r=p(),i=p(),n=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=n*Math.sin(2*Math.PI*r),e[1]=n*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*i),e[3]=s*Math.cos(2*Math.PI*i),e}function Gi(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-i*o,e[2]=-n*o,e[3]=s*o,e}function ji(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Ui(e,t){var r,i=t[0]+t[4]+t[8];if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var s=(n+1)%3,a=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*s+s]-t[3*a+a]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*s+a]-t[3*a+s])*r,e[s]=(t[3*s+n]+t[3*n+s])*r,e[a]=(t[3*a+n]+t[3*n+a])*r}return e}function ki(e,t,r,i){var n=.5*Math.PI/180;t*=n,r*=n,i*=n;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(r),c=Math.cos(r),h=Math.sin(i),l=Math.cos(i);return e[0]=s*c*l-a*o*h,e[1]=a*o*l+s*c*h,e[2]=a*c*h-s*o*l,e[3]=a*c*l+s*o*h,e}function Vi(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Xi,Hi,Wi,$i,qi,Yi,Zi=Dr,Ki=Gr,Ji=jr,Qi=Ur,en=kr,tn=Pi,rn=Kr,nn=ai,sn=ci,an=ti,on=an,cn=ri,hn=cn,ln=si,un=fi,dn=pi,_n=(Xi=kt(),Hi=Ht(1,0,0),Wi=Ht(0,1,0),function(e,t,r){var i=ur(t,r);return i<-.999999?(dr(Xi,Hi,t),zr(Xi)<1e-6&&dr(Xi,Wi,t),lr(Xi,Xi),Mi(e,Xi,Math.PI),e):i>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(dr(Xi,t,r),e[0]=Xi[0],e[1]=Xi[1],e[2]=Xi[2],e[3]=1+i,ln(e,e))}),fn=($i=Ai(),qi=Ai(),function(e,t,r,i,n,s){return Ci($i,t,n,s),Ci(qi,r,i,s),Ci(e,$i,qi,2*s*(1-s)),e}),pn=(Yi=ve(),function(e,t,r,i){return Yi[0]=r[0],Yi[3]=r[1],Yi[6]=r[2],Yi[1]=i[0],Yi[4]=i[1],Yi[7]=i[2],Yi[2]=-t[0],Yi[5]=-t[1],Yi[8]=-t[2],ln(e,Ui(e,Yi))});function mn(){var e=new f(8);return f!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function vn(e){var t=new f(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function gn(e,t,r,i,n,s,a,o){var c=new f(8);return c[0]=e,c[1]=t,c[2]=r,c[3]=i,c[4]=n,c[5]=s,c[6]=a,c[7]=o,c}function bn(e,t,r,i,n,s,a){var o=new f(8);o[0]=e,o[1]=t,o[2]=r,o[3]=i;var c=.5*n,h=.5*s,l=.5*a;return o[4]=c*i+h*r-l*t,o[5]=h*i+l*e-c*r,o[6]=l*i+c*t-h*e,o[7]=-c*e-h*t-l*r,o}function En(e,t,r){var i=.5*r[0],n=.5*r[1],s=.5*r[2],a=t[0],o=t[1],c=t[2],h=t[3];return e[0]=a,e[1]=o,e[2]=c,e[3]=h,e[4]=i*h+n*c-s*o,e[5]=n*h+s*a-i*c,e[6]=s*h+i*o-n*a,e[7]=-i*a-n*o-s*c,e}function yn(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function xn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Tn(e,t){var r=Ai();xt(r,t);var i=new f(3);return Et(i,t),En(e,r,i),e}function An(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Sn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function Mn(e,t,r,i,n,s,a,o,c){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=c,e}var Rn=Ji;function Ln(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}var Pn=Ji;function Fn(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function wn(e,t){var r=t[4],i=t[5],n=t[6],s=t[7],a=-t[0],o=-t[1],c=-t[2],h=t[3];return e[0]=2*(r*h+s*a+i*c-n*o),e[1]=2*(i*h+s*o+n*a-r*c),e[2]=2*(n*h+s*c+r*o-i*a),e}function On(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=.5*r[0],c=.5*r[1],h=.5*r[2],l=t[4],u=t[5],d=t[6],_=t[7];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=a*o+n*h-s*c+l,e[5]=a*c+s*o-i*h+u,e[6]=a*h+i*c-n*o+d,e[7]=-i*o-n*c-s*h+_,e}function In(e,t,r){var i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=o*a+l*i+c*s-h*n,d=c*a+l*n+h*i-o*s,_=h*a+l*s+o*n-c*i,f=l*a-o*i-c*n-h*s;return Fi(e,t,r),i=e[0],n=e[1],s=e[2],a=e[3],e[4]=u*a+f*i+d*s-_*n,e[5]=d*a+f*n+_*i-u*s,e[6]=_*a+f*s+u*n-d*i,e[7]=f*a-u*i-d*n-_*s,e}function zn(e,t,r){var i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=o*a+l*i+c*s-h*n,d=c*a+l*n+h*i-o*s,_=h*a+l*s+o*n-c*i,f=l*a-o*i-c*n-h*s;return wi(e,t,r),i=e[0],n=e[1],s=e[2],a=e[3],e[4]=u*a+f*i+d*s-_*n,e[5]=d*a+f*n+_*i-u*s,e[6]=_*a+f*s+u*n-d*i,e[7]=f*a-u*i-d*n-_*s,e}function Nn(e,t,r){var i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],c=t[5],h=t[6],l=t[7],u=o*a+l*i+c*s-h*n,d=c*a+l*n+h*i-o*s,_=h*a+l*s+o*n-c*i,f=l*a-o*i-c*n-h*s;return Oi(e,t,r),i=e[0],n=e[1],s=e[2],a=e[3],e[4]=u*a+f*i+d*s-_*n,e[5]=d*a+f*n+_*i-u*s,e[6]=_*a+f*s+u*n-d*i,e[7]=f*a-u*i-d*n-_*s,e}function Bn(e,t,r){var i=r[0],n=r[1],s=r[2],a=r[3],o=t[0],c=t[1],h=t[2],l=t[3];return e[0]=o*a+l*i+c*s-h*n,e[1]=c*a+l*n+h*i-o*s,e[2]=h*a+l*s+o*n-c*i,e[3]=l*a-o*i-c*n-h*s,o=t[4],c=t[5],h=t[6],l=t[7],e[4]=o*a+l*i+c*s-h*n,e[5]=c*a+l*n+h*i-o*s,e[6]=h*a+l*s+o*n-c*i,e[7]=l*a-o*i-c*n-h*s,e}function Cn(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],c=r[1],h=r[2],l=r[3];return e[0]=i*l+a*o+n*h-s*c,e[1]=n*l+a*c+s*o-i*h,e[2]=s*l+a*h+i*c-n*o,e[3]=a*l-i*o-n*c-s*h,o=r[4],c=r[5],h=r[6],l=r[7],e[4]=i*l+a*o+n*h-s*c,e[5]=n*l+a*c+s*o-i*h,e[6]=s*l+a*h+i*c-n*o,e[7]=a*l-i*o-n*c-s*h,e}function Dn(e,t,r,i){if(Math.abs(i)<_)return An(e,t);var n=Math.hypot(r[0],r[1],r[2]);i*=.5;var s=Math.sin(i),a=s*r[0]/n,o=s*r[1]/n,c=s*r[2]/n,h=Math.cos(i),l=t[0],u=t[1],d=t[2],f=t[3];e[0]=l*h+f*a+u*c-d*o,e[1]=u*h+f*o+d*a-l*c,e[2]=d*h+f*c+l*o-u*a,e[3]=f*h-l*a-u*o-d*c;var p=t[4],m=t[5],v=t[6],g=t[7];return e[4]=p*h+g*a+m*c-v*o,e[5]=m*h+g*o+v*a-p*c,e[6]=v*h+g*c+p*o-m*a,e[7]=g*h-p*a-m*o-v*c,e}function Gn(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e}function jn(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[4],c=r[5],h=r[6],l=r[7],u=t[4],d=t[5],_=t[6],f=t[7],p=r[0],m=r[1],v=r[2],g=r[3];return e[0]=i*g+a*p+n*v-s*m,e[1]=n*g+a*m+s*p-i*v,e[2]=s*g+a*v+i*m-n*p,e[3]=a*g-i*p-n*m-s*v,e[4]=i*l+a*o+n*h-s*c+u*g+f*p+d*v-_*m,e[5]=n*l+a*c+s*o-i*h+d*g+f*m+_*p-u*v,e[6]=s*l+a*h+i*c-n*o+_*g+f*v+u*m-d*p,e[7]=a*l-i*o-n*c-s*h+f*g-u*p-d*m-_*v,e}var Un=jn;function kn(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e}var Vn=nn;function Xn(e,t,r,i){var n=1-i;return Vn(t,r)<0&&(i=-i),e[0]=t[0]*n+r[0]*i,e[1]=t[1]*n+r[1]*i,e[2]=t[2]*n+r[2]*i,e[3]=t[3]*n+r[3]*i,e[4]=t[4]*n+r[4]*i,e[5]=t[5]*n+r[5]*i,e[6]=t[6]*n+r[6]*i,e[7]=t[7]*n+r[7]*i,e}function Hn(e,t){var r=Yn(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e}function Wn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}var $n=an,qn=$n,Yn=cn,Zn=Yn;function Kn(e,t){var r=Yn(t);if(r>0){r=Math.sqrt(r);var i=t[0]/r,n=t[1]/r,s=t[2]/r,a=t[3]/r,o=t[4],c=t[5],h=t[6],l=t[7],u=i*o+n*c+s*h+a*l;e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=(o-i*u)/r,e[5]=(c-n*u)/r,e[6]=(h-s*u)/r,e[7]=(l-a*u)/r}return e}function Jn(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Qn(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function es(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],c=e[6],h=e[7],l=t[0],u=t[1],d=t[2],f=t[3],p=t[4],m=t[5],v=t[6],g=t[7];return Math.abs(r-l)<=_*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-u)<=_*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(n-d)<=_*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-f)<=_*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-p)<=_*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-m)<=_*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(c-v)<=_*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-g)<=_*Math.max(1,Math.abs(h),Math.abs(g))}function ts(){var e=new f(2);return f!=Float32Array&&(e[0]=0,e[1]=0),e}function rs(e){var t=new f(2);return t[0]=e[0],t[1]=e[1],t}function is(e,t){var r=new f(2);return r[0]=e,r[1]=t,r}function ns(e,t){return e[0]=t[0],e[1]=t[1],e}function ss(e,t,r){return e[0]=t,e[1]=r,e}function as(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function os(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function cs(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function hs(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function ls(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function us(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function ds(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function _s(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function fs(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function ps(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function ms(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function vs(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.hypot(r,i)}function gs(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function bs(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function Es(e){var t=e[0],r=e[1];return t*t+r*r}function ys(e,t){return e[0]=-t[0],e[1]=-t[1],e}function xs(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Ts(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e}function As(e,t){return e[0]*t[0]+e[1]*t[1]}function Ss(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function Ms(e,t,r,i){var n=t[0],s=t[1];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e}function Rs(e,t){t=t||1;var r=2*p()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Ls(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e}function Ps(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e}function Fs(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e}function ws(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e}function Os(e,t,r,i){var n=t[0]-r[0],s=t[1]-r[1],a=Math.sin(i),o=Math.cos(i);return e[0]=n*o-s*a+r[0],e[1]=n*a+s*o+r[1],e}function Is(e,t){var r=e[0],i=e[1],n=t[0],s=t[1],a=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+s*s),o=a&&(r*n+i*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function zs(e){return e[0]=0,e[1]=0,e}function Ns(e){return"vec2("+e[0]+", "+e[1]+")"}function Bs(e,t){return e[0]===t[0]&&e[1]===t[1]}function Cs(e,t){var r=e[0],i=e[1],n=t[0],s=t[1];return Math.abs(r-n)<=_*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-s)<=_*Math.max(1,Math.abs(i),Math.abs(s))}var Ds=bs,Gs=os,js=cs,Us=hs,ks=vs,Vs=gs,Xs=Es,Hs=function(){var e=ts();return function(t,r,i,n,s,a){var o,c;for(r||(r=2),i||(i=0),c=n?Math.min(n*r+i,t.length):t.length,o=i;o<c;o+=r)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}()},3041:e=>{e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(e){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(e,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(e){this.itemsLoaded++,this.onProgress&&this.onProgress(e,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(e){this.onError&&this.onError(e)}resolveURL(e){return this.urlModifier?this.urlModifier(e):e}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,o)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),s=r(0);t.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},t.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},t.GltfAsset=class{constructor(e,t,r,i=new s.LoadingManager){this.gltf=e,this.glbData=r,this.bufferData=new a(this,t,i),this.imageData=new o(this,t,i)}bufferViewData(e){return i(this,void 0,void 0,(function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const t=this.gltf.bufferViews[e],r=yield this.bufferData.get(t.buffer),i=t.byteLength||0,n=t.byteOffset||0,s=r.buffer,a=r.byteOffset;return new Uint8Array(s,a+n,i)}))}accessorData(e){return i(this,void 0,void 0,(function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const r=this.gltf.accessors[e],i=t.GLTF_ELEMENTS_PER_TYPE[r.type];let n;if(void 0!==r.bufferView)n=yield this.bufferViewData(r.bufferView);else{const e=t.GLTF_COMPONENT_TYPE_ARRAYS[r.componentType].BYTES_PER_ELEMENT*i*r.count;n=new Uint8Array(e)}if(r.sparse){const{count:e,indices:s,values:a}=r.sparse;let o=t.GLTF_COMPONENT_TYPE_ARRAYS[s.componentType],c=yield this.bufferViewData(s.bufferView);const h=new o(c.buffer,c.byteOffset+(s.byteOffset||0),e);o=t.GLTF_COMPONENT_TYPE_ARRAYS[r.componentType],c=yield this.bufferViewData(a.bufferView);const l=new o((yield this.bufferViewData(a.bufferView)).buffer,c.byteOffset+(a.byteOffset||0),e*i);r.bufferView&&(n=new Uint8Array(n));const u=new t.GLTF_COMPONENT_TYPE_ARRAYS[r.componentType](n.buffer);for(let t=0;t<e;t++)for(let e=0;e<i;e++)u[i*h[t]+e]=l[i*t+e]}return n}))}preFetchAll(){return i(this,void 0,void 0,(function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])}))}};class a{constructor(e,t,r){this.bufferCache=[],this.asset=e,this.baseUri=t,this.manager=r,this.loader=new n.FileLoader(r),this.loader.responseType="arraybuffer"}get(e){return i(this,void 0,void 0,(function*(){if(void 0!==this.bufferCache[e])return this.bufferCache[e];const t=this.asset.gltf;if(!t.buffers)throw new Error("No buffers found.");const r=t.buffers[e];if(void 0===r.uri){if(0!==e)throw new Error("GLB container is required to be the first buffer");if(void 0===this.asset.glbData)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const i=c(r.uri,this.baseUri),n=yield this.loader.load(i),s=new Uint8Array(n);return this.bufferCache[e]=s,s}))}preFetchAll(){return i(this,void 0,void 0,(function*(){const e=this.asset.gltf.buffers;return e?Promise.all(e.map(((e,t)=>this.get(t)))):[]}))}}t.BufferData=a;class o{constructor(e,t,r){this.crossOrigin="anonymous",this.imageCache=[],this.asset=e,this.baseUri=t,this.manager=r}get(e){return i(this,void 0,void 0,(function*(){if(void 0!==this.imageCache[e])return this.imageCache[e];const t=this.asset.gltf;if(!t.images)throw new Error("No images found.");const r=t.images[e];let i,n=!1;if(void 0!==r.bufferView){const e=yield this.asset.bufferViewData(r.bufferView);n=!0;const t=new Blob([e],{type:r.mimeType});i=URL.createObjectURL(t)}else{if(void 0===r.uri)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");i=this.manager.resolveURL(c(r.uri,this.baseUri))}const s=new Image;return s.crossOrigin=this.crossOrigin,new Promise(((t,r)=>{s.onerror=()=>{r(`Failed to load ${i}`),this.manager.itemEnd(i),this.manager.itemError(i)},s.onload=()=>{n&&URL.revokeObjectURL(i),this.imageCache[e]=s,t(s),this.manager.itemEnd(i)},s.src=i,this.manager.itemStart(i)}))}))}preFetchAll(){return i(this,void 0,void 0,(function*(){const e=this.asset.gltf.images;return e?Promise.all(e.map(((e,t)=>this.get(t)))):[]}))}}function c(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e}t.ImageData=o,t.resolveURL=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoaderUtils=class{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(const r of e)t+=String.fromCharCode(r);return decodeURIComponent(escape(t))}static extractUrlBase(e){const t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileLoader=class{constructor(e){this.runningRequests={},this.manager=e}load(e,t){if(void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e),this.runningRequests[e])return this.runningRequests[e];const r=new Promise(((r,i)=>{const n=new XMLHttpRequest;n.open("GET",e,!0);const s=this;n.onload=function(t){const a=this.response;0===this.status?(console.warn("FileLoader: HTTP Status 0 received."),r(a),s.manager.itemEnd(e)):200===this.status?(r(a),s.manager.itemEnd(e)):(i({url:e,status:this.status,statusText:n.statusText}),s.manager.itemEnd(e),s.manager.itemError(e)),delete s.runningRequests[e]},n.onprogress=e=>{t&&t(e)},n.onerror=function(t){i({url:e,status:this.status,statusText:n.statusText}),s.manager.itemEnd(e),s.manager.itemError(e),delete s.runningRequests[e]},this.responseType&&(n.responseType=this.responseType),this.withCredentials&&(n.withCredentials=this.withCredentials),this.mimeType&&n.overrideMimeType&&n.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeaders)n.setRequestHeader(e,this.requestHeaders[e]);n.send(null),this.manager.itemStart(e)}));return this.runningRequests[e]=r,r}setRequestHeader(e,t){return this.requestHeaders[e]=t,this}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(2);t.BINARY_HEADER_MAGIC="glTF";t.GLTFBinaryData=class{constructor(e){const r=new DataView(e,0,12),n=i.LoaderUtils.decodeText(new Uint8Array(e,0,4)),s=r.getUint32(4,!0);if(r.getUint32(8,!0),n!==t.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(s<2)throw new Error("Unsupported legacy binary file detected.");const a=new DataView(e,12);let o=0;for(;o<a.byteLength;){const t=a.getUint32(o,!0);o+=4;const r=a.getUint32(o,!0);if(o+=4,1313821514===r){const r=new Uint8Array(e,12+o,t);this.json=i.LoaderUtils.decodeText(r)}else if(5130562===r){const r=12+o;this.binaryChunk=new Uint8Array(e,r,t)}o+=t}if(null===this.json)throw new Error("glTF-Binary: JSON content not found.")}}},function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(a,o)}c((i=i.apply(e,t||[])).next())}))};function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const s=r(3),a=r(5),o=r(1),c=r(2),h=r(0),l=r(4);t.gltf=l,n(r(1)),n(r(0)),t.GltfLoader=class{constructor(e){this.manager=e||new h.LoadingManager}load(e,t){return i(this,void 0,void 0,(function*(){const r=c.LoaderUtils.extractUrlBase(e),i=new s.FileLoader(this.manager);i.responseType="arraybuffer";const n=yield i.load(e,t);return yield this.parse(n,r)}))}loadFromFiles(e){return i(this,void 0,void 0,(function*(){let t,r;for(const[i,n]of e)n.name.match(/\.(gltf|glb)$/)&&(t=n,r=i.replace(n.name,""));if(!t)throw new Error("No .gltf or .glb asset found.");const i="string"==typeof t?t:URL.createObjectURL(t),n=c.LoaderUtils.extractUrlBase(i),s=[];this.manager.urlModifier=t=>{const i=r+t.replace(n,"").replace(/^(\.?\/)/,"");if(e.has(i)){const t=e.get(i),r=URL.createObjectURL(t);return s.push(r),r}return t};const a=yield this.load(i);return yield a.preFetchAll(),URL.revokeObjectURL(i),s.forEach(URL.revokeObjectURL),a}))}parse(e,t){return i(this,void 0,void 0,(function*(){let r,i;r="string"==typeof e?e:c.LoaderUtils.decodeText(new Uint8Array(e,0,4))===a.BINARY_HEADER_MAGIC?(i=new a.GLTFBinaryData(e)).json:c.LoaderUtils.decodeText(new Uint8Array(e));const n=JSON.parse(r);if(void 0===n.asset||n.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new o.GltfAsset(n,t,i,this.manager)}))}}},function(e,t,r){e.exports=r(6)}])},9609:(e,t,r)=>{"use strict";var i=r(3533),n=i.ValidatorResult,s=i.SchemaError,a={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,additionalItems:!0,then:!0,else:!0,$schema:!0,$ref:!0,extends:!0}},o=a.validators={};function c(e,t,r,i,n){var s=t.throwError,a=t.throwAll;t.throwError=!1,t.throwAll=!1;var o=this.validateSchema(e,n,t,r);return t.throwError=s,t.throwAll=a,!o.valid&&i instanceof Function&&i(o),o.valid}function h(e,t){if(Object.hasOwnProperty.call(e,t))return e[t];if(t in e)for(;e=Object.getPrototypeOf(e);)if(Object.propertyIsEnumerable.call(e,t))return e[t]}function l(e,t,r,i,n,s){if(this.types.object(e)&&(!t.properties||void 0===t.properties[n]))if(!1===t.additionalProperties)s.addError({name:"additionalProperties",argument:n,message:"is not allowed to have the additional property "+JSON.stringify(n)});else{var a=t.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,n,a,r,i);var o=this.validateSchema(e[n],a,r,i.makeChild(a,n));o.instance!==s.instance[n]&&(s.instance[n]=o.instance),s.importErrors(o)}}o.type=function(e,t,r,i){if(void 0===e)return null;var s=new n(e,t,r,i),a=Array.isArray(t.type)?t.type:[t.type];if(!a.some(this.testType.bind(this,e,t,r,i))){var o=a.map((function(e){if(e){var t=e.$id||e.id;return t?"<"+t+">":e+""}}));s.addError({name:"type",argument:o,message:"is not of a type(s) "+o})}return s},o.anyOf=function(e,t,r,i){if(void 0===e)return null;var a=new n(e,t,r,i),o=new n(e,t,r,i);if(!Array.isArray(t.anyOf))throw new s("anyOf must be an array");if(!t.anyOf.some(c.bind(this,e,r,i,(function(e){o.importErrors(e)})))){var h=t.anyOf.map((function(e,t){var r=e.$id||e.id;return r?"<"+r+">":e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));r.nestedErrors&&a.importErrors(o),a.addError({name:"anyOf",argument:h,message:"is not any of "+h.join(",")})}return a},o.allOf=function(e,t,r,i){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new s("allOf must be an array");var a=new n(e,t,r,i),o=this;return t.allOf.forEach((function(t,n){var s=o.validateSchema(e,t,r,i);if(!s.valid){var c=t.$id||t.id||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+n+"]";a.addError({name:"allOf",argument:{id:c,length:s.errors.length,valid:s},message:"does not match allOf schema "+c+" with "+s.errors.length+" error[s]:"}),a.importErrors(s)}})),a},o.oneOf=function(e,t,r,i){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new s("oneOf must be an array");var a=new n(e,t,r,i),o=new n(e,t,r,i),h=t.oneOf.filter(c.bind(this,e,r,i,(function(e){o.importErrors(e)}))).length,l=t.oneOf.map((function(e,t){return e.$id||e.id||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"}));return 1!==h&&(r.nestedErrors&&a.importErrors(o),a.addError({name:"oneOf",argument:l,message:"is not exactly one from "+l.join(",")})),a},o.if=function(e,t,r,s){if(void 0===e)return null;if(!i.isSchema(t.if))throw new Error('Expected "if" keyword to be a schema');var a,o=c.call(this,e,r,s,null,t.if),h=new n(e,t,r,s);if(o){if(void 0===t.then)return;if(!i.isSchema(t.then))throw new Error('Expected "then" keyword to be a schema');a=this.validateSchema(e,t.then,r,s.makeChild(t.then)),h.importErrors(a)}else{if(void 0===t.else)return;if(!i.isSchema(t.else))throw new Error('Expected "else" keyword to be a schema');a=this.validateSchema(e,t.else,r,s.makeChild(t.else)),h.importErrors(a)}return h},o.propertyNames=function(e,t,r,a){if(this.types.object(e)){var o=new n(e,t,r,a),c=void 0!==t.propertyNames?t.propertyNames:{};if(!i.isSchema(c))throw new s('Expected "propertyNames" to be a schema (object or boolean)');for(var l in e)if(void 0!==h(e,l)){var u=this.validateSchema(l,c,r,a.makeChild(c));o.importErrors(u)}return o}},o.properties=function(e,t,r,i){if(this.types.object(e)){var a=new n(e,t,r,i),o=t.properties||{};for(var c in o){var l=o[c];if(void 0!==l){if(null===l)throw new s('Unexpected null, expected schema in "properties"');"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,c,l,r,i);var u=h(e,c),d=this.validateSchema(u,l,r,i.makeChild(l,c));d.instance!==a.instance[c]&&(a.instance[c]=d.instance),a.importErrors(d)}}return a}},o.patternProperties=function(e,t,r,i){if(this.types.object(e)){var a=new n(e,t,r,i),o=t.patternProperties||{};for(var c in e){var h=!0;for(var u in o){var d=o[u];if(void 0!==d){if(null===d)throw new s('Unexpected null, expected schema in "patternProperties"');try{var _=new RegExp(u,"u")}catch(e){_=new RegExp(u)}if(_.test(c)){h=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,c,d,r,i);var f=this.validateSchema(e[c],d,r,i.makeChild(d,c));f.instance!==a.instance[c]&&(a.instance[c]=f.instance),a.importErrors(f)}}}h&&l.call(this,e,t,r,i,c,a)}return a}},o.additionalProperties=function(e,t,r,i){if(this.types.object(e)){if(t.patternProperties)return null;var s=new n(e,t,r,i);for(var a in e)l.call(this,e,t,r,i,a,s);return s}},o.minProperties=function(e,t,r,i){if(this.types.object(e)){var s=new n(e,t,r,i);return Object.keys(e).length>=t.minProperties||s.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),s}},o.maxProperties=function(e,t,r,i){if(this.types.object(e)){var s=new n(e,t,r,i);return Object.keys(e).length<=t.maxProperties||s.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),s}},o.items=function(e,t,r,i){var s=this;if(this.types.array(e)&&void 0!==t.items){var a=new n(e,t,r,i);return e.every((function(e,n){if(Array.isArray(t.items))var o=void 0===t.items[n]?t.additionalItems:t.items[n];else o=t.items;if(void 0===o)return!0;if(!1===o)return a.addError({name:"items",message:"additionalItems not permitted"}),!1;var c=s.validateSchema(e,o,r,i.makeChild(o,n));return c.instance!==a.instance[n]&&(a.instance[n]=c.instance),a.importErrors(c),!0})),a}},o.contains=function(e,t,r,s){var a=this;if(this.types.array(e)&&void 0!==t.contains){if(!i.isSchema(t.contains))throw new Error('Expected "contains" keyword to be a schema');var o=new n(e,t,r,s);return!1===e.some((function(e,i){return 0===a.validateSchema(e,t.contains,r,s.makeChild(t.contains,i)).errors.length}))&&o.addError({name:"contains",argument:t.contains,message:"must contain an item matching given schema"}),o}},o.minimum=function(e,t,r,i){if(this.types.number(e)){var s=new n(e,t,r,i);return t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum||s.addError({name:"minimum",argument:t.minimum,message:"must be greater than "+t.minimum}):e>=t.minimum||s.addError({name:"minimum",argument:t.minimum,message:"must be greater than or equal to "+t.minimum}),s}},o.maximum=function(e,t,r,i){if(this.types.number(e)){var s=new n(e,t,r,i);return t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum||s.addError({name:"maximum",argument:t.maximum,message:"must be less than "+t.maximum}):e<=t.maximum||s.addError({name:"maximum",argument:t.maximum,message:"must be less than or equal to "+t.maximum}),s}},o.exclusiveMinimum=function(e,t,r,i){if("boolean"!=typeof t.exclusiveMinimum&&this.types.number(e)){var s=new n(e,t,r,i);return e>t.exclusiveMinimum||s.addError({name:"exclusiveMinimum",argument:t.exclusiveMinimum,message:"must be strictly greater than "+t.exclusiveMinimum}),s}},o.exclusiveMaximum=function(e,t,r,i){if("boolean"!=typeof t.exclusiveMaximum&&this.types.number(e)){var s=new n(e,t,r,i);return e<t.exclusiveMaximum||s.addError({name:"exclusiveMaximum",argument:t.exclusiveMaximum,message:"must be strictly less than "+t.exclusiveMaximum}),s}};var u=function(e,t,r,a,o,c){if(this.types.number(e)){var h=t[o];if(0==h)throw new s(o+" cannot be zero");var l=new n(e,t,r,a),u=i.getDecimalPlaces(e),d=i.getDecimalPlaces(h),_=Math.max(u,d),f=Math.pow(10,_);return Math.round(e*f)%Math.round(h*f)!=0&&l.addError({name:o,argument:h,message:c+JSON.stringify(h)}),l}};function d(e,t,r){var n,s=r.length;for(n=t+1;n<s;n++)if(i.deepCompareStrict(e,r[n]))return!1;return!0}o.multipleOf=function(e,t,r,i){return u.call(this,e,t,r,i,"multipleOf","is not a multiple of (divisible by) ")},o.divisibleBy=function(e,t,r,i){return u.call(this,e,t,r,i,"divisibleBy","is not divisible by (multiple of) ")},o.required=function(e,t,r,i){var s=new n(e,t,r,i);return void 0===e&&!0===t.required?s.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach((function(t){void 0===h(e,t)&&s.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})})),s},o.pattern=function(e,t,r,i){if(this.types.string(e)){var s=new n(e,t,r,i),a=t.pattern;try{var o=new RegExp(a,"u")}catch(e){o=new RegExp(a)}return e.match(o)||s.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern.toString())}),s}},o.format=function(e,t,r,s){if(void 0!==e){var a=new n(e,t,r,s);return a.disableFormat||i.isFormat(e,t.format,this)||a.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),a}},o.minLength=function(e,t,r,i){if(this.types.string(e)){var s=new n(e,t,r,i),a=e.match(/[\uDC00-\uDFFF]/g);return e.length-(a?a.length:0)>=t.minLength||s.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),s}},o.maxLength=function(e,t,r,i){if(this.types.string(e)){var s=new n(e,t,r,i),a=e.match(/[\uDC00-\uDFFF]/g);return e.length-(a?a.length:0)<=t.maxLength||s.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),s}},o.minItems=function(e,t,r,i){if(this.types.array(e)){var s=new n(e,t,r,i);return e.length>=t.minItems||s.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),s}},o.maxItems=function(e,t,r,i){if(this.types.array(e)){var s=new n(e,t,r,i);return e.length<=t.maxItems||s.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),s}},o.uniqueItems=function(e,t,r,i){if(!0===t.uniqueItems&&this.types.array(e)){var s=new n(e,t,r,i);return e.every(d)||s.addError({name:"uniqueItems",message:"contains duplicate item"}),s}},o.dependencies=function(e,t,r,i){if(this.types.object(e)){var s=new n(e,t,r,i);for(var a in t.dependencies)if(void 0!==e[a]){var o=t.dependencies[a],c=i.makeChild(o,a);if("string"==typeof o&&(o=[o]),Array.isArray(o))o.forEach((function(t){void 0===e[t]&&s.addError({name:"dependencies",argument:c.propertyPath,message:"property "+t+" not found, required by "+c.propertyPath})}));else{var h=this.validateSchema(e,o,r,c);s.instance!==h.instance&&(s.instance=h.instance),h&&h.errors.length&&(s.addError({name:"dependencies",argument:c.propertyPath,message:"does not meet dependency required by "+c.propertyPath}),s.importErrors(h))}}return s}},o.enum=function(e,t,r,a){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new s("enum expects an array",t);var o=new n(e,t,r,a);return t.enum.some(i.deepCompareStrict.bind(null,e))||o.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),o},o.const=function(e,t,r,s){if(void 0===e)return null;var a=new n(e,t,r,s);return i.deepCompareStrict(t.const,e)||a.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),a},o.not=o.disallow=function(e,t,r,i){var s=this;if(void 0===e)return null;var a=new n(e,t,r,i),o=t.not||t.disallow;return o?(Array.isArray(o)||(o=[o]),o.forEach((function(n){if(s.testType(e,t,r,i,n)){var o=n&&(n.$id||n.id)||n;a.addError({name:"not",argument:o,message:"is of prohibited type "+o})}})),a):null},e.exports=a},3533:(e,t,r)=>{"use strict";var i=r(4760),n=t.ValidationError=function(e,t,r,i,n,s){if(Array.isArray(i)?(this.path=i,this.property=i.reduce((function(e,t){return e+u(t)}),"instance")):void 0!==i&&(this.property=i),e&&(this.message=e),r){var a=r.$id||r.id;this.schema=a||r}void 0!==t&&(this.instance=t),this.name=n,this.argument=s,this.stack=this.toString()};n.prototype.toString=function(){return this.property+" "+this.message};var s=t.ValidatorResult=function(e,t,r,i){this.instance=e,this.schema=t,this.options=r,this.path=i.path,this.propertyPath=i.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.throwFirst=r&&r.throwFirst,this.throwAll=r&&r.throwAll,this.disableFormat=r&&!0===r.disableFormat};function a(e,t){return t+": "+e.toString()+"\n"}function o(e){Error.captureStackTrace&&Error.captureStackTrace(this,o),this.instance=e.instance,this.schema=e.schema,this.options=e.options,this.errors=e.errors}s.prototype.addError=function(e){var t;if("string"==typeof e)t=new n(e,this.instance,this.schema,this.path);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new n(e.message,this.instance,this.schema,this.path,e.name,e.argument)}if(this.errors.push(t),this.throwFirst)throw new o(this);if(this.throwError)throw t;return t},s.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&(this.errors=this.errors.concat(e.errors))},s.prototype.toString=function(e){return this.errors.map(a).join("")},Object.defineProperty(s.prototype,"valid",{get:function(){return!this.errors.length}}),e.exports.ValidatorResultError=o,o.prototype=new Error,o.prototype.constructor=o,o.prototype.name="Validation Error";var c=t.SchemaError=function e(t,r){this.message=t,this.schema=r,Error.call(this,t),Error.captureStackTrace(this,e)};c.prototype=Object.create(Error.prototype,{constructor:{value:c,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var h=t.SchemaContext=function(e,t,r,i,n){this.schema=e,this.options=t,Array.isArray(r)?(this.path=r,this.propertyPath=r.reduce((function(e,t){return e+u(t)}),"instance")):this.propertyPath=r,this.base=i,this.schemas=n};h.prototype.resolve=function(e){return i.resolve(this.base,e)},h.prototype.makeChild=function(e,t){var r=void 0===t?this.path:this.path.concat([t]),n=e.$id||e.id,s=i.resolve(this.base,n||""),a=new h(e,this.options,r,s,Object.create(this.schemas));return n&&!a.schemas[s]&&(a.schemas[s]=e),a};var l=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,duration:/P(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S)|\d+(D|M(\d+D)?|Y(\d+M(\d+D)?)?)(T\d+(H(\d+M(\d+S)?)?|M(\d+S)?|S))?|\d+W)/i,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"idn-email":/^("(?:[!#-\[\]-\u{10FFFF}]|\\[\t -\u{10FFFF}])*"|[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*)@([!#-'*+\-/-9=?A-Z\^-\u{10FFFF}](?:\.?[!#-'*+\-/-9=?A-Z\^-\u{10FFFF}])*|\[[!-Z\^-\u{10FFFF}]*\])$/u,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"uri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/,iri:/^[a-zA-Z][a-zA-Z0-9+.-]*:[^\s]*$/,"iri-reference":/^(((([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:?)?)|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?)?))#(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|(([A-Za-z][+\-.0-9A-Za-z]*)?%[0-9A-Fa-f]{2}|[!$&-.0-9;=@_~-\u{10FFFF}]|[A-Za-z][+\-.0-9A-Za-z]*[!$&-*,;=@_~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-.0-9;=@-Z_a-z~-\u{10FFFF}])*((([/?](%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?#|[/?])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*)?|([A-Za-z][+\-.0-9A-Za-z]*(:%[0-9A-Fa-f]{2}|:[!$&-.0-;=?-Z_a-z~-\u{10FFFF}]|[/?])|\?)(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|([A-Za-z][+\-.0-9A-Za-z]*:)?\/((%[0-9A-Fa-f]{2}|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)(:\d*)?[/?]|[!$&-.0-;=?-Z_a-z~-\u{10FFFF}])(%[0-9A-Fa-f]{2}|[!$&-;=?-Z_a-z~-\u{10FFFF}])*|\/((%[0-9A-Fa-f]{2}|[!$&-.0-9;=A-Z_a-z~-\u{10FFFF}])+(:\d*)?|(\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?:\d*|\[(([Vv][0-9A-Fa-f]+\.[!$&-.0-;=A-Z_a-z~-\u{10FFFF}]+)?|[.0-:A-Fa-f]+)\])?)?|[A-Za-z][+\-.0-9A-Za-z]*:?)?$/u,uuid:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,"uri-template":/(%[0-9a-f]{2}|[!#$&(-;=?@\[\]_a-z~]|\{[!#&+,./;=?@|]?(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?(,(%[0-9a-f]{2}|[0-9_a-z])(\.?(%[0-9a-f]{2}|[0-9_a-z]))*(:[1-9]\d{0,3}|\*)?)*\})*/iu,"json-pointer":/^(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*$/iu,"relative-json-pointer":/^\d+(#|(\/([\x00-\x2e0-@\[-}\x7f]|~[01])*)*)$/iu,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/[\r\n\t ]*[^\r\n\t ][^:]*:[\r\n\t ]*[^\r\n\t ;]*[\r\n\t ]*;?/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/};l.regexp=l.regex,l.pattern=l.regex,l.ipv4=l["ip-address"],t.isFormat=function(e,t,r){if("string"==typeof e&&void 0!==l[t]){if(l[t]instanceof RegExp)return l[t].test(e);if("function"==typeof l[t])return l[t](e)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[t])return r.customFormats[t](e);return!0};var u=t.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function d(e,t,r,i){"object"==typeof r?t[i]=p(e[i],r):-1===e.indexOf(r)&&t.push(r)}function _(e,t,r){t[r]=e[r]}function f(e,t,r,i){"object"==typeof t[i]&&t[i]&&e[i]?r[i]=p(e[i],t[i]):r[i]=t[i]}function p(e,t){var r=Array.isArray(t),i=r&&[]||{};return r?(e=e||[],i=i.concat(e),t.forEach(d.bind(null,e,i))):(e&&"object"==typeof e&&Object.keys(e).forEach(_.bind(null,e,i)),Object.keys(t).forEach(f.bind(null,e,t,i))),i}function m(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}t.deepCompareStrict=function e(t,r){if(typeof t!=typeof r)return!1;if(Array.isArray(t))return!!Array.isArray(r)&&t.length===r.length&&t.every((function(i,n){return e(t[n],r[n])}));if("object"==typeof t){if(!t||!r)return t===r;var i=Object.keys(t),n=Object.keys(r);return i.length===n.length&&i.every((function(i){return e(t[i],r[i])}))}return t===r},e.exports.deepMerge=p,t.objectGetPath=function(e,t){for(var r,i=t.split("/").slice(1);"string"==typeof(r=i.shift());){var n=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(n in e))return;e=e[n]}return e},t.encodePath=function(e){return e.map(m).join("")},t.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var r=e.toString().split("e");if(2===r.length){if("-"!==r[1][0])return t;t=Number(r[1].slice(1))}var i=r[0].split(".");return 2===i.length&&(t+=i[1].length),t},t.isSchema=function(e){return"object"==typeof e&&e||"boolean"==typeof e}},634:(e,t,r)=>{"use strict";var i=e.exports.Validator=r(7298);e.exports.ValidatorResult=r(3533).ValidatorResult,e.exports.ValidatorResultError=r(3533).ValidatorResultError,e.exports.ValidationError=r(3533).ValidationError,e.exports.SchemaError=r(3533).SchemaError,e.exports.SchemaScanResult=r(433).SchemaScanResult,e.exports.scan=r(433).scan,e.exports.validate=function(e,t,r){return(new i).validate(e,t,r)}},433:(e,t,r)=>{"use strict";var i=r(4760),n=r(3533);function s(e,t){this.id=e,this.ref=t}e.exports.SchemaScanResult=s,e.exports.scan=function(e,t){function r(e,t){if(t&&"object"==typeof t)if(t.$ref){var s=i.resolve(e,t.$ref);h[s]=h[s]?h[s]+1:0}else{var l=t.$id||t.id,u=l?i.resolve(e,l):e;if(u){if(u.indexOf("#")<0&&(u+="#"),c[u]){if(!n.deepCompareStrict(c[u],t))throw new Error("Schema <"+u+"> already exists with different definition");return c[u]}c[u]=t,"#"==u[u.length-1]&&(c[u.substring(0,u.length-1)]=t)}a(u+"/items",Array.isArray(t.items)?t.items:[t.items]),a(u+"/extends",Array.isArray(t.extends)?t.extends:[t.extends]),r(u+"/additionalItems",t.additionalItems),o(u+"/properties",t.properties),r(u+"/additionalProperties",t.additionalProperties),o(u+"/definitions",t.definitions),o(u+"/patternProperties",t.patternProperties),o(u+"/dependencies",t.dependencies),a(u+"/disallow",t.disallow),a(u+"/allOf",t.allOf),a(u+"/anyOf",t.anyOf),a(u+"/oneOf",t.oneOf),r(u+"/not",t.not)}}function a(e,t){if(Array.isArray(t))for(var i=0;i<t.length;i++)r(e+"/"+i,t[i])}function o(e,t){if(t&&"object"==typeof t)for(var i in t)r(e+"/"+i,t[i])}var c={},h={};return r(e,t),new s(c,h)}},7298:(e,t,r)=>{"use strict";var i=r(4760),n=r(9609),s=r(3533),a=r(433).scan,o=s.ValidatorResult,c=s.ValidatorResultError,h=s.SchemaError,l=s.SchemaContext,u=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(_),this.attributes=Object.create(n.validators)};function d(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}u.prototype.customFormats={},u.prototype.schemas=null,u.prototype.types=null,u.prototype.attributes=null,u.prototype.unresolvedRefs=null,u.prototype.addSchema=function(e,t){var r=this;if(!e)return null;var i=a(t||"/",e),n=t||e.$id||e.id;for(var s in i.id)this.schemas[s]=i.id[s];for(var s in i.ref)this.unresolvedRefs.push(s);return this.unresolvedRefs=this.unresolvedRefs.filter((function(e){return void 0===r.schemas[e]})),this.schemas[n]},u.prototype.addSubSchemaArray=function(e,t){if(Array.isArray(t))for(var r=0;r<t.length;r++)this.addSubSchema(e,t[r])},u.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var r in t)this.addSubSchema(e,t[r])},u.prototype.setSchemas=function(e){this.schemas=e},u.prototype.getSchema=function(e){return this.schemas[e]},u.prototype.validate=function(e,t,r,n){if("boolean"!=typeof t&&"object"!=typeof t||null===t)throw new h("Expected `schema` to be an object or boolean");r||(r={});var s,u=t.$id||t.id,d=i.resolve(r.base||"/",u||"");if(!n){(n=new l(t,r,[],d,Object.create(this.schemas))).schemas[d]||(n.schemas[d]=t);var _=a(d,t);for(var f in _.id){var p=_.id[f];n.schemas[f]=p}}if(r.required&&void 0===e)return(s=new o(e,t,r,n)).addError("is required, but is undefined"),s;if(!(s=this.validateSchema(e,t,r,n)))throw new Error("Result undefined");if(r.throwAll&&s.errors.length)throw new c(s);return s},u.prototype.validateSchema=function(e,t,r,i){var a=new o(e,t,r,i);if("boolean"==typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(Array.isArray(t.extends)){var c={schema:t,ctx:i};t.extends.forEach(this.schemaTraverser.bind(this,c)),t=c.schema,c.schema=null,c.ctx=null,c=null}else t=s.deepMerge(t,this.superResolve(t.extends,i));var u=d(t);if(u){var _=this.resolve(t,u,i),f=new l(_.subschema,r,i.path,_.switchSchema,i.schemas);return this.validateSchema(e,_.subschema,r,f)}var p=r&&r.skipAttributes||[];for(var m in t)if(!n.ignoreProperties[m]&&p.indexOf(m)<0){var v=null,g=this.attributes[m];if(g)v=g.call(this,e,t,r,i);else if(!1===r.allowUnknownAttributes)throw new h("Unsupported attribute: "+m,t);v&&a.importErrors(v)}if("function"==typeof r.rewrite){var b=r.rewrite.call(this,e,t,r,i);a.instance=b}return a},u.prototype.schemaTraverser=function(e,t){e.schema=s.deepMerge(e.schema,this.superResolve(t,e.ctx))},u.prototype.superResolve=function(e,t){var r=d(e);return r?this.resolve(e,r,t).subschema:e},u.prototype.resolve=function(e,t,r){if(t=r.resolve(t),r.schemas[t])return{subschema:r.schemas[t],switchSchema:t};var n=i.parse(t),a=n&&n.hash,o=a&&a.length&&t.substr(0,t.length-a.length);if(!o||!r.schemas[o])throw new h("no such schema <"+t+">",e);var c=s.objectGetPath(r.schemas[o],a.substr(1));if(void 0===c)throw new h("no such schema "+a+" located in <"+o+">",e);return{subschema:c,switchSchema:t}},u.prototype.testType=function(e,t,r,i,n){if(void 0!==n){if(null===n)throw new h('Unexpected null in "type" keyword');if("function"==typeof this.types[n])return this.types[n].call(this,e);if(n&&"object"==typeof n){var s=this.validateSchema(e,n,r,i);return void 0===s||!(s&&s.errors.length)}return!0}};var _=u.prototype.types={};_.string=function(e){return"string"==typeof e},_.number=function(e){return"number"==typeof e&&isFinite(e)},_.integer=function(e){return"number"==typeof e&&e%1==0},_.boolean=function(e){return"boolean"==typeof e},_.array=function(e){return Array.isArray(e)},_.null=function(e){return null===e},_.date=function(e){return e instanceof Date},_.any=function(e){return!0},_.object=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&!(e instanceof Date)},e.exports=u},8770:(e,t,r)=>{"use strict";r.r(t),r.d(t,{decode:()=>v,default:()=>y,encode:()=>g,toASCII:()=>E,toUnicode:()=>b,ucs2decode:()=>_,ucs2encode:()=>f});const i=2147483647,n=36,s=/^xn--/,a=/[^\0-\x7F]/,o=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,l=String.fromCharCode;function u(e){throw new RangeError(c[e])}function d(e,t){const r=e.split("@");let i="";r.length>1&&(i=r[0]+"@",e=r[1]);const n=function(e,t){const r=[];let i=e.length;for(;i--;)r[i]=t(e[i]);return r}((e=e.replace(o,".")).split("."),t).join(".");return i+n}function _(e){const t=[];let r=0;const i=e.length;for(;r<i;){const n=e.charCodeAt(r++);if(n>=55296&&n<=56319&&r<i){const i=e.charCodeAt(r++);56320==(64512&i)?t.push(((1023&n)<<10)+(1023&i)+65536):(t.push(n),r--)}else t.push(n)}return t}const f=e=>String.fromCodePoint(...e),p=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},m=function(e,t,r){let i=0;for(e=r?h(e/700):e>>1,e+=h(e/t);e>455;i+=n)e=h(e/35);return h(i+36*e/(e+38))},v=function(e){const t=[],r=e.length;let s=0,a=128,o=72,c=e.lastIndexOf("-");c<0&&(c=0);for(let r=0;r<c;++r)e.charCodeAt(r)>=128&&u("not-basic"),t.push(e.charCodeAt(r));for(let d=c>0?c+1:0;d<r;){const c=s;for(let t=1,a=n;;a+=n){d>=r&&u("invalid-input");const c=(l=e.charCodeAt(d++))>=48&&l<58?l-48+26:l>=65&&l<91?l-65:l>=97&&l<123?l-97:n;c>=n&&u("invalid-input"),c>h((i-s)/t)&&u("overflow"),s+=c*t;const _=a<=o?1:a>=o+26?26:a-o;if(c<_)break;const f=n-_;t>h(i/f)&&u("overflow"),t*=f}const _=t.length+1;o=m(s-c,_,0==c),h(s/_)>i-a&&u("overflow"),a+=h(s/_),s%=_,t.splice(s++,0,a)}var l;return String.fromCodePoint(...t)},g=function(e){const t=[],r=(e=_(e)).length;let s=128,a=0,o=72;for(const r of e)r<128&&t.push(l(r));const c=t.length;let d=c;for(c&&t.push("-");d<r;){let r=i;for(const t of e)t>=s&&t<r&&(r=t);const _=d+1;r-s>h((i-a)/_)&&u("overflow"),a+=(r-s)*_,s=r;for(const r of e)if(r<s&&++a>i&&u("overflow"),r===s){let e=a;for(let r=n;;r+=n){const i=r<=o?1:r>=o+26?26:r-o;if(e<i)break;const s=e-i,a=n-i;t.push(l(p(i+s%a,0))),e=h(s/a)}t.push(l(p(e,0))),o=m(a,_,d===c),a=0,++d}++a,++s}return t.join("")},b=function(e){return d(e,(function(e){return s.test(e)?v(e.slice(4).toLowerCase()):e}))},E=function(e){return d(e,(function(e){return a.test(e)?"xn--"+g(e):e}))},y={version:"2.1.0",ucs2:{decode:_,encode:f},decode:v,encode:g,toASCII:E,toUnicode:b}},9771:e=>{"use strict";var t=String.prototype.replace,r=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},8139:(e,t,r)=>{"use strict";var i=r(6360),n=r(9520),s=r(9771);e.exports={formats:s,parse:n,stringify:i}},9520:(e,t,r)=>{"use strict";var i=r(4330),n=Object.prototype.hasOwnProperty,s={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:i.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},a=function(e,t,r){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/g,a=/(\[[^[\]]*])/.exec(i),o=a?i.slice(0,a.index):i,c=[];if(o){if(!r.plainObjects&&n.call(Object.prototype,o)&&!r.allowPrototypes)return;c.push(o)}for(var h=0;null!==(a=s.exec(i))&&h<r.depth;){if(h+=1,!r.plainObjects&&n.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(a[1])}return a&&c.push("["+i.slice(a.index)+"]"),function(e,t,r){for(var i=t,n=e.length-1;n>=0;--n){var s,a=e[n];if("[]"===a&&r.parseArrays)s=[].concat(i);else{s=r.plainObjects?Object.create(null):{};var o="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(o,10);r.parseArrays||""!==o?!isNaN(c)&&a!==o&&String(c)===o&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(s=[])[c]=i:"__proto__"!==o&&(s[o]=i):s={0:i}}i=s}return i}(c,t,r)}};e.exports=function(e,t){var r=t?i.assign({},t):{};if(null!==r.decoder&&void 0!==r.decoder&&"function"!=typeof r.decoder)throw new TypeError("Decoder has to be a function.");if(r.ignoreQueryPrefix=!0===r.ignoreQueryPrefix,r.delimiter="string"==typeof r.delimiter||i.isRegExp(r.delimiter)?r.delimiter:s.delimiter,r.depth="number"==typeof r.depth?r.depth:s.depth,r.arrayLimit="number"==typeof r.arrayLimit?r.arrayLimit:s.arrayLimit,r.parseArrays=!1!==r.parseArrays,r.decoder="function"==typeof r.decoder?r.decoder:s.decoder,r.allowDots="boolean"==typeof r.allowDots?r.allowDots:s.allowDots,r.plainObjects="boolean"==typeof r.plainObjects?r.plainObjects:s.plainObjects,r.allowPrototypes="boolean"==typeof r.allowPrototypes?r.allowPrototypes:s.allowPrototypes,r.parameterLimit="number"==typeof r.parameterLimit?r.parameterLimit:s.parameterLimit,r.strictNullHandling="boolean"==typeof r.strictNullHandling?r.strictNullHandling:s.strictNullHandling,""===e||null==e)return r.plainObjects?Object.create(null):{};for(var o="string"==typeof e?function(e,t){for(var r={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=t.parameterLimit===1/0?void 0:t.parameterLimit,o=i.split(t.delimiter,a),c=0;c<o.length;++c){var h,l,u=o[c],d=u.indexOf("]="),_=-1===d?u.indexOf("="):d+1;-1===_?(h=t.decoder(u,s.decoder),l=t.strictNullHandling?null:""):(h=t.decoder(u.slice(0,_),s.decoder),l=t.decoder(u.slice(_+1),s.decoder)),n.call(r,h)?r[h]=[].concat(r[h]).concat(l):r[h]=l}return r}(e,r):e,c=r.plainObjects?Object.create(null):{},h=Object.keys(o),l=0;l<h.length;++l){var u=h[l],d=a(u,o[u],r);c=i.merge(c,d,r)}return i.compact(c)}},6360:(e,t,r)=>{"use strict";var i=r(4330),n=r(9771),s={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},a=Array.isArray,o=Array.prototype.push,c=function(e,t){o.apply(e,a(t)?t:[t])},h=Date.prototype.toISOString,l={delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,serializeDate:function(e){return h.call(e)},skipNulls:!1,strictNullHandling:!1},u=function e(t,r,n,s,o,h,u,d,_,f,p,m){var v=t;if("function"==typeof u?v=u(r,v):v instanceof Date&&(v=f(v)),null===v){if(s)return h&&!m?h(r,l.encoder):r;v=""}if("string"==typeof v||"number"==typeof v||"boolean"==typeof v||i.isBuffer(v))return h?[p(m?r:h(r,l.encoder))+"="+p(h(v,l.encoder))]:[p(r)+"="+p(String(v))];var g,b=[];if(void 0===v)return b;if(a(u))g=u;else{var E=Object.keys(v);g=d?E.sort(d):E}for(var y=0;y<g.length;++y){var x=g[y];o&&null===v[x]||(a(v)?c(b,e(v[x],n(r,x),n,s,o,h,u,d,_,f,p,m)):c(b,e(v[x],r+(_?"."+x:"["+x+"]"),n,s,o,h,u,d,_,f,p,m)))}return b};e.exports=function(e,t){var r=e,o=t?i.assign({},t):{};if(null!==o.encoder&&void 0!==o.encoder&&"function"!=typeof o.encoder)throw new TypeError("Encoder has to be a function.");var h=void 0===o.delimiter?l.delimiter:o.delimiter,d="boolean"==typeof o.strictNullHandling?o.strictNullHandling:l.strictNullHandling,_="boolean"==typeof o.skipNulls?o.skipNulls:l.skipNulls,f="boolean"==typeof o.encode?o.encode:l.encode,p="function"==typeof o.encoder?o.encoder:l.encoder,m="function"==typeof o.sort?o.sort:null,v=void 0!==o.allowDots&&o.allowDots,g="function"==typeof o.serializeDate?o.serializeDate:l.serializeDate,b="boolean"==typeof o.encodeValuesOnly?o.encodeValuesOnly:l.encodeValuesOnly;if(void 0===o.format)o.format=n.default;else if(!Object.prototype.hasOwnProperty.call(n.formatters,o.format))throw new TypeError("Unknown format option provided.");var E,y,x=n.formatters[o.format];"function"==typeof o.filter?r=(y=o.filter)("",r):a(o.filter)&&(E=y=o.filter);var T,A=[];if("object"!=typeof r||null===r)return"";T=o.arrayFormat in s?o.arrayFormat:"indices"in o?o.indices?"indices":"repeat":"indices";var S=s[T];E||(E=Object.keys(r)),m&&E.sort(m);for(var M=0;M<E.length;++M){var R=E[M];_&&null===r[R]||c(A,u(r[R],R,S,d,_,f?p:null,y,m,v,g,x,b))}var L=A.join(h),P=!0===o.addQueryPrefix?"?":"";return L.length>0?P+L:""}},4330:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),i=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r};e.exports={arrayToObject:i,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var n=t[i],s=n.obj[n.prop],a=Object.keys(s),o=0;o<a.length;++o){var c=a[o],h=s[c];"object"==typeof h&&null!==h&&-1===r.indexOf(h)&&(t.push({obj:s,prop:c}),r.push(h))}return function(e){for(var t;e.length;){var r=e.pop();if(t=r.obj[r.prop],Array.isArray(t)){for(var i=[],n=0;n<t.length;++n)void 0!==t[n]&&i.push(t[n]);r.obj[r.prop]=i}}return t}(t)},decode:function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},encode:function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),i="",n=0;n<t.length;++n){var s=t.charCodeAt(n);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?i+=t.charAt(n):s<128?i+=r[s]:s<2048?i+=r[192|s>>6]+r[128|63&s]:s<55296||s>=57344?i+=r[224|s>>12]+r[128|s>>6&63]+r[128|63&s]:(n+=1,s=65536+((1023&s)<<10|1023&t.charCodeAt(n)),i+=r[240|s>>18]+r[128|s>>12&63]+r[128|s>>6&63]+r[128|63&s])}return i},isBuffer:function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(r,n,s){if(!n)return r;if("object"!=typeof n){if(Array.isArray(r))r.push(n);else{if(!r||"object"!=typeof r)return[r,n];(s&&(s.plainObjects||s.allowPrototypes)||!t.call(Object.prototype,n))&&(r[n]=!0)}return r}if(!r||"object"!=typeof r)return[r].concat(n);var a=r;return Array.isArray(r)&&!Array.isArray(n)&&(a=i(r,s)),Array.isArray(r)&&Array.isArray(n)?(n.forEach((function(i,n){if(t.call(r,n)){var a=r[n];a&&"object"==typeof a&&i&&"object"==typeof i?r[n]=e(a,i,s):r.push(i)}else r[n]=i})),r):Object.keys(n).reduce((function(r,i){var a=n[i];return t.call(r,i)?r[i]=e(r[i],a,s):r[i]=a,r}),a)}}},3666:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.AccumulatePass=void 0;const n=r(9696),s=r(4597),a=r(9564),o=r(1030),c=r(7570),h=r(4895),l=r(5263),u=r(6942),d=r(1284);class _ extends o.Initializable{constructor(e){super(),this._altered=Object.assign(new s.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),this._precision=d.Wizard.Precision.half,this._write=0,this._ndcTriangleShared=!1,this._context=e}initialize(e){const t=this._context.gl;this._accumulationFBOs=[new a.Framebuffer(this._context,"AccumPingFBO"),new a.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new u.Texture2D(this._context,"AccumPingTexture"),new u.Texture2D(this._context,"AccumPongTexture")],void 0===e?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=e,this._ndcTriangleShared=!0);const i=new l.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (accumulate)");i.initialize(r(3643));const n=new l.Shader(this._context,t.FRAGMENT_SHADER,"accumulate.frag");return n.initialize(r(3170)),this._program=new h.Program(this._context,"AccumulateProgram"),this._program.initialize([i,n],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),t.uniform1f(this._uWeight,0),t.uniform1i(this._program.uniform("u_accumulationTexture"),0),t.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0}update(){if(!this._texture||!this._texture.valid)return void n.log(n.LogLevel.Warning,`valid texture for accumulation update expected, given ${this._texture}`);if(this._passThrough)return;const e=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(!this._altered.any&&!e)return void n.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected");const t=this._context.gl,r=this._context.gl2facade,i=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||e)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){const e=d.Wizard.queryInternalTextureFormat(this._context,t.RGBA,this._precision);this._accumulationTextures[0].reformat(e[0],t.RGBA,e[1]),this._accumulationTextures[1].reformat(e[0],t.RGBA,e[1])}}else{const e=d.Wizard.queryInternalTextureFormat(this._context,t.RGBA,this._precision);this._accumulationTextures[0].initialize(i[0],i[1],e[0],t.RGBA,e[1]),this._accumulationTextures[1].initialize(i[0],i[1],e[0],t.RGBA,e[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[r.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[r.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),n.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}frame(e,t){if(n.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not called)"),this._passThrough||void 0===this._texture)return;n.logIf(!this._texture||!this._texture.valid,n.LogLevel.Warning,`valid texture for accumulation frame expected, given ${this._texture}`);const r=this._context.gl;void 0!==t&&r.viewport(0,0,t[0],t[1]);const i=e%2,s=this._write=1-i,a=this._accumulationTextures[i],o=this._texture;a.bind(r.TEXTURE0),o.bind(r.TEXTURE1),this._program.bind(),r.uniform1f(this._uWeight,1/(e+1)),this._accumulationFBOs[s].bind(r.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[s].unbind(r.DRAW_FRAMEBUFFER),a.unbind(r.TEXTURE0),o.unbind(r.TEXTURE1)}set texture(e){this.assertInitialized(),this._texture!==e&&(this._texture=e,this._altered.alter("texture"))}set precision(e){this.assertInitialized(),this._precision!==e&&(this._precision=e,this._altered.alter("precision"))}set passThrough(e){this.assertInitialized(),this._passThrough!==e&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=e,this._altered.alter("passThrough"))}get framebuffer(){return this._passThrough?void 0:this._accumulationFBOs[this._write]}}i([o.Initializable.initialize()],_.prototype,"initialize",null),i([o.Initializable.uninitialize()],_.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],_.prototype,"update",null),i([o.Initializable.assert_initialized()],_.prototype,"frame",null),t.AccumulatePass=_},7945:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllocationRegister=void 0;const i=r(9130),n=r(9696);t.AllocationRegister=class{constructor(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new i.ReplaySubject(1)}bytesNext(){this._bytesSubject.next([this._bytes,this.bytesToString()])}assertIdentifier(e){n.assert(this._bytesByIdentifier.has(e),"allocation identifier unknown")}createUniqueIdentifier(e){let t=e,r=2;for(;this._bytesByIdentifier.has(t);)t=`${e}-${r}`,++r;return this._bytesByIdentifier.set(t,0),t}deleteUniqueIdentifier(e){n.assert(this._bytesByIdentifier.has(e),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(e)}allocate(e,t){if(this.assertIdentifier(e),n.assert(t>=0,`positive number of bytes expected for allocation, given ${t}`),0===t)return;const r=this._bytesByIdentifier.get(e)+t;this._bytesByIdentifier.set(e,r),this._bytes=this._bytes+t,this.bytesNext()}deallocate(e,t){this.assertIdentifier(e);const r=this._bytesByIdentifier.get(e);n.assert(t>=0,`positive number of bytes expected for deallocation, given ${t}`),n.assert(t<=r,`deallocation cannot exceed previous allocations of ${r}, given ${t}`),0!==t&&(this._bytesByIdentifier.set(e,r-t),this._bytes=this._bytes-t,this.bytesNext())}reallocate(e,t){this.assertIdentifier(e),n.assert(t>=0,`positive number of bytes expected for reallocation, given ${t}`);const r=this._bytesByIdentifier.get(e);r!==t&&(this._bytes=this._bytes-r,this._bytesByIdentifier.set(e,t),this._bytes=this._bytes+t,this.bytesNext())}allocated(e){return void 0===e?this._bytes:(this.assertIdentifier(e),this._bytesByIdentifier.get(e))}toString(){const e=new Array;return this._bytesByIdentifier.forEach(((t,r)=>{e.push(`${r}: ${n.prettyPrintBytes(t)}`)})),e.join(", ")}bytesToString(e){return n.prettyPrintBytes(this.allocated(e))}get bytes(){return this._bytes}get bytes$(){return this._bytesSubject.asObservable()}}},3411:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AntiAliasingKernel=void 0;const i=r(5785);class n extends i.RandomSquareKernel{constructor(e){super(e)}generate(){switch(this._width){case 8:this.fromJSON(r(5901));break;case 64:this.fromJSON(r(7355));break;case 128:this.fromJSON(r(8646));break;default:super.generate()}}}t.AntiAliasingKernel=n},9696:(e,t,r)=>{"use strict";const i=r(2111);var n;!function(e){let t,r=2;e.logVerbosity=function(e){return void 0!==e&&(r=Math.max(-1,e)),r},function(e){e[e.Debug=3]="Debug",e[e.Info=2]="Info",e[e.Warning=1]="Warning",e[e.Error=0]="Error"}(t=e.LogLevel||(e.LogLevel={}));const n=(e,t)=>{if(!e)throw new EvalError(t)},s=(e,t)=>{};function a(e,...t){e>r||console.log(`[${e}]`,...t)}function o(t){const r=`${t}-start`;e.assert(0===performance.getEntriesByName(t).length,`expected mark identifier to not already exists, given ${t}`),e.assert(0===performance.getEntriesByName(r).length,`expected mark identifier to not already exists, given ${r}`),performance.mark(r)}function c(r,i,n=0){const s=`${r}-start`,o=`${r}-end`;e.assert(0===performance.getEntriesByName(r).length,`expected mark identifier to not already exists, given ${r}`),e.assert(0===performance.getEntriesByName(o).length,`expected mark identifier to not already exists, given ${o}`),performance.mark(o),performance.measure(r,s,o);const c=performance.getEntriesByName(r)[0];performance.clearMarks(s),performance.clearMarks(o),performance.clearMeasures(r);const h=void 0===i||0===i.length?0:2,l=Math.max(h,n-r.length-(i?i.length:0)-1),u=d(c.duration);a(t.Debug,`${r}${" ".repeat(l)}${i||""} | ${u}`)}e.assert=n,e.assertions=function(t){return void 0!==t&&(e.assert=t?n:s),e.assert!==s},e.log=a,e.logIf=function(e,t,...r){e&&a(t,...r)},e.logPerformanceStart=o,e.logPerformanceStartIf=function(e,t){e&&o(t)},e.logPerformanceStop=c,e.logPerformanceStopIf=function(e,t,r,i=0){e&&c(t,r,i)},e.rand=function(e=0,t=1){return Math.random()*(t-e)+e},e.isPowerOfTwo=function(e){return Number.isInteger(e)&&Number.isInteger(Math.log2(e))},e.upperPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e};const h=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];e.prettyPrintBytes=function(e){const t=e>0?Math.floor(Math.log(e)/Math.log(1024)):0,r=e/Math.pow(1024,t);return`${t>0?r.toFixed(3):r}${h[t]}B`};const l=["ms","ns","μs","ms","s"],u=[0,1e6,1e3,1,.001];function d(e){let t=e>0?Math.max(1,Math.floor(Math.log(10*e)/Math.log(1e3))+3):0;return t=i.clamp(t,0,4),`${(e*u[t]).toFixed(3)}${l[t]}`}e.prettyPrintMilliseconds=d,e.bitInBitfield=function(e,t){return void 0!==t&&(e&t)===t},e.RAD2DEG=57.29577951308232,e.DEG2RAD=.017453292519943295,e.GETsearch=function(){let e=window.location.search;return e||(e=window.top?.location?.search||""),e},e.GETparameter=function(e){const t=new RegExp(`${e}=([^&]+)`);let r=window.location.search.match(t);if(r||(r=window.top?.location?.search.match(t)||null),r)return r[1]},e.PATH_SEPARATOR="/",e.dirname=function(t){return!1===t.includes(e.PATH_SEPARATOR)?"":t.substr(0,t.lastIndexOf(e.PATH_SEPARATOR)).trimLeft()},e.basename=function(t){return!1===t.includes(e.PATH_SEPARATOR)?t:t.substr(t.lastIndexOf(e.PATH_SEPARATOR)+1).trimRight()}}(n||(n={})),e.exports=n},8744:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Benchmark=void 0,t.Benchmark=class{constructor(){this._running=!1,this._results=new Array,this._framePrepare=void 0,this._runsFinished=void 0}initialize(e,t,r,i,n){this._running?console.log("benchmark already in progress"):(this._framePrepare=i,this._runsFinished=n,this._running=!0,this._frames=0,this._runs=Math.max(0,e),this._framesForWarmup=Math.max(0,t),this._framesPerCycle=Math.max(1,r),this._results.length=this._runs,this._results.fill(0))}frame(){if(!1===this._running)return;++this._frames;const e=this._frames-this._framesForWarmup,t=e<0?e:e%this._framesPerCycle,r=e>=0?Math.floor(e/this._framesPerCycle):-1;e===1-this._framesForWarmup&&console.log("---- benchmark warmup ------"),0===e&&console.log("---- benchmark started -----"),e%this._framesPerCycle==0&&r>0&&(this._results[r-1]=(performance.now()-this._results[r-1])/this._framesPerCycle,console.log(" --  cycle: "+r.toString().padStart(2,"0")+", tpf: "+this._results[r-1].toFixed(4).padStart(9,"0")+", fps: "+(1e3/this._results[r-1]).toFixed(4).padStart(9,"0"))),e%this._framesPerCycle==0&&r>=0&&r<this._runs&&(this._results[r]=performance.now()),r>=this._runs?(this._running=!1,console.log("---- benchmark stopped -----"),this._framePrepare=void 0,this._runsFinished(this._runs,this._framesForWarmup,this._framesPerCycle,this._results),this._runsFinished=void 0):this._framePrepare(t,this._framesForWarmup,this._framesPerCycle,r)}get running(){return this._running}}},4073:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.BlitPass=void 0;const n=r(3659),s=r(9696),a=r(2111),o=r(1030),c=r(7570),h=r(4895),l=r(5263);class u extends o.Initializable{constructor(e){super(),this._enforceProgramBlit=!1,this._ndcTriangleShared=!1,this._context=e}functionBlit(){const e=this._context.gl;if(this._target.bind(e.DRAW_FRAMEBUFFER),this._framebuffer.bind(e.READ_FRAMEBUFFER),e.readBuffer(this._readBuffer),this._drawBuffer>=e.COLOR_ATTACHMENT1&&this._drawBuffer<=e.COLOR_ATTACHMENT15){const t=this._drawBuffer-e.COLOR_ATTACHMENT0,r=new Array(t+1).fill(e.NONE);r[t]=this._drawBuffer,e.drawBuffers(r)}else e.drawBuffers([this._drawBuffer]);e.enable(e.SCISSOR_TEST),e.scissor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.SCISSOR_TEST);const t=this._srcBounds?this._srcBounds:[0,0,this._framebuffer.width,this._framebuffer.height],r=this._dstBounds?this._dstBounds:[0,0,this._target.width,this._target.height];e.blitFramebuffer(t[0],t[1],t[2],t[3],r[0],r[1],r[2],r[3],e.COLOR_BUFFER_BIT,this._filter),this._framebuffer.unbind(e.READ_FRAMEBUFFER),this._target.unbind(e.DRAW_FRAMEBUFFER)}programBlit(){void 0===this._program&&this.createProgram(),s.assert(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");const e=this._context.gl,t=this._srcBounds?this._srcBounds:n.vec4.fromValues(0,0,this._framebuffer.width,this._framebuffer.height),r=this._dstBounds?this._dstBounds:n.vec4.fromValues(0,0,this._target.width,this._target.height),i=n.vec4.div(a.v4(),t,[this._framebuffer.width,this._framebuffer.height,this._framebuffer.width,this._framebuffer.height]),o=n.vec4.div(a.v4(),r,[this._target.width,this._target.height,this._target.width,this._target.height]);e.viewport(r[0],r[1],r[2]-r[0],r[3]-r[1]),e.disable(e.DEPTH_TEST),e.depthMask(!1),this._program.bind(),e.uniform4fv(this._uSrcBounds,i),e.uniform4fv(this._uDstBounds,o),e.uniform1i(this._uNearest,this.filter===e.nearest);const c=this._framebuffer.texture(this._readBuffer);c.bind(e.TEXTURE0);const h=this._context.isWebGL2?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER;this._target.bind(h),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(h),c.unbind(),e.enable(e.DEPTH_TEST),e.depthMask(!0)}createProgram(){s.assert(void 0===this._program,"expected blit program to be undefined before its creation");const e=this._context.gl,t=new l.Shader(this._context,e.VERTEX_SHADER,"blit.vert (blit)");t.initialize(r(985));const i=new l.Shader(this._context,e.FRAGMENT_SHADER,"blit.frag (blit)");return i.initialize(r(3717)),this._program=new h.Program(this._context,"BlitProgram"),this._program.initialize([t,i],!1),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._program.bind(),e.uniform1i(this._program.uniform("u_source"),0),this._program.unbind(),this._program.valid}initialize(e){const t=this._context.gl;return void 0===e?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._filter=t.NEAREST,!0}uninitialize(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()}frame(){s.logIf(!this._target||!this._target.valid,s.LogLevel.Warning,`valid target expected, given ${this._target}`),s.logIf(!this._framebuffer||!this._framebuffer.valid,s.LogLevel.Warning,`valid framebuffer for blitting from expected, given ${this._framebuffer}`);const e=this._context.gl;switch(this._readBuffer){case e.DEPTH_ATTACHMENT:case e.STENCIL_ATTACHMENT:case e.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer&&!1===this._enforceProgramBlit)return this.functionBlit();this.programBlit()}set framebuffer(e){this.assertInitialized(),this._framebuffer=e}set readBuffer(e){this.assertInitialized(),this._readBuffer=e}set drawBuffer(e){this.assertInitialized(),this._drawBuffer=e}set target(e){this.assertInitialized(),this._target=e}set filter(e){this._filter=e}set srcBounds(e){this._srcBounds=e?n.vec4.clone(e):void 0}set dstBounds(e){this._dstBounds=e?n.vec4.clone(e):void 0}set enforceProgramBlit(e){this._enforceProgramBlit=e}}i([o.Initializable.initialize()],u.prototype,"initialize",null),i([o.Initializable.uninitialize()],u.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],u.prototype,"frame",null),t.BlitPass=u},6404:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=void 0;const n=r(9696),s=r(1030),a=r(2281);class o extends a.AbstractObject{constructor(){super(...arguments),this._target=o.DEFAULT_BUFFER}create(e){const t=this._context.gl;return this._object=t.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&(n.assert(e===t.ARRAY_BUFFER||e===t.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=e),this._object}delete(){n.assert(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=o.DEFAULT_BUFFER}bind(){n.assert(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)}unbind(){this.context.gl.bindBuffer(this._target,o.DEFAULT_BUFFER)}data(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.bufferData(this._target,e,t),i&&this.unbind(),this._valid=n.isBuffer(this._object)&&n.getError()===n.NO_ERROR;const s="number"==typeof e?e:e.byteLength,a=this._valid?s:0;this.context.allocationRegister.reallocate(this._identifier,a)}subData(e,t,r=0,i=0,n=!0,s=!0){const a=this.context.gl;n&&this.bind(),this.context.gl2facade.bufferSubData(this._target,e,t,r,i),s&&this.unbind(),this._valid=a.getError()===a.NO_ERROR}attribEnable(e,t,r,i=!1,n=0,s=0,a=!0,o=!0){const c=this.context.gl;a&&this.bind(),c.vertexAttribPointer(e,t,r,i,n,s),c.enableVertexAttribArray(e),o&&this.unbind()}attribDisable(e,t=!0,r=!0){const i=this.context.gl;t&&this.bind(),i.disableVertexAttribArray(e),r&&this.unbind()}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get target(){return this.assertInitialized(),this._target}}o.DEFAULT_BUFFER=void 0,i([s.Initializable.assert_initialized()],o.prototype,"bind",null),i([s.Initializable.assert_initialized()],o.prototype,"unbind",null),i([s.Initializable.assert_initialized()],o.prototype,"data",null),i([s.Initializable.assert_initialized()],o.prototype,"attribEnable",null),i([s.Initializable.assert_initialized()],o.prototype,"attribDisable",null),t.Buffer=o},4082:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Camera=void 0;const i=r(3659),n=r(2111),s=r(9696),a=r(4934);class o{constructor(e,t,r){this._fovy=o.DEFAULT_FOVY,this._near=o.DEFAULT_NEAR,this._far=o.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=e?i.vec3.clone(e):i.vec3.clone(o.DEFAULT_EYE),this._center=t?i.vec3.clone(t):i.vec3.clone(o.DEFAULT_CENTER),this._up=r?i.vec3.clone(r):i.vec3.clone(o.DEFAULT_UP)}static calculateFovY(e,t){return 2*Math.atan(.5*e/t)}invalidate(e,t,r=!1){e&&(this._view=void 0,this._viewInverse=void 0),t&&(this._projection=void 0,this._projectionInverse=void 0),(e||t||r)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0}get eye(){return this._eye}set eye(e){i.vec3.equals(this._eye,e)||(this._eye=i.vec3.clone(e),this.invalidate(!0,!1))}get center(){return this._center}set center(e){i.vec3.equals(this._center,e)||(this._center=i.vec3.clone(e),this.invalidate(!0,!1))}get up(){return this._up}set up(e){i.vec3.equals(this._up,e)||(this._up=i.vec3.clone(e),this.invalidate(!0,!1))}get fovy(){return this._fovy}set fovy(e){this._fovy!==e&&(this._fovy=e,this.invalidate(!1,!0))}set fovx(e){const t=e*s.DEG2RAD,r=2*Math.atan(Math.tan(t/2)*(1/this.aspect))*s.RAD2DEG;this._fovy!==r&&(this._fovy=r,this.invalidate(!1,!0))}fovFromLens(e,t){const r=2*Math.atan(e/(2*t));this.fovx=r*s.RAD2DEG}get near(){return this._near}set near(e){this._near!==e&&(e>=this._far&&s.log(s.LogLevel.Warning,`near expected to be smaller than far (${this._far}), given ${e}`),this._near=e,this.invalidate(!1,!0))}get far(){return this._far}set far(e){this._far!==e&&(this._near>=e&&s.log(s.LogLevel.Warning,`far expected to be greater than near (${this._near}), given ${e}`),this._far=e,this.invalidate(!1,!0))}set viewport(e){this._viewport[0]===e[0]&&this._viewport[1]===e[1]||(this._viewport=a.duplicate2(e),this.invalidate(!1,!0))}get viewport(){return this._viewport}get width(){return this._viewport[0]}get height(){return this._viewport[1]}set aspect(e){this._aspect!==e&&(this._aspect=e)}get aspect(){return this._aspect}get view(){return this._view||(this._view=i.mat4.lookAt(n.m4(),this._eye,this._center,this._up)),this._view}get viewInverse(){return void 0!==this._viewInverse||(this._viewInverse=i.mat4.invert(n.m4(),this.view)),this._viewInverse}get projection(){return this._projection||(this._projection=i.mat4.perspective(n.m4(),this.fovy*s.DEG2RAD,this.aspect,this.near,this.far)),this._projection}get projectionInverse(){return void 0!==this._projectionInverse||(this._projectionInverse=i.mat4.invert(n.m4(),this.projection)),this._projectionInverse}get viewProjection(){return this._viewProjection||(this._viewProjection=i.mat4.multiply(n.m4(),this.projection,this.view),this._viewProjection=i.mat4.multiply(n.m4(),this.postViewProjection,this._viewProjection)),this._viewProjection}get viewProjectionInverse(){return void 0!==this._viewProjectionInverse||(this._viewProjectionInverse=i.mat4.invert(n.m4(),this.viewProjection)),this._viewProjectionInverse}get postViewProjection(){return this._postViewProjection?this._postViewProjection:i.mat4.identity(n.m4())}set postViewProjection(e){this._postViewProjection=e,this.invalidate(!1,!1,!0)}get altered(){return this._altered}set altered(e){this._altered=e}}t.Camera=o,o.DEFAULT_EYE=i.vec3.fromValues(0,0,1),o.DEFAULT_CENTER=i.vec3.fromValues(0,0,0),o.DEFAULT_UP=i.vec3.fromValues(0,1,0),o.DEFAULT_FOVY=45,o.DEFAULT_NEAR=2,o.DEFAULT_FAR=8},6491:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraModifier=void 0;const i=r(4082);t.CameraModifier=class{constructor(){this._camera=void 0,this._reference=new i.Camera}set camera(e){this._camera!==e&&(this._camera=e,void 0!==e&&(Object.assign(this._reference,e),this.update()))}}},7063:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;const i=r(9130),n=r(3659),s=r(2111),a=r(9696),o=r(4934),c=r(7677),h=r(4518),l=r(3863),u=r(5838),d=r(4841),_=r(8319),f=r(6346),p=r(4052),m=r(3668),v=r(1284);class g extends f.Resizable{constructor(e,t){super(),this._framePrecisionSubject=new i.ReplaySubject(1),this._size=[0,0],this._sizeSubject=new i.ReplaySubject(1),this._frameScaleSubject=new i.ReplaySubject(1),this._frameSizeSubject=new i.ReplaySubject(1),this._element=e instanceof HTMLCanvasElement?e:document.getElementById(e),this._element.addEventListener("webglcontextcreationerror",(e=>{console.log(e.statusMessage||"Unknown error")}),!1),this.observe(this._element),this._mouseEventProvider=new d.MouseEventProvider(this._element,200),this._touchEventProvider=new p.TouchEventProvider(this._element,200),this._pointerEventProvider=new _.PointerEventProvider(this._element,200),this._keyboardEventProvider=new m.KeyboardEventProvider(this._element,200),this._element.style.touchAction="none";const r=this._element.dataset;let n;this._context=h.Context.request(this._element,t),this.configureController(r),this.configureSizeAndScale(r),this.configureContextLostAndRestore(),this.configureContextLostAndRestoreEmulation(),r.clearColor&&(n=s.parseVec4(r.clearColor),a.logIf(void 0===n,a.LogLevel.Warning,`data-clear-color could not be parsed, given '${r.clearColor}'`)),this._clearColor=n?new c.Color(o.tuple4(n)):g.DEFAULT_CLEAR_COLOR;let l=r.accumulationFormat?r.accumulationFormat:g.DEFAULT_FRAME_PRECISION;l in v.Wizard.Precision||(l=g.DEFAULT_FRAME_PRECISION,a.log(a.LogLevel.Warning,`unknown frame precision '${r.accumulationFormat}' changed to '${l}'`)),this._framePrecision=l,this.framePrecisionNext()}configureController(e){let t,r;this._controller=new l.Controller,this._controller.block(),e.multiFrameNumber&&(t=parseInt(e.multiFrameNumber,10),a.logIf(isNaN(t),a.LogLevel.Warning,`data-multi-frame-number could not be parsed, given '${e.multiFrameNumber}'`)),e.debugFrameNumber&&(r=parseInt(e.debugFrameNumber,10),a.logIf(isNaN(r),a.LogLevel.Warning,`data-debug-frame-number could not be parsed, given '${e.debugFrameNumber}'`)),this._controller.multiFrameNumber=t||g.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=r||0;const i=!!t&&t!==this._controller.multiFrameNumber;a.logIf(i,a.LogLevel.Warning,`data-multi-frame-number changed to ${this._controller.multiFrameNumber}, given '${e.multiFrameNumber}'`);const n=!!r&&r!==this._controller.debugFrameNumber;a.logIf(n,a.LogLevel.Warning,`data-debug-frame-number changed to ${this._controller.debugFrameNumber}, given '${e.debugFrameNumber}'`)}configureSizeAndScale(e){let t,r;e.frameScale&&(t=s.parseVec2(e.frameScale),a.logIf(void 0!==e.frameScale&&void 0===t,a.LogLevel.Warning,`data-frame-scale could not be parsed, given '${e.frameScale}'`)),this._frameScale=t?o.tuple2(t):[1,1],e.frameSize&&(r=s.parseVec2(e.frameSize),a.logIf(void 0!==e.frameSize&&void 0===r,a.LogLevel.Warning,`data-frame-size could not be parsed, given '${e.frameSize}'`)),this._favorSizeOverScale=void 0!==r,this._frameSize=r?o.tuple2(r):[this._size[0],this._size[1]],this.onResize()}configureContextLostAndRestore(){this._element.addEventListener("webglcontextlost",(e=>{e.preventDefault(),this.onContextLost()}),!1),this._element.addEventListener("webglcontextrestored",(()=>{this.onContextRestore()}),!1)}configureContextLostAndRestoreEmulation(){this._lostContextExtension=this._context.gl.getExtension("WEBGL_lose_context")}onContextLost(){a.log(a.LogLevel.Warning,"WebGL Context lost. Discarding renderer..."),this._controller.cancel(),this._controller.block(),this._renderer&&this._renderer.discard()}onContextRestore(){a.log(a.LogLevel.Warning,"WebGL Context restored. Reinitializing renderer...");const e=this._renderer;this.unbind(),this.bind(e),this._controller.unblock();const t=this._element.style.visibility;this._element.style.visibility="hidden",this._element.offsetHeight,this._element.style.visibility=t}retrieveSize(){const e=f.Resizable.elementSize(this._element);void 0!==e?(this._size=[e[0],e[1]],this.sizeNext()):this._size=[0,0]}onResize(){if(this.retrieveSize(),0===this._size[0]||0===this._size[1])return a.log(a.LogLevel.Debug,"canvas width or height is invalid, resize discarded and controller blocked"),void this._controller.block();this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())}framePrecisionNext(){this._framePrecisionSubject.next(this._framePrecision)}sizeNext(){this._sizeSubject.next(this._size)}frameScaleNext(){this._frameScaleSubject.next(this._frameScale)}frameSizeNext(){this._frameSizeSubject.next(this._frameSize)}bind(e){this._renderer!==e&&(this.unbind(),void 0!==e&&(a.assert(this._controller.blocked,"expected controller to be blocked"),this._renderer=e,this._renderer.initialize(this.context,(e=>this._controller.update(e)),{pointerEventProvider:this._pointerEventProvider,mouseEventProvider:this._mouseEventProvider,eyeGazeEventProvider:this._eyeGazeEventProvider,keyboardEventProvider:this._keyboardEventProvider}),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))}unbind(){void 0!==this._renderer&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)}dispose(){super.dispose(),this._renderer&&(this._renderer.uninitialize(),this.unbind())}resize(){this.onResize()}get controller(){return this._controller}get renderer(){return this._renderer}set renderer(e){this.bind(e)}get frameScale(){return this._frameScale}set frameScale(e){if(!isFinite(e[0])||!isFinite(e[1]))return void a.log(a.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${e}]`);a.logIf(e[0]<0||e[0]>8,a.LogLevel.Info,`frame width scale clamped to [0.0,2.0], given ${e[0]}`),a.logIf(e[1]<0||e[1]>8,a.LogLevel.Info,`frame height scale clamped to [0.0,2.0], given ${e[0]}`);const t=n.vec2.create();s.clamp2(t,e,[0,0],[8,8]);const r=n.vec2.create();n.vec2.mul(r,this._size,t),n.vec2.max(r,[1,1],r),n.vec2.round(r,r),n.vec2.div(t,r,this._size),a.logIf(!n.vec2.exactEquals(t,e),2,`frame scale was adjusted to ${t.toString()}, given ${e.toString()}`),this._frameScale=o.tuple2(t),this._frameSize=o.tuple2(r),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameScale$(){return this._frameScaleSubject.asObservable()}get frameSize(){return this._frameSize}set frameSize(e){if(!isFinite(e[0])||!isFinite(e[1]))return void a.log(a.LogLevel.Warning,`expected finite frame size, non-finite values ignored, given [${e}]`);a.logIf(e[0]<1||e[0]>8*this._size[0],a.LogLevel.Info,`frame width scale clamped to [1,${this._size[0]}], given ${e[0]}`),a.logIf(e[1]<1||e[1]>8*this._size[1],a.LogLevel.Info,`frame height scale clamped to [1, ${this._size[1]}], given ${e[1]}`);const t=n.vec2.create();s.clamp2(t,e,[1,1],[8*this._size[0],8*this._size[1]]),n.vec2.round(t,t),a.logIf(!n.vec2.exactEquals(t,e),a.LogLevel.Warning,`frame size was adjusted to ${t.toString()}, given ${e.toString()}`);const r=n.vec2.create();n.vec2.div(r,t,this._size),this._frameScale=o.tuple2(r),this._frameSize=o.tuple2(t),this._favorSizeOverScale=!n.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}get frameSize$(){return this._frameSizeSubject.asObservable()}get clearColor(){return this._clearColor}set clearColor(e){this._clearColor=e,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)}get framePrecision(){return this._framePrecision}set framePrecision(e){this._framePrecision=e,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()}get framePrecision$(){return this._framePrecisionSubject.asObservable()}get context(){return this._context}get backend(){return this._context.backendString}get size(){return this._size}get size$(){return this._sizeSubject.asObservable()}get width(){return this._size[0]}get height(){return this._size[1]}get element(){return this._element}get mouseEventProvider(){return this._mouseEventProvider}get touchEventProvider(){return this._touchEventProvider}get keyboardEventProvider(){return this._keyboardEventProvider}testLoseContext(){void 0!==this._lostContextExtension&&this._lostContextExtension.loseContext()}testRestoreContext(){void 0!==this._lostContextExtension&&this._lostContextExtension.restoreContext()}get eyeGazeEventProvider(){return this._eyeGazeEventProvider}activateEyeGazeEventProvider(e,t){this._eyeGazeEventProvider=new u.EyeGazeEventProvider(e,t)}}t.Canvas=g,g.DEFAULT_CLEAR_COLOR=new c.Color([.203,.227,.25,1]),g.DEFAULT_FRAME_PRECISION=v.Wizard.Precision.auto,g.DEFAULT_MULTI_FRAME_NUMBER=0},6233:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasRecorder=void 0;const i=r(9696);class n{constructor(e){i.assert(n.isSupported(),"Recording the canvas is not supported."),this._canvas=e,this._state=n.State.INACTIVE,this._images=new Array}static isSupported(){return void 0!==window.MediaRecorder}static isMIMETypeSupported(e){return MediaRecorder.isTypeSupported(e)}start(e,t="video/webm",r=4194304){i.assert(e>=0,"FPS has to be positive"),i.assert(this._state===n.State.INACTIVE,"Recorder has to be inactive."),i.assert(n.isMIMETypeSupported(t),`MIME type: ${t} is not supported.`),this._stream=this._canvas.element.captureStream(e),this._recorder=new MediaRecorder(this._stream,{mimeType:t,bitsPerSecond:r}),this._images.length=0,this._mimeType=t,this._recorder.ondataavailable=e=>this._images.push(e.data),this._recorder.onstop=()=>{this._onImagesAvailable&&this._onImagesAvailable(this._images)},this._recorder.start(),this._state=n.State.RECORDING}stop(){i.assert(this._state!==n.State.INACTIVE,"Recorder must not be inactive.");const e=this._stream.getTracks();i.assert(1===e.length,"CanvasRecorder uses outdated version of MediaStream API."),this._recorder.stop(),e[0].stop(),this._recorder=void 0,this._stream=void 0,this._state=n.State.INACTIVE}pause(){i.assert(this._state!==n.State.INACTIVE,"Recorder must not be inactive."),this._recorder.pause(),this._state=n.State.PAUSED}resume(){i.assert(this._state!==n.State.INACTIVE,"Recorder must not be inactive."),this._recorder.resume(),this._state=n.State.RECORDING}frame(){i.assert(this._state===n.State.RECORDING,"Recorder has to be recording.");const e=this._stream.getTracks();i.assert(1===e.length,"CanvasRecorder uses unknown implementation of MediaStream API."),i.assert(this._stream.requestFrame||e[0].requestFrame,"CanvasRecorder uses unknown implementation of MediaStream API."),this._stream.requestFrame?this._stream.requestFrame():e[0].requestFrame()}download(e){const t=URL.createObjectURL(this.blob),r=document.createElement("a");r.style.display="none",r.setAttribute("href",t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),setTimeout((()=>{document.body.removeChild(r),window.URL.revokeObjectURL(t)}),256)}get images(){return this._images}get state(){return this._state}get blob(){return new Blob(this._images,{type:this._mimeType})}set onImagesAvailable(e){this._onImagesAvailable=e}}t.CanvasRecorder=n,function(e){let t;!function(e){e[e.INACTIVE=0]="INACTIVE",e[e.RECORDING=1]="RECORDING",e[e.PAUSED=2]="PAUSED"}(t=e.State||(e.State={}))}(n=t.CanvasRecorder||(t.CanvasRecorder={}))},4597:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeLookup=void 0;const i=r(9696);class n{static alter(e,t){i.assert(t.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),t.any=!0;const r=e.split("."),s=r.shift();if(i.assert(""===s||t.hasOwnProperty(s),`expected object to have key '${s}' in order to capture alterations`),""!==s&&"object"!=typeof t[s])return void(t[s]=!0);if(""!==s&&r.length>0)return void n.alter(r.join("."),t[s]);const a=""!==s?t[s]:t;for(const e of Object.getOwnPropertyNames(a))"any"!==e&&n.alter(e,a)}static reset(e){for(const t of Object.getOwnPropertyNames(e))"object"!=typeof e[t]?e[t]=!1:n.reset(e[t])}alter(e){return n.alter(e,this)}reset(){return n.reset(this)}}t.ChangeLookup=n},7677:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Color=void 0;const i=r(3659),n=r(2111),s=r(9696),a=r(4934);class o{constructor(e,t){this._rgba=[0,0,0,o.DEFAULT_ALPHA],this._altered=!1,void 0!==e&&(3===e.length&&void 0!==t?this.fromF32(e[0],e[1],e[2],t):4===e.length?(this.fromF32(e[0],e[1],e[2],e[3]),s.assert(void 0===t,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(e[0],e[1],e[2]))}static hue2rgb(e,t,r){return s.assert(r>=-1&&r<=2,"t is expected to be between -1 and 2"),r<0?r+=1:r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(t-e)*(2/3-r):e}static to2CharHexCode(e){return(e<15.5/255?"0":"")+Math.round(255*e).toString(16)}static hsl2rgb(e){const t=a.clampf3(e,"HSL input");if(0===t[1])return[t[2],t[2],t[2]];const r=t[2]<.5?t[2]*(1+t[1]):t[2]+t[1]-t[1]*t[2],i=2*t[2]-r;return[o.hue2rgb(i,r,t[0]+1/3),o.hue2rgb(i,r,t[0]),o.hue2rgb(i,r,t[0]-1/3)]}static rgb2hsl(e){const t=a.clampf3(e,"RGB input"),r=[0,0,0],i=Math.min(t[0],t[1],t[2]),n=Math.max(t[0],t[1],t[2]),s=n-i;if(r[2]=.5*(n+i),0===s)return r;r[1]=r[2]<.5?s/(n+i):s/(2-n-i);const o=((n-t[0])/6+s/2)/s,c=((n-t[1])/6+s/2)/s,h=((n-t[2])/6+s/2)/s;return t[0]===n?r[0]=h-c:t[1]===n?r[0]=o-h+1/3:r[0]=c-o+2/3,r}static lab2xyz(e){const t=a.clampf3(e,"LAB input"),r=(100*t[0]+16)/116,i=(256*t[1]-128)/500+r,n=r-(256*t[2]-128)/200,s=Math.pow(i,3),o=Math.pow(r,3),c=Math.pow(n,3);return[.95047*(s>.008856?s:(i-16/116)/7.787),1*(o>.008856?o:(r-16/116)/7.787),1.08883*(c>.008856?c:(n-16/116)/7.787)]}static xyz2lab(e){const t=[e[0]/.95047,e[1]/1,e[2]/1.08883],r=t[0]>.008856?Math.cbrt(t[0]):7.787*t[0]+16/116,i=t[1]>.008856?Math.cbrt(t[1]):7.787*t[1]+16/116,n=t[2]>.008856?Math.cbrt(t[2]):7.787*t[2]+16/116;return a.clampf3([(116*i-16)/100,(500*(r-i)+128)/256,(200*(i-n)+128)/256])}static xyz2rgb(e){const t=2.04137*e[0]+-.56495*e[1]+-.34469*e[2],r=-.96927*e[0]+1.87601*e[1]+.04156*e[2],i=.01345*e[0]+-.11839*e[1]+1.01541*e[2];return a.clampf3([t>0?Math.pow(t,1/2.19921875):0,r>0?Math.pow(r,1/2.19921875):0,i>0?Math.pow(i,1/2.19921875):0])}static rgb2xyz(e){const t=a.clampf3(e,"RGB input"),r=Math.pow(t[0],2.19921875),i=Math.pow(t[1],2.19921875),n=Math.pow(t[2],2.19921875);return[.57667*r+.18555*i+.18819*n,.29738*r+.62735*i+.07527*n,.02703*r+.07069*i+.9911*n]}static lab2rgb(e){return o.xyz2rgb(o.lab2xyz(e))}static rgb2lab(e){return o.xyz2lab(o.rgb2xyz(e))}static cmyk2rgb(e){const t=a.clampf4(e,"CMYK input"),r=1-t[3];return[(1-t[0])*r,(1-t[1])*r,(1-t[2])*r]}static rgb2cmyk(e){const t=a.clampf3(e,"RGB input"),r=1-Math.max(t[0],t[1],t[2]),i=1-r,n=0===i?0:1/i;return[(i-t[0])*n,(i-t[1])*n,(i-t[2])*n,r]}static hex2rgba(e){const t=[0,0,0,o.DEFAULT_ALPHA];if(!o.HEX_FORMAT_REGEX.test(e))return s.log(s.LogLevel.Warning,`hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '${e}'`),t;const r=e.startsWith("0x")?2:e.startsWith("#")?1:0,i=Math.floor((e.length-r)/3),n=i-1;return t[0]=parseInt(e[r+0*i]+e[r+0*i+n],16)/255,t[1]=parseInt(e[r+1*i]+e[r+1*i+n],16)/255,t[2]=parseInt(e[r+2*i]+e[r+2*i+n],16)/255,e.length-r!=4&&e.length-r!=8||(t[3]=parseInt(e[r+3*i]+e[r+3*i+n],16)/255),s.assert(!(isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])),`expected well formated hexadecimal RGBA string, given '${e}'`),t}static rgb2hex(e){const t=a.clampf3(e,"RGB input");return"#"+o.to2CharHexCode(t[0])+o.to2CharHexCode(t[1])+o.to2CharHexCode(t[2])}static rgba2hex(e){const t=a.clampf4(e,"RGBA input");return"#"+o.to2CharHexCode(t[0])+o.to2CharHexCode(t[1])+o.to2CharHexCode(t[2])+o.to2CharHexCode(t[3])}static lerp(e,t,r,s=o.Space.LAB){if(r<=0)return new o(e.rgba);if(r>=1)return new o(t.rgba);const a=i.vec4.create();switch(s){case o.Space.CMYK:i.vec4.lerp(a,e.cmyk,t.cmyk,r);const s=n.mix(e.a,t.a,r);return(new o).fromCMYK(a[0],a[1],a[2],a[3],s);case o.Space.LAB:return i.vec4.lerp(a,e.laba,t.laba,r),(new o).fromLAB(a[0],a[1],a[2],a[3]);case o.Space.HSL:return i.vec4.lerp(a,e.hsla,t.hsla,r),(new o).fromHSL(a[0],a[1],a[2],a[3]);case o.Space.RGB:return i.vec4.lerp(a,e.rgba,t.rgba,r),(new o).fromRGB(a[0],a[1],a[2],a[3])}}equals(e){return a.equals4(this._rgba,e._rgba)}fromF32(e,t,r,i=o.DEFAULT_ALPHA){const n=a.duplicate4(this._rgba);return this._rgba[0]=a.clampf(e,"red value"),this._rgba[1]=a.clampf(t,"green value"),this._rgba[2]=a.clampf(r,"blue value"),this._rgba[3]=a.clampf(i,"alpha value"),this._altered=!a.equals4(this._rgba,n),this}fromUI8(e,t,r,i=Math.floor(255*o.DEFAULT_ALPHA)){const s=a.duplicate4(this._rgba);return this._rgba[0]=n.clamp(e,0,255)/255,this._rgba[1]=n.clamp(t,0,255)/255,this._rgba[2]=n.clamp(r,0,255)/255,this._rgba[3]=n.clamp(i,0,255)/255,this._altered=!a.equals4(this._rgba,s),this}fromRGB(e,t,r,i=o.DEFAULT_ALPHA){const n=a.duplicate4(this._rgba);return this._rgba=a.clampf4([e,t,r,i],"RGBA input"),this._altered=!a.equals4(this._rgba,n),this}fromHSL(e,t,r,i=o.DEFAULT_ALPHA){const n=a.duplicate4(this._rgba),s=o.hsl2rgb([e,t,r]),c=a.clampf(i,"ALPHA input");return this._rgba=[s[0],s[1],s[2],c],this._altered=!a.equals4(this._rgba,n),this}fromLAB(e,t,r,i=o.DEFAULT_ALPHA){const n=a.duplicate4(this._rgba),s=o.lab2rgb([e,t,r]),c=a.clampf(i,"ALPHA input");return this._rgba=[s[0],s[1],s[2],c],this._altered=!a.equals4(this._rgba,n),this}fromCMYK(e,t,r,i,n=o.DEFAULT_ALPHA){const s=a.duplicate4(this._rgba),c=o.cmyk2rgb([e,t,r,i]),h=a.clampf(n,"ALPHA input");return this._rgba=[c[0],c[1],c[2],h],this._altered=!a.equals4(this._rgba,s),this}fromHex(e){const t=a.duplicate4(this._rgba);return this._rgba=o.hex2rgba(e),this._altered=!a.equals4(this._rgba,t),this}gray(e=o.GrayscaleAlgorithm.LinearLuminance){switch(e){case o.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case o.GrayscaleAlgorithm.LeastSaturatedVariant:return.5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case o.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case o.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case o.GrayscaleAlgorithm.LinearLuminance:return.2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}}tuple(e,t=!0){switch(e){case o.Space.RGB:return t?this.rgba:this.rgb;case o.Space.LAB:return t?this.laba:this.lab;case o.Space.CMYK:return t?this.cmyka:this.cmyk;case o.Space.HSL:return t?this.hsla:this.hsl}}get rgb(){return[this._rgba[0],this._rgba[1],this._rgba[2]]}get rgbUI8(){const e=new Uint8Array(3);return e[0]=Math.round(255*this._rgba[0]),e[1]=Math.round(255*this._rgba[1]),e[2]=Math.round(255*this._rgba[2]),e}get rgbF32(){const e=new Float32Array(3);return e[0]=this._rgba[0],e[1]=this._rgba[1],e[2]=this._rgba[2],e}get rgba(){return this._rgba}get rgbaUI8(){const e=new Uint8Array(4);return e[0]=Math.round(255*this._rgba[0]),e[1]=Math.round(255*this._rgba[1]),e[2]=Math.round(255*this._rgba[2]),e[3]=Math.round(255*this._rgba[3]),e}get rgbaF32(){return new Float32Array(this._rgba)}get r(){return this._rgba[0]}get g(){return this._rgba[1]}get b(){return this._rgba[2]}get a(){return this._rgba[3]}get hexRGB(){return o.rgb2hex(this.rgb)}get hexRGBA(){return o.rgba2hex(this._rgba)}get hsl(){return o.rgb2hsl(this.rgb)}get hsla(){const e=o.rgb2hsl(this.rgb);return[e[0],e[1],e[2],this._rgba[3]]}get lab(){return o.rgb2lab(this.rgb)}get laba(){const e=o.rgb2lab(this.rgb);return[e[0],e[1],e[2],this._rgba[3]]}get cmyk(){return o.rgb2cmyk(this.rgb)}get cmyka(){const e=o.rgb2cmyk(this.rgb);return[e[0],e[1],e[2],e[3],this._rgba[3]]}get altered(){return this._altered}set altered(e){this._altered=e}}t.Color=o,o.DEFAULT_ALPHA=1,o.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),function(e){let t,r;!function(e){e.Average="average",e.LinearLuminance="linear-luminance",e.LeastSaturatedVariant="least-saturated-variant",e.MinimumDecomposition="minimum-decomposition",e.MaximumDecomposition="maximum-decomposition"}(t=e.GrayscaleAlgorithm||(e.GrayscaleAlgorithm={})),function(e){e.RGB="rgb",e.HSL="hsl",e.LAB="lab",e.CMYK="cmyk"}(r=e.Space||(e.Space={}))}(o=t.Color||(t.Color={}))},5252:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorScale=void 0;const i=r(2111),n=r(9696),s=r(7677),a=r(6869);class o{constructor(){this._hint=o.InterpolationHint.Linear,this._colors=new Array,this._inverted=!1}static stride(e){switch(e){case o.ArrayType.RGBA:case o.ArrayType.RGBAf:return 4;case o.ArrayType.RGB:case o.ArrayType.RGBf:default:return 3}}static fromPreset(e,t,r){return a.fetchJsonAsync(e,(e=>{let i;for(const r of e)if(r.identifier===t){i=r;break}if(void 0===i)return;const n=i.format,s=o.stride(n),a=i.colors;let c=a.length-1;for(let e=0;e<a.length;++e)if(a[e].length===r*s){c=e;break}const h=a[c],l=i.positions;if(void 0===l)return o.fromArray(h,n,r,void 0);let u;for(let e=0;e<l.length;++e)l[e].length===h.length&&(u=l[e]);return o.fromArray(h,n,r,u)}),o.SCHEMA.properties)}static fromArray(e,t,r,i){if(0===r||0===e.length)return new o;const a=e,c=o.stride(t),h=a.length/c,l=new Array(h);for(let e=0;e<a.length;e+=c){const r=new s.Color;switch(t){case o.ArrayType.RGB:r.fromUI8(a[e+0],a[e+1],a[e+2]);break;case o.ArrayType.RGBA:r.fromUI8(a[e+0],a[e+1],a[e+2],a[e+3]);break;case o.ArrayType.RGBf:r.fromF32(a[e+0],a[e+1],a[e+2]);break;case o.ArrayType.RGBAf:r.fromF32(a[e+0],a[e+1],a[e+2],a[e+3])}l[e/c]=r}const u=new o;if(void 0===i&&r===h)return u._colors=l,u;if(1===r&&u._colors.push(l[0]),void 0===i){(i=new Array(h))[0]=0;for(let e=1;e<h;++e)i[e]=e/(h-1)}n.assert(i.length===l.length,`expected number of positions (${i.length}) to match number of colors (${l.length})`);let d=0,_=d+1;const f=h-1;for(let e=0;e<r;++e){const t=0===e?0:e/(r-1);if(t<=i[d]){u._colors.push(l[d]);continue}if(i[f]<=t){u._colors.push(l[f]);continue}for(let e=d+1;e<h;++e)if(!(i[e]<t)){_=e,d=e-1;break}const n=(t-i[d])/(i[_]-i[d]);u._colors.push(s.Color.lerp(l[d],l[_],n,s.Color.Space.LAB))}return u}lerp(e,t=s.Color.Space.LAB){if(0===this._colors.length)return;if(1===this._colors.length)return this._colors[0];const r=i.clamp(e,0,1);if(r<=0)return this._colors[0];if(r>=1)return this._colors[this._colors.length-1];const a=e*this._colors.length,c=Math.floor(a),h=c+1;return h>=this._colors.length?this._colors[this._colors.length-1]:(n.assert(h<this._colors.length,`expected upper not exceed maximum color index: ${h} < ${this._colors.length}`),this._hint===o.InterpolationHint.Nearest?this._colors[a-c<=h-a?c:h]:s.Color.lerp(this._colors[c],this._colors[h],a-c,t))}color(e){if(!(e<0||e>=this._colors.length))return this._colors[e]}get colors(){return this._colors}set colors(e){this._colors=e}set hint(e){this._hint=e}get hint(){return this._hint}get length(){return this._colors.length}get inverted(){return this._inverted}invert(){this._colors.reverse(),this._inverted=!this._inverted}bitsUI8(e=s.Color.Space.RGB,t=!0){const r=this._colors.length,i=t?4:3,n=new Uint8Array(r*i);for(let s=0;s<r;++s){const r=this._colors[s].tuple(e,t);n[s*i+0]=255*r[0],n[s*i+1]=255*r[1],n[s*i+2]=255*r[2],t&&4===r.length&&(n[s*i+3]=255*r[3])}return n}bitsF32(e=s.Color.Space.RGB,t=!0){const r=this._colors.length,i=t?4:3,n=new Float32Array(r*i);for(let s=0;s<r;++s){const r=this._colors[s].tuple(e,t);n[s*i+0]=r[0],n[s*i+1]=r[1],n[s*i+2]=r[2],t&&4===r.length&&(n[s*i+3]=r[3])}return n}}t.ColorScale=o,o.SCHEMA=r(5094),function(e){let t,r,i;!function(e){e.Linear="linear",e.Nearest="nearest"}(t=e.InterpolationHint||(e.InterpolationHint={})),function(e){e.sequential="sequential",e.diverging="diverging",e.qualitative="qualitative"}(r=e.ScaleType||(e.ScaleType={})),function(e){e.RGB="rgb",e.RGBf="rgbf",e.RGBA="rgba",e.RGBAf="rgbaf"}(i=e.ArrayType||(e.ArrayType={}))}(o=t.ColorScale||(t.ColorScale={}))},4518:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;const i=r(9696),n=r(423),s=r(7945),a=r(1985),o=r(8600),c=r(9568),h=r(5218);class l{constructor(e,t){this._attributes=void 0,this._extensions=new Array,this._allocationRegister=new s.AllocationRegister,this._context=e,this._mask=t;const r=e.toString();{const e=/WebGLRenderingContext/.test(r)||/CaptureContext/.test(r),t=/WebGL2RenderingContext/.test(r);this._backend=e?l.BackendType.WebGL1:t?l.BackendType.WebGL2:void 0}if(i.assert(void 0!==this._backend&&this._backend.valueOf()!==l.BackendType.Invalid.valueOf(),`context is neither webgl nor webgl2, given ${r}`),this.queryAttributes(),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(const e in this._mask.functionsUndefine)this._context[e]=void 0;this._gl2=new h.GL2Facade(this)}static createMasqueradeFromGETorDataAttribute(e){return a.ContextMasquerade.fromGET()||(e.msqrdH?a.ContextMasquerade.fromHash(e.msqrdH):e.msqrdP?a.ContextMasquerade.fromPreset(e.msqrdP):void 0)}static request(e,t=l.DEFAULT_ATTRIBUTES){const r=e.dataset,n=l.createMasqueradeFromGETorDataAttribute(r);let s,a=n?n.backend:r.backend?r.backend.toLowerCase():"auto";switch(a in l.BackendRequestType||(i.log(i.LogLevel.Warning,`unknown backend '${r.backend}' changed to '${l.BackendRequestType.auto}'`),a="auto"),a){case l.BackendRequestType.webgl:break;case l.BackendRequestType.experimental:case l.BackendRequestType.webgl1:case l.BackendRequestType.experimental1:a=l.BackendRequestType.webgl;break;case l.BackendRequestType.webgl2:case l.BackendRequestType.experimental2:a=l.BackendRequestType.webgl2;break;default:a=l.BackendRequestType.auto}return a!==l.BackendRequestType.webgl&&(s=this.requestWebGL2(e,t)),s||(s=this.requestWebGL1(e,t),i.logIf(void 0!==s&&a===l.BackendRequestType.webgl2,i.LogLevel.Info,`backend changed to '${l.BackendRequestType.webgl}', given '${a}'`)),i.assert(!!s,"creating a context failed"),new l(s,n)}static requestWebGL1(e,t=l.DEFAULT_ATTRIBUTES){let r=e.getContext(l.BackendRequestType.webgl,t);return r||(r=e.getContext(l.BackendRequestType.experimental,t),null===r?void 0:r)}static requestWebGL2(e,t=l.DEFAULT_ATTRIBUTES){let r=e.getContext(l.BackendRequestType.webgl2,t);return r||(r=e.getContext(l.BackendRequestType.experimental2,t),null===r?void 0:r)}queryAttributes(){const e=this._context.getContextAttributes();null!==e?this._attributes=e:i.log(i.LogLevel.Error,"querying context attributes failed (probably blocked)")}get alpha(){return!!this._attributes&&this._attributes.alpha}get antialias(){return!!this._attributes&&this._attributes.antialias}get depth(){return!!this._attributes&&this._attributes.depth}get failIfMajorPerformanceCaveat(){return!!this._attributes&&this._attributes.failIfMajorPerformanceCaveat}get premultipliedAlpha(){return!!this._attributes&&this._attributes.premultipliedAlpha}get preserveDrawingBuffer(){return!!this._attributes&&this._attributes.preserveDrawingBuffer}get stencil(){return!!this._attributes&&this._attributes.stencil}supports(e){if(this._mask&&this._mask.extensionsConceal.indexOf(e)>-1)return!1;switch(this._backend){case l.BackendType.WebGL1:i.assert(o.WEBGL1_EXTENSIONS.indexOf(e)>-1,`extension ${e} not available to WebGL1`);break;case l.BackendType.WebGL2:i.assert(-1===o.WEBGL2_DEFAULT_EXTENSIONS.indexOf(e),`extension ${e} supported by default in WebGL2`),i.assert(o.WEBGL2_EXTENSIONS.indexOf(e)>-1,`extension ${e} not available to WebGL2`)}return this._extensions.indexOf(e)>-1}enable(e){for(const t of e)this.isWebGL1&&-1===o.WEBGL1_EXTENSIONS.indexOf(t)||this.isWebGL2&&-1===o.WEBGL2_EXTENSIONS.indexOf(t)||!1!==this.supports(t)&&this.extension(void 0,t)}queryExtensionSupport(){const e=this._context.getSupportedExtensions();if(null!==e){for(const t of e)this._mask&&this._mask.extensionsConceal.indexOf(t)>-1||this._extensions.push(t);this._backend===l.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===l.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")}else i.log(i.LogLevel.Error,"querying supported extensions failed (probably blocked)")}extension(e,t){return void 0===e&&(i.assert(this.supports(t),`extension ${t} expected to be supported`),e=this._context.getExtension(t)),e}get allocationRegister(){return this._allocationRegister}get backend(){return this._backend}get backendString(){switch(this._backend){case l.BackendType.WebGL1:return"WebGL";case l.BackendType.WebGL2:return"WebGL2";default:return}}get extensions(){return this._extensions}get mask(){return this._mask}get gl(){return this._context}get gl2facade(){return this._gl2}get isWebGL1(){return this._backend===l.BackendType.WebGL1}get isWebGL2(){return this._backend===l.BackendType.WebGL2}get supportsInstancedArrays(){return this.ANGLE_instanced_arrays_supported}get instancedArrays(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")}get supportsBlendMinmax(){return this.EXT_blend_minmax_supported}get blendMinmax(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")}get supportsColorBufferHalfFloat(){return this.EXT_color_buffer_half_float_supported}get colorBufferHalfFloat(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")}get supportsDisjointTimerQuery(){return this.EXT_disjoint_timer_query_supported}get disjointTimerQuery(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")}get supportsDisjointTimerQueryWebGL2(){return this.EXT_disjoint_timer_query_webgl2_supported}get disjointTimerQueryWebGL2(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")}get supportsFragDepth(){return this.EXT_frag_depth_supported}get fragDepth(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")}get supportsSRGB(){return this.EXT_sRGB_supported}get sRGB(){return this.extension(this.EXT_sRGB,"EXT_sRGB")}get supportsShaderTextureLOD(){return this.EXT_shader_texture_lod_supported}get shaderTextureLOD(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")}get supportsTextureFilterAnisotropic(){return this.EXT_texture_filter_anisotropic_supported}get textureFilterAnisotropic(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")}get supportsElementIndexUint(){return this.OES_element_index_uint_supported}get elementIndexUint(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")}get supportsStandardDerivatives(){return this.OES_standard_derivatives_supported}get standardDerivatives(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")}get supportsTextureFloat(){return this.OES_texture_float_supported}get textureFloat(){return this.extension(this.OES_texture_float,"OES_texture_float")}get supportsTextureFloatLinear(){return this.OES_texture_float_linear_supported}get textureFloatLinear(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")}get supportsTextureHalfFloat(){return this.OES_texture_half_float_supported}get textureHalfFloat(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")}get supportsTextureHalfFloatLinear(){return this.OES_texture_half_float_linear_supported}get textureHalfFloatLinear(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")}get supportsVertexArrayObject(){return this.OES_vertex_array_object_supported}get vertexArrayObject(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")}get supportsColorBufferFloat(){switch(this._backend){case l.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case l.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}}get colorBufferFloat(){switch(this._backend){case l.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case l.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}}get supportsCompressedTextureASTC(){return this.WEBGL_compressed_texture_astc_supported}get compressedTextureASTC(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")}get supportsCompressedTextureATC(){return this.WEBGL_compressed_texture_atc_supported}get compressedTextureATC(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")}get supportsCompressedTextureETC(){return this.WEBGL_compressed_texture_etc_supported}get compressedTextureETC(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")}get supportsCompressedTextureETC1(){return this.WEBGL_compressed_texture_etc1_supported}get compressedTextureETC1(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")}get supportsCompressedTexturePVRTC(){return this.WEBGL_compressed_texture_pvrtc_supported}get compressedTexturePVRTC(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")}get supportsCompressedTextureS3TC(){return this.WEBGL_compressed_texture_s3tc_supported}get compressedTextureS3TC(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")}get supportsCompressedTextureS3TCSRGB(){return this.WEBGL_compressed_texture_s3tc_srgb_supported}get compressedTextureS3TCSRGB(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")}get supportsDebugRendererInfo(){return this.WEBGL_debug_renderer_info_supported}get debugRendererInfo(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")}get supportsDebugShaders(){return this.WEBGL_debug_shaders_supported}get debugShaders(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")}get supportsDepthTexture(){return this.WEBGL_depth_texture_supported}get depthTexture(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")}get supportsDrawBuffers(){return this.WEBGL_draw_buffers_supported}get drawBuffers(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")}get supportsLoseContext(){return this.WEBGL_lose_context_supported}get loseContext(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")}get supportsBlitFramebuffer(){return void 0!==this._context.blitFramebuffer}get supportsReadBuffer(){return void 0!==this._context.readBuffer}get supportsTexImage3D(){return void 0!==this._context.texImage3D}param(e){return i.assert(!!this._context,"expected context to be valid"),this._context.getParameter(e)}hash(){return c.ExtensionsHash.encode(this._backend,this._extensions)}about(){const e="ok",t="na";if(this._backend===l.BackendType.Invalid)return new Array;i.assert(!!this._context,"expected context to be valid");const r=this._context,n=new Array;n.push(["BACKEND (GLOPERATE)",this.backend]),n.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),n.push(["RENDERER",this.param(r.RENDERER)]),n.push(["VENDOR",this.param(r.VENDOR)]),n.push(["VERSION",this.param(r.VERSION)]),n.push(["SHADING_LANGUAGE_VERSION",this.param(r.SHADING_LANGUAGE_VERSION)]),n.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):t]),n.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this.param(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):t]),n.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),n.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),n.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),n.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),n.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),n.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),n.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),n.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),n.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),n.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),n.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),n.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),n.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),n.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),n.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),n.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this.param(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),n.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this.param(r.MAX_CUBE_MAP_TEXTURE_SIZE)]),n.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this.param(r.MAX_FRAGMENT_UNIFORM_VECTORS)]),n.push(["MAX_RENDERBUFFER_SIZE",this.param(r.MAX_RENDERBUFFER_SIZE)]),n.push(["MAX_TEXTURE_IMAGE_UNITS",this.param(r.MAX_TEXTURE_IMAGE_UNITS)]),n.push(["MAX_TEXTURE_SIZE",this.param(r.MAX_TEXTURE_SIZE)]),n.push(["MAX_VARYING_VECTORS",this.param(r.MAX_VARYING_VECTORS)]),n.push(["MAX_VERTEX_ATTRIBS",this.param(r.MAX_VERTEX_ATTRIBS)]),n.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this.param(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),n.push(["MAX_VERTEX_UNIFORM_VECTORS",this.param(r.MAX_VERTEX_UNIFORM_VECTORS)]);const s=this.param(r.MAX_VIEWPORT_DIMS);if(n.push(["MAX_VIEWPORT_DIMS (WIDTH)",s?s[0]:null]),n.push(["MAX_VIEWPORT_DIMS (HEIGHT)",s?s[1]:null]),this.isWebGL2){const e=this._context;n.push(["MAX_3D_TEXTURE_SIZE",this.param(e.MAX_3D_TEXTURE_SIZE)]),n.push(["MAX_ARRAY_TEXTURE_LAYERS",this.param(e.MAX_ARRAY_TEXTURE_LAYERS)]),n.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this.param(e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),n.push(["MAX_COLOR_ATTACHMENTS",this.param(e.MAX_COLOR_ATTACHMENTS)]),n.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this.param(e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),n.push(["MAX_COMBINED_UNIFORM_BLOCKS",this.param(e.MAX_COMBINED_UNIFORM_BLOCKS)]),n.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this.param(e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),n.push(["MAX_DRAW_BUFFERS",this.param(e.MAX_DRAW_BUFFERS)]),n.push(["MAX_ELEMENT_INDEX",this.param(e.MAX_ELEMENT_INDEX)]),n.push(["MAX_ELEMENTS_INDICES",this.param(e.MAX_ELEMENTS_INDICES)]),n.push(["MAX_ELEMENTS_VERTICES",this.param(e.MAX_ELEMENTS_VERTICES)]),n.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this.param(e.MAX_FRAGMENT_INPUT_COMPONENTS)]),n.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this.param(e.MAX_FRAGMENT_UNIFORM_BLOCKS)]),n.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this.param(e.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),n.push(["MAX_PROGRAM_TEXEL_OFFSET",this.param(e.MAX_PROGRAM_TEXEL_OFFSET)]),n.push(["MAX_SAMPLES",this.param(e.MAX_SAMPLES)]),n.push(["MAX_SERVER_WAIT_TIMEOUT",this.param(e.MAX_SERVER_WAIT_TIMEOUT)]),n.push(["MAX_TEXTURE_LOD_BIAS",this.param(e.MAX_TEXTURE_LOD_BIAS)]),n.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this.param(e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),n.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this.param(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),n.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this.param(e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),n.push(["MAX_UNIFORM_BLOCK_SIZE",this.param(e.MAX_UNIFORM_BLOCK_SIZE)]),n.push(["MAX_UNIFORM_BUFFER_BINDINGS",this.param(e.MAX_UNIFORM_BUFFER_BINDINGS)]),n.push(["MAX_VARYING_COMPONENTS",this.param(e.MAX_VARYING_COMPONENTS)]),n.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this.param(e.MAX_VERTEX_OUTPUT_COMPONENTS)]),n.push(["MAX_VERTEX_UNIFORM_BLOCKS",this.param(e.MAX_VERTEX_UNIFORM_BLOCKS)]),n.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this.param(e.MAX_VERTEX_UNIFORM_COMPONENTS)]),n.push(["MIN_PROGRAM_TEXEL_OFFSET",this.param(e.MIN_PROGRAM_TEXEL_OFFSET)])}if(this.isWebGL1)for(const r of o.WEBGL1_EXTENSIONS)n.push([r,this.supports(r)?e:t]);else if(this.isWebGL2){for(const t of o.WEBGL2_DEFAULT_EXTENSIONS)n.push([`${t} (default)`,e]);for(const r of o.WEBGL2_EXTENSIONS)n.push([r,this.supports(r)?e:t])}return n}aboutString(){const e=this.about();let t=0;for(const r of e)t=Math.max(r[0].length,t);let r=0,i="";const n=this.isWebGL2?63+o.WEBGL2_DEFAULT_EXTENSIONS.length:-1;for(const s of e){switch(r){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case n:i+="\n"}i+=`  ${s[0]} ${"-".repeat(t-s[0].length)}-- ${s[1]}\n`,++r}return i+="\n",i}logAbout(e=i.LogLevel.Info){i.log(e,"context.about\n\n"+this.aboutString())}logAboutIf(e,t=i.LogLevel.Info){i.logIf(e,t,"context.about\n\n"+this.aboutString())}byteSizeOfFormat(e){return n.byteSizeOfFormat(this,e)}}t.Context=l,l.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},function(e){let t,r;!function(e){e.Invalid="invalid",e.WebGL1="webgl1",e.WebGL2="webgl2"}(t=e.BackendType||(e.BackendType={})),function(e){e.auto="auto",e.webgl="webgl",e.experimental="experimental-webgl",e.webgl1="webgl1",e.experimental1="experimental-webgl1",e.webgl2="webgl2",e.experimental2="experimental-webgl2"}(r=e.BackendRequestType||(e.BackendRequestType={}))}(l=t.Context||(t.Context={}))},1985:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMasquerade=void 0;const i=r(9696),n=r(9568);class s{constructor(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}static fromHash(e){const t=new s,r=n.ExtensionsHash.decode(e);return t._backend=r[0],t._extensionsStrive=r[1],t._extensionsConceal=n.ExtensionsHash.complement(t._backend,t._extensionsStrive),t}static fromPreset(e){const t=new s,r=new Array;let a;for(const t of s.presets())if(r.push(t.identifier),t.identifier===e){a=t;break}if(void 0===a&&i.assert(!1,`expected valid identifier, available ['${r.join("', '")}'], given '${e}'`),void 0!==a.extensions_hash){const e=n.ExtensionsHash.decode(a.extensions_hash);t._backend=e[0],t._extensionsStrive=e[1]}else t._backend=a.backend;return i.assert(void 0!==t._backend,"expected backend to be included in preset"),void 0===a.extensions_strive?(t._extensionsStrive=[],t._extensionsConceal=a.extensions_conceal?a.extensions_conceal:[]):(t._extensionsStrive=a.extensions_strive,t._extensionsConceal=n.ExtensionsHash.complement(t._backend,a.extensions_strive)),t._functionsUndefine=a.functions_undefine?a.functions_undefine:[],t}static fromGET(){const e=i.GETparameter("msqrd_h");if(void 0!==e)return s.fromHash(e);const t=i.GETparameter("msqrd_p");return void 0!==t?s.fromPreset(t):void 0}static presets(){return this.MASQUERADE_JSON}get backend(){return this._backend}get extensionsStrive(){return this._extensionsStrive}get extensionsConceal(){return this._extensionsConceal}get functionsUndefine(){return this._functionsUndefine}}t.ContextMasquerade=s,s.MASQUERADE_JSON=r(6799)},3863:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Controller=void 0;const i=r(9130),n=r(9696),s=r(2111);class a{constructor(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new i.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new i.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new i.ReplaySubject(1),this._multiFrameDelay=0,this._postFrameEventSubject=new i.Subject,this._postSwapEventSubject=new i.Subject,this._animationFrameID=0,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0],this._invalidated=!1,this._force=!1}set debug(e){e&&n.logVerbosity()<n.LogLevel.Debug&&(n.logVerbosity(n.LogLevel.Debug),n.log(n.LogLevel.Debug,`changed log verbosity to ${n.LogLevel.Debug} (debug)`)),a._debug=e}set batch(e){n.log(n.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,e)}request(e=a.RequestType.Frame){this._animationFrameID=0,this._block?this._blockedUpdates++:this._animationFrameID=window.requestAnimationFrame((()=>this.invoke(e)))}invoke(e){if(0!==this._animationFrameID){if(n.assert(void 0!==this._controllable,"frame sequence invoked without controllable set"),this._invalidated&&(this._invalidated=!1,(this.invokeUpdate()||this._force)&&(this._force=!1,this._frameNumber=0,this.cancelWaitMultiFrame(),this.invokePrepare())),e===a.RequestType.Frame&&1===this._frameNumber)return void 0===this._timeoutID&&this.startWaitMultiFrame(),void(this._animationFrameID=0);this.isMultiFrameFinished()?this._animationFrameID=0:(this.invokeFrameAndSwap(),this.request())}}invokeUpdate(){return n.logIf(a._debug,n.LogLevel.Debug,`c invoke update     | pending: '${this._animationFrameID}', mfnum: ${this._multiFrameNumber}`),this._controllable.update(this._multiFrameNumber)}invokePrepare(){n.logIf(a._debug,n.LogLevel.Debug,"c invoke prepare    |"),this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();const e=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=e,this._updateFrameTime=e}invokeFrameAndSwap(){n.logIf(a._debug,n.LogLevel.Debug,`c invoke frame      | pending: '${this._animationFrameID}'`);const e=this._debugFrameNumber>0;n.assert(!e||this._frameNumber<this._debugFrameNumber,"frame number about to exceed debug-frame number");const t=performance.now();let r=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(r=Math.min(r,this._debugFrameNumber));this._frameNumber<r;++this._frameNumber)n.logIf(a._debug,n.LogLevel.Debug,`c -> frame          | frame: ${this._frameNumber}`),this._controllable.frame(this._frameNumber),this._postFrameEventSubject.next(this._frameNumber),++this._intermediateFrameCount;n.logIf(a._debug,n.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._postSwapEventSubject.next(this._frameNumber),this._multiTime[1]=performance.now();const i=this._multiTime[1]-t;this._multiFrameTime+=i,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],i),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],i),this.frameNumberNext()}startWaitMultiFrame(){this._timeoutID=window.setTimeout((()=>{this.request(a.RequestType.MultiFrame),this._timeoutID=void 0}),this._multiFrameDelay)}cancelWaitMultiFrame(){void 0!==this._timeoutID&&(window.clearTimeout(this._timeoutID),this._timeoutID=void 0)}isMultiFrameFinished(){return this._debugFrameNumber>0?this._frameNumber===this._debugFrameNumber:this._frameNumber===this._multiFrameNumber}multiFrameNumberNext(){this._multiFrameNumberSubject.next(this._multiFrameNumber)}debugFrameNumberNext(){this._debugFrameNumberSubject.next(this._debugFrameNumber)}frameNumberNext(){this._frameNumberSubject.next(this._frameNumber)}update(e=!1){this._invalidated=!0,this._force=this._force||e,0===this._animationFrameID&&this.request()}block(){n.logIf(a._debug,n.LogLevel.Debug,`c block   ${this._block?"(ignored) ":"          "}|`),this._block=!0}unblock(){n.logIf(a._debug,n.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+`| blocked: #${this._blockedUpdates}`),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))}cancel(){0!==this._animationFrameID&&(window.cancelAnimationFrame(this._animationFrameID),this._animationFrameID=0)}get blocked(){return this._block}set controllable(e){e!==this._controllable&&(this._controllable=e,this.update(!0))}get multiFrameNumber(){return this._multiFrameNumber}set multiFrameNumber(e){const t=Math.max(1,isNaN(e)?1:e);t!==this._multiFrameNumber&&(this._multiFrameNumber=t,this.multiFrameNumberNext(),n.logIf(t!==e,n.LogLevel.Debug,`multi-frame number adjusted to ${t}, given ${e}`),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())}get multiFrameNumber$(){return this._multiFrameNumberSubject.asObservable()}get debugFrameNumber(){return this._debugFrameNumber}set debugFrameNumber(e){const t=s.clamp(isNaN(e)?0:e,0,this.multiFrameNumber);t!==this._debugFrameNumber&&(this._debugFrameNumber=t,this.debugFrameNumberNext(),n.logIf(t!==e,n.LogLevel.Debug,`debug-frame number adjusted to ${t}, given ${e}`),this.update(this.debugFrameNumber<this._frameNumber))}get debugFrameNumber$(){return this._debugFrameNumberSubject.asObservable()}set multiFrameDelay(e){const t=Math.max(0,e);t!==this._multiFrameDelay&&(this._multiFrameDelay=t)}get multiFrameDelay(){return this._multiFrameDelay}get frameNumber(){return this._frameNumber}get frameNumber$(){return this._frameNumberSubject.asObservable()}get intermediateFrameCount(){return this._intermediateFrameCount}get multiFrameCount(){return this._multiFrameCount}get averageFrameTime(){return 0===this._frameNumber?0:this._multiFrameTime/this._frameNumber}get updateFrameTime(){return this._updateFrameTime}get minimumFrameTime(){return this._intermediateFrameTimes[0]}get maximumFrameTime(){return this._intermediateFrameTimes[1]}get multiFrameTime(){return 0===this._frameNumber?0:this._multiTime[1]-this._multiTime[0]}get framesPerSecond(){return 0===this._frameNumber?0:1e3/(this.multiFrameTime/this._frameNumber)}get postFrameEvent$(){return this._postFrameEventSubject.asObservable()}get postSwapEvent$(){return this._postSwapEventSubject.asObservable()}}t.Controller=a,a._debug=!1,function(e){let t;!function(e){e[e.Frame=0]="Frame",e[e.MultiFrame=1]="MultiFrame"}(t=e.RequestType||(e.RequestType={}))}(a=t.Controller||(t.Controller={}))},2380:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CuboidGeometry=void 0;const i=r(3659),n=r(6404),s=r(4894);class a extends s.Geometry{constructor(e,t,r=!1,s=[1,1,1]){super(e,t),this._vertexLocation=0,this._extent=i.vec3.fromValues(1,1,1),this._uvCoordinates=!1,t=void 0!==t&&""!==t?t:this.constructor.name;const a=new n.Buffer(e,t+"VBO");this._buffers.push(a);const o=new n.Buffer(e,`${t}IndicesVBO`);this._buffers.push(o),this._extent=i.vec3.clone(s),this._uvCoordinates=r}bindBuffers(){!1===this._uvCoordinates?this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1):(this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,20,0,!0,!1),this._buffers[0].attribEnable(this._uvCoordLocation,2,this.context.gl.FLOAT,!1,20,12,!1,!1)),this._buffers[1].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._uvCoordinates&&this._buffers[0].attribDisable(this._uvCoordLocation,!1,!0),this._buffers[1].unbind()}initialize(e=0,t=1){this._vertexLocation=e,this._uvCoordLocation=t;const r=this.context.gl,i=super.initialize([r.ARRAY_BUFFER,r.ELEMENT_ARRAY_BUFFER],[e,t]),n=this._uvCoordinates;let s=n?a.VERTICES_UV:a.VERTICES;return s=s.map(((e,t)=>e*(!1===n?.5*this._extent[t%3]:t%5<3?.5*this._extent[t%5]:1))),this._buffers[0].data(s,r.STATIC_DRAW),this._buffers[1].data(n?a.INDICES_UV:a.INDICES,r.STATIC_DRAW),this._count=n?a.INDICES_UV.length:a.INDICES.length,i}draw(){const e=this.context.gl;e.drawElements(e.TRIANGLE_STRIP,this._count,e.UNSIGNED_BYTE,0)}get vertexLocation(){return this._vertexLocation}get uvCoordLocation(){return this._uvCoordLocation}get extent(){return this._extent}get count(){return this._count}}t.CuboidGeometry=a,a.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),a.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),a.VERTICES_UV=new Float32Array([-1,-1,1,0,0,1,-1,1,1,0,-1,1,1,0,1,1,1,1,1,1,-1,1,1,0,0,1,1,1,1,0,1,1,-1,1,1,1,1,1,0,1,1,-1,1,0,0,1,-1,-1,1,0,1,-1,1,1,1,-1,-1,-1,0,0,1,-1,-1,0,0,-1,-1,-1,1,0,1,1,-1,0,1,-1,1,-1,1,1,-1,1,-1,0,1,-1,1,1,1,1,-1,-1,1,1,0,-1,-1,1,0,1]),a.INDICES_UV=new Uint8Array([3,2,1,0,10,19,11,18,11,17,16,4,16,5,6,7,6,8,9,10,9,11,12,13,14,15])},7922:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeosphereGeometry=void 0;const i=r(9696),n=r(6404),s=r(4894),a=r(7498);class o extends s.Geometry{constructor(e,t,r=1,i=!0){super(e,t),this._diameter=1,this._textured=!1,this._size=0,t=void 0!==t&&""!==t?t:this.constructor.name,this._diameter=r,this._textured=i;const s=new n.Buffer(e,t+"IndexBuffer");this._buffers.push(s);const a=new n.Buffer(e,t+"VBO");if(this._buffers.push(a),this._textured){const r=new n.Buffer(e,t+"UV");this._buffers.push(r)}}bindBuffers(){this._buffers[0].bind(),this._buffers[1].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._textured&&this._buffers[2].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].unbind(),this._buffers[1].attribDisable(this._vertexLocation,!0,!0),this._textured&&this._buffers[2].attribDisable(this._texCoordLocation,!0,!0)}initialize(e=0,t=1){const r=this.context.gl;this._vertexLocation=e,this._texCoordLocation=t;const n=super.initialize([r.ELEMENT_ARRAY_BUFFER,r.ARRAY_BUFFER,r.ARRAY_BUFFER],[8,e,t]);i.assert(void 0!==this._buffers[0]&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),i.assert(void 0!==this._buffers[1]&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._textured&&i.assert(void 0!==this._buffers[2]&&this._buffers[2].object instanceof WebGLBuffer,"expected valid WebGLBuffer");const s=new a.Icosahedron;s.generateGeometry(3),this._textured&&s.generateTextureCoordinates();const o=s.faces,c=new Uint16Array(3*o.length);let h=0;for(const e of o)c[h+0]=e[0],c[h+1]=e[1],c[h+2]=e[2],h+=3;this._buffers[0].data(c,r.STATIC_DRAW),this._size=3*o.length;const l=s.vertices,u=new Float32Array(3*l.length);h=0;for(const e of l)u[h+0]=e[0]*this._diameter,u[h+1]=e[1]*this._diameter,u[h+2]=e[2]*this._diameter,h+=3;if(this._buffers[1].data(u,r.STATIC_DRAW),this._textured){const e=s.texcoords,t=new Float32Array(2*e.length);if(e&&e.length>0){h=0;for(const r of e)t[h+0]=r[0],t[h+1]=r[1],h+=2}this._buffers[2].data(t,r.STATIC_DRAW)}return n}draw(){const e=this.context.gl;e.drawElements(e.TRIANGLES,this._size,e.UNSIGNED_SHORT,0)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.GeosphereGeometry=o},7498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Icosahedron=void 0;const i=r(3659),n=r(2111);t.Icosahedron=class{constructor(){}baseVertices(){const e=.5*(1+Math.sqrt(5)),t=1/Math.sqrt(e*e+1),r=e*t;return[i.vec3.fromValues(-t,+r,0),i.vec3.fromValues(+t,+r,0),i.vec3.fromValues(-t,-r,0),i.vec3.fromValues(+t,-r,0),i.vec3.fromValues(0,-t,+r),i.vec3.fromValues(0,+t,+r),i.vec3.fromValues(0,-t,-r),i.vec3.fromValues(0,+t,-r),i.vec3.fromValues(+r,0,-t),i.vec3.fromValues(+r,0,+t),i.vec3.fromValues(-r,0,-t),i.vec3.fromValues(-r,0,+t)]}baseFaces(){return[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]]}refine(e,t,r){const i=new Map;for(let n=0;n<r;n++){const r=t.length;for(let n=0;n<r;n++){const r=t[n],s=r[0],a=r[1],o=r[2],c=this.split(s,a,e,i),h=this.split(a,o,e,i),l=this.split(o,s,e,i);t[n]=[c,h,l],t.push([s,c,l]),t.push([a,h,c]),t.push([o,l,h])}}}split(e,t,r,s){const a=e<t,o=((a?e:t)<<16)+(a?t:e);if(s.has(o))return s.get(o);const c=i.vec3.add(n.v3(),r[e],r[t]);i.vec3.normalize(c,c),r.push(c);const h=r.length-1;return s.set(o,h),h}generateGeometry(e){this._vertices=this.baseVertices(),this._faces=this.baseFaces(),e>0&&this.refine(this._vertices,this._faces,Math.min(Math.max(e,0),8))}generateTextureCoordinates(){this._texcoords=new Array;for(const e of this._vertices){const t=i.vec3.normalize(n.v3(),e),r=i.vec2.fromValues(.5-Math.atan2(t[2],t[0])/(2*Math.PI),Math.asin(t[1])/Math.PI+.5);this._texcoords.push(r)}}get faces(){return this._faces}get vertices(){return this._vertices}get texcoords(){return this._texcoords}}},2194:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=t.PlaneGeometry=t.GeosphereGeometry=t.Icosahedron=t.CuboidGeometry=void 0;var i=r(2380);Object.defineProperty(t,"CuboidGeometry",{enumerable:!0,get:function(){return i.CuboidGeometry}});var n=r(7498);Object.defineProperty(t,"Icosahedron",{enumerable:!0,get:function(){return n.Icosahedron}});var s=r(7922);Object.defineProperty(t,"GeosphereGeometry",{enumerable:!0,get:function(){return s.GeosphereGeometry}});var a=r(4574);Object.defineProperty(t,"PlaneGeometry",{enumerable:!0,get:function(){return a.PlaneGeometry}});var o=r(9045);Object.defineProperty(t,"ResourceManager",{enumerable:!0,get:function(){return o.ResourceManager}})},4574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlaneGeometry=void 0;const i=r(3659),n=r(6404),s=r(4894);class a extends s.Geometry{constructor(e,t){super(e,t),this._vertexLocation=0,this._texCoordLocation=1,this._translation=i.vec3.fromValues(0,0,0),this._scale=i.vec3.fromValues(1,1,1),this._rotation=i.quat.create(),t=void 0!==t&&""!==t?t:this.constructor.name;const r=new n.Buffer(e,t+"VertexVBO"),s=new n.Buffer(e,t+"TexCoordVBO"),a=new n.Buffer(e,t+"IndexBuffer");this._buffers.push(r),this._buffers.push(s),this._buffers.push(a)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].attribEnable(this._texCoordLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[2].bind()}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0),this._buffers[1].attribDisable(this._texCoordLocation,!0,!0),this._buffers[2].unbind()}initialize(e=0,t=1){const r=this.context.gl;this._vertexLocation=e,this._texCoordLocation=t;const i=super.initialize([r.ARRAY_BUFFER,r.ARRAY_BUFFER,r.ELEMENT_ARRAY_BUFFER],[e,t,8]);return this._buffers[0].data(a.VERTICES,r.STATIC_DRAW),this._buffers[1].data(a.UV,r.STATIC_DRAW),this._buffers[2].data(a.INDICES,r.STATIC_DRAW),i}draw(){const e=this.context.gl;e.drawElements(e.TRIANGLE_STRIP,a.INDICES.length,e.UNSIGNED_BYTE,0)}set translation(e){this._translation=e}set scale(e){this._scale=i.vec3.fromValues(e[0],1,e[1])}set rotation(e){this._rotation=e}get transformation(){const e=i.mat4.create();return i.mat4.fromRotationTranslationScale(e,this._rotation,this._translation,this._scale)}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}}t.PlaneGeometry=a,a.VERTICES=new Float32Array([-1,0,-1,-1,0,1,1,0,-1,1,0,1]),a.UV=new Float32Array([-1,-1,-1,1,1,-1,1,1]),a.INDICES=new Uint8Array([0,1,2,3])},9045:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceManager=void 0;const i=r(9696),n=r(6404),s=r(4894),a=r(9922),o=r(6942);t.ResourceManager=class{constructor(e){this._texture2Ds=new Map,this._materials=new Map,this._geometries=new Map,this._buffers=new Map,this._context=e}fetchTexture2D(e,t,r=!1){if(this._texture2Ds.has(e))return;const n=new o.Texture2D(this._context,e);return i.assert(n.identifier===e,"expected object identifier to be unchanged"),this._texture2Ds.set(e,n),n.fetch(t,r)}add(e,t){const r=new Array;if(e instanceof o.Texture2D){const i=e;for(const e of t)this._texture2Ds.has(e)||(this._texture2Ds.set(e,i),r.push(e))}if(e instanceof a.Material){const i=e;for(const e of t)this._materials.has(e)||(this._materials.set(e,i),r.push(e))}if(e instanceof s.Geometry){const i=e;for(const e of t)this._geometries.has(e)||(this._geometries.set(e,i),r.push(e))}if(e instanceof n.Buffer){const i=e;for(const e of t)this._buffers.has(e)||(this._buffers.set(e,i),r.push(e))}return r}get(e){return this._texture2Ds.has(e)?this._texture2Ds.get(e):this._materials.has(e)?this._materials.get(e):this._geometries.has(e)?this._geometries.get(e):this._buffers.has(e)?this._buffers.get(e):void 0}uninitialize(){for(const e of Array.from(this._geometries.values()))e.initialized&&e.uninitialize();this._geometries.clear();for(const e of Array.from(this._texture2Ds.values()))e.initialized&&e.uninitialize();this._texture2Ds.clear();for(const e of Array.from(this._buffers.values()))e.initialized&&e.uninitialize();this._buffers.clear(),this._materials.clear()}}},7491:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const a=s(r(1604)),o=s(r(493));var c;(c=t.debug||(t.debug={})).TestRenderer=o.TestRenderer,c.TestNavigation=a.TestNavigation},1604:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestNavigation=void 0;const i=r(7595);t.TestNavigation=class{constructor(e,t){this._altered=!1,this._eventHandler=new i.EventHandler(e,t),this._eventHandler.pushMouseEnterHandler(((e,t)=>this.onMouseEnter(e,t))),this._eventHandler.pushMouseLeaveHandler(((e,t)=>this.onMouseLeave(e,t)))}onMouseEnter(e,t){this._altered=!1}onMouseLeave(e,t){this._altered=!0}update(){this._eventHandler.update()}reset(){this._altered=!1}get altered(){return this._altered}}},493:(e,t,r)=>{"use strict";const i=r(9696),n=r(3666),s=r(3411),a=r(4073),o=r(6786),c=r(9564),h=r(7570),l=r(4895),u=r(7540),d=r(3205),_=r(5263),f=r(6942),p=r(1604);var m;!function(e){class t extends d.Renderer{constructor(){super(...arguments),this._extensions=!1}onInitialize(e,t,d){const m=this._context.gl,v=this._context.gl2facade;!1===this._extensions&&this._context.isWebGL1&&(i.assert(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);const g=new _.Shader(this._context,m.VERTEX_SHADER,"testrenderer.vert");g.initialize(r(354));const b=new _.Shader(this._context,m.FRAGMENT_SHADER,"testrenderer.frag");b.initialize(r(9587)),this._program=new l.Program(this._context),this._program.initialize([g,b]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new h.NdcFillingTriangle(this._context);const E=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(E),this._ndcOffsetKernel=new s.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new o.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new f.Texture2D(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new u.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new c.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new n.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new a.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=v.COLOR_ATTACHMENT0,this._blit.drawBuffer=m.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new p.TestNavigation((()=>this.invalidate()),d),!0}onUninitialize(){super.uninitialize(),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._accumulate.uninitialize()}onDiscarded(){this._altered.alter("frameSize"),this._altered.alter("multiFrameNumber"),this._altered.alter("framePrecision"),this._altered.alter("clearColor")}onUpdate(){this._testNavigation.update();const e=this._testNavigation.altered;return this._testNavigation.reset(),!(!e&&!this._altered.any)&&e}onPrepare(){const e=this._context.gl,t=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?e.RGBA8:e.RGBA,e.RGBA,e.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],e.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[t.COLOR_ATTACHMENT0,this._colorRenderTexture],[e.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()}onFrame(e){const t=this._context.gl;t.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();const r=this._ndcOffsetKernel.get(e);r[0]=2*r[0]/this._frameSize[0],r[1]=2*r[1]/this._frameSize[1],t.uniform2fv(this._uNdcOffset,r),t.uniform1i(this._uFrameNumber,e),this._intermediateFBO.clear(t.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(e)}onSwap(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()}}e.TestRenderer=t}(m||(m={})),e.exports=m},26:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugPass=void 0;const i=r(9696),n=r(4895),s=r(5263),a=r(4073);class o extends a.BlitPass{constructor(){super(...arguments),this._debug=o.Mode.Depth,this._near=0,this._far=0}createProgram(){i.assert(void 0===this._program,"expected blit program to be undefined before its creation");const e=this._context.gl,t=new s.Shader(this._context,e.VERTEX_SHADER,"blit.vert (debug)");t.initialize(r(985));const a=new s.Shader(this._context,e.FRAGMENT_SHADER,"blit_debug.frag (debug)");return a.initialize(r(8356)),this._program=new n.Program(this._context,"DebugProgram"),this._program.initialize([t,a]),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uSrcBounds=this._program.uniform("u_srcBounds"),this._uDstBounds=this._program.uniform("u_dstBounds"),this._uNearest=this._program.uniform("u_nearest"),this._uDebugMode=this._program.uniform("u_mode"),this._uLinearize=this._program.uniform("u_linearize"),this._program.bind(),e.uniform1i(this._program.uniform("u_source"),0),e.uniform1i(this._uDebugMode,this._debug),this._program.unbind(),this._program.valid}initialize(e){const t=super.initialize(e);return this.enforceProgramBlit=!0,t&&this.createProgram()}uninitialize(){super.uninitialize(),this._uDebugMode=void 0,this._uLinearize=void 0}set debug(e){this.assertInitialized(),this._debug!==e&&(this._debug=e,void 0!==this._program&&this._program.valid&&(this._program.bind(),this._context.gl.uniform1i(this._uDebugMode,this._debug),this._program.unbind()))}set near(e){this._near=e||0,void 0!==this._program&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}set far(e){this._far=e||0,void 0!==this._program&&this._program.valid&&(this._program.bind(),this._context.gl.uniform2f(this._uLinearize,this._near,this._far),this._program.unbind())}}t.DebugPass=o,function(e){let t;!function(e){e[e.None=0]="None",e[e.Depth=1]="Depth",e[e.DepthLinear=2]="DepthLinear",e[e.DepthPacked=3]="DepthPacked",e[e.DepthLinearPacked=4]="DepthLinearPacked"}(t=e.Mode||(e.Mode={}))}(o=t.DebugPass||(t.DebugPass={}))},6786:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultFramebuffer=void 0;const n=r(9696),s=r(9564),a=r(1030);class o extends s.Framebuffer{create(){return this._object=s.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object}delete(){this._object=void 0,this._valid=!1}hasAttachment(e){return!1}bind(e=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(e,this._object)}clearColor(e){super.clearColor(e)}resize(){n.assert(!1,"the default framebuffer cannot be resized directly")}get width(){return this.context.gl.canvas.width}get height(){return this.context.gl.canvas.height}}i([a.Initializable.assert_initialized()],o.prototype,"bind",null),t.DefaultFramebuffer=o},172:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentTextureType=t.EnvironmentRenderingPass=void 0;const n=r(9696),s=r(1030),a=r(7570),o=r(4895),c=r(5263),h=r(6942),l=r(945);class u extends s.Initializable{constructor(e){super(),this._skipCubeLod=!1,this._altered=!0,this._context=e,this._cubeMapProgram=new o.Program(e,"CubemapEnvironmentProgram"),this._equiMapProgram=new o.Program(e,"EquimapEnvironmentProgram"),this._polarMapProgram=new o.Program(e,"PolarmapEnvironmentProgram"),this._sphereMapProgram=new o.Program(e,"SpheremapEnvironmentProgram"),this._ndcTriangle=new a.NdcFillingTriangle(this._context,"EnvironmentNdcTriangle")}initialize(){const e=this._context.gl;this._ndcTriangle.initialize();const t=new c.Shader(this._context,e.VERTEX_SHADER,"env-projections.vert");t.initialize(r(8170));const i=new c.Shader(this._context,e.FRAGMENT_SHADER,"env-projections.frag");i.initialize(r(4965),!1),i.replace("PROJECTION_TYPE","CUBE_MAP"),i.compile(),this._cubeMapProgram.initialize([t,i],!1),this._cubeMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._cubeMapProgram.link(),this._cubeMapProgram.bind(),e.uniform1i(this._cubeMapProgram.uniform("u_cubemap"),0),this._uSkipLod=this._cubeMapProgram.uniform("u_skipLod"),this._cubeMapProgram.unbind();const n=new c.Shader(this._context,e.FRAGMENT_SHADER,"env-projections.frag");n.initialize(r(4965),!1),n.replace("PROJECTION_TYPE","EQUI_MAP"),n.compile(),this._equiMapProgram.initialize([t,n],!1),this._equiMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._equiMapProgram.link(),this._equiMapProgram.bind(),e.uniform1i(this._equiMapProgram.uniform("u_equirectmap"),0),this._equiMapProgram.unbind();const s=new c.Shader(this._context,e.FRAGMENT_SHADER,"env-projections.frag");s.initialize(r(4965),!1),s.replace("PROJECTION_TYPE","SPHERE_MAP"),s.compile(),this._sphereMapProgram.initialize([t,s],!1),this._sphereMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._sphereMapProgram.link(),this._sphereMapProgram.bind(),e.uniform1i(this._sphereMapProgram.uniform("u_spheremap"),0),this._sphereMapProgram.unbind();const a=new c.Shader(this._context,e.FRAGMENT_SHADER,"env-projections.frag");return a.initialize(r(4965),!1),a.replace("PROJECTION_TYPE","POLAR_MAP"),a.compile(),this._polarMapProgram.initialize([t,a],!1),this._polarMapProgram.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._polarMapProgram.link(),this._polarMapProgram.bind(),e.uniform1iv(this._polarMapProgram.uniform("u_polarmap"),[0,1]),this._polarMapProgram.unbind(),!0}uninitialize(){this._cubeMapProgram.uninitialize(),this._equiMapProgram.uninitialize(),this._sphereMapProgram.uninitialize(),this._polarMapProgram.uninitialize()}update(){if(!1===this._altered)return;const e=this._context.gl;this._cubeMapProgram.bind(),e.uniform1i(this._uSkipLod,this._skipCubeLod),this._altered=!1}frame(){const e=this._context.gl;n.assert(void 0!==this._camera,"Camera is undefined in environment rendering pass."),n.assert(void 0!==this._environmentTexture,"Environment texture is undefined in environment rendering pass.");let t=this._cubeMapProgram;this._envTextureType===d.EquirectangularMap?(n.assert(this._environmentTexture instanceof h.Texture2D,"Input texture expected to be Texture2D for equirectangular mapping."),this._environmentTexture.bind(e.TEXTURE0),t=this._equiMapProgram):this._envTextureType===d.SphereMap?(n.assert(this._environmentTexture instanceof h.Texture2D,"Input texture expected to be Texture2D for sphere mapping."),this._environmentTexture.bind(e.TEXTURE0),t=this._sphereMapProgram):this._envTextureType===d.CubeMap?(n.assert(this._environmentTexture instanceof l.TextureCube,"Input texture expected to be a TextureCube for cube mapping."),this._environmentTexture.bind(e.TEXTURE0),t=this._cubeMapProgram):this._envTextureType===d.PolarMap&&(n.assert(void 0!==this._environmentTexture2,"Two input textures expected for polar mapping."),n.assert(this._environmentTexture instanceof h.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),n.assert(this._environmentTexture2 instanceof h.Texture2D,"Input texture expected to be a Texture2D for polar mapping."),this._environmentTexture.bind(e.TEXTURE0),this._environmentTexture2.bind(e.TEXTURE1),t=this._polarMapProgram),t.bind(),e.uniformMatrix4fv(t.uniform("u_viewProjectionInverse"),!1,this._camera.viewProjectionInverse),this._ndcTriangle.bind(),this._ndcTriangle.draw(),t.unbind()}set environmentTextureType(e){this._envTextureType=e}set environmentTexture(e){this._environmentTexture=e}set environmentTexture2(e){this._environmentTexture2=e}set camera(e){this._camera=e}set skipCubeLod(e){this._skipCubeLod!==e&&(this._skipCubeLod=e,this._altered=!0)}}var d;i([s.Initializable.initialize()],u.prototype,"initialize",null),i([s.Initializable.uninitialize()],u.prototype,"uninitialize",null),t.EnvironmentRenderingPass=u,function(e){e[e.CubeMap=0]="CubeMap",e[e.EquirectangularMap=1]="EquirectangularMap",e[e.SphereMap=2]="SphereMap",e[e.PolarMap=3]="PolarMap"}(d=t.EnvironmentTextureType||(t.EnvironmentTextureType={}))},7595:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventHandler=void 0;const i=r(3659),n=r(9696),s=r(5838),a=r(4841),o=r(8319),c=r(4052),h=r(3668);t.EventHandler=class{constructor(e,t){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._latestPointerEventsByType=new Map,this._previousPointerEventsByType=new Map,this._pointerEventHandlerByType=new Map,this._latestEyeGazeEventsByType=new Map,this._previousEyeGazeEventsByType=new Map,this._eyeGazeEventHandlerByType=new Map,this._latestKeyboardEventsByType=new Map,this._previousKeyboardEventsByType=new Map,this._keyboardEventHandlerByType=new Map,this._invalidate=e,this._mouseEventProvider=t.mouseEventProvider,this._mouseEventProvider.preventDefault(a.MouseEventProvider.Type.Wheel),this._pointerEventProvider=t.pointerEventProvider,this._eyeGazeEventProvider=t.eyeGazeEventProvider,this._keyboardEventProvider=t.keyboardEventProvider}invalidate(e=!1){this._invalidate&&this._invalidate(e)}pushMouseEventHandler(e,t){if(this._mouseEventHandlerByType.has(e))return void this._mouseEventHandlerByType.get(e).push(t);this._mouseEventHandlerByType.set(e,new Array),this._previousMouseEventsByType.set(e,new Array);const r=new Array;this._latestMouseEventsByType.set(e,r),n.assert(void 0!==this._mouseEventProvider,"expected valid mouse event provider");const i=this._mouseEventProvider.observable(e);a.MouseEventProvider.Type.Wheel,this._subscriptions.push(i.subscribe((e=>{r.push(e),this.invalidate()}))),this._mouseEventHandlerByType.get(e).push(t)}invokeMouseEventHandler(e){const t=this._mouseEventHandlerByType.get(e);if(void 0===t||0===t.length)return;const r=this._latestMouseEventsByType.get(e);if(0===r.length)return;const i=this._previousMouseEventsByType.get(e);t.forEach((e=>e(r,i))),Object.assign(i,r),r.length=0}pushTouchEventHandler(e,t){if(this._touchEventHandlerByType.has(e))return void this._touchEventHandlerByType.get(e).push(t);this._touchEventHandlerByType.set(e,new Array),this._previousTouchEventsByType.set(e,new Array);const r=new Array;this._latestTouchEventsByType.set(e,r),n.assert(void 0!==this._touchEventProvider,"expected valid touch event provider");const i=this._touchEventProvider.observable(e);this._subscriptions.push(i.subscribe((e=>{r.push(e),this.invalidate()}))),this._touchEventHandlerByType.get(e).push(t)}invokeTouchEventHandler(e){const t=this._touchEventHandlerByType.get(e);if(void 0===t||0===t.length)return;const r=this._latestTouchEventsByType.get(e);if(0===r.length)return;const i=this._previousTouchEventsByType.get(e);t.forEach((e=>e(r,i))),Object.assign(i,r),r.length=0}pushPointerEventHandler(e,t){if(this._pointerEventHandlerByType.has(e))return void this._pointerEventHandlerByType.get(e).push(t);this._pointerEventHandlerByType.set(e,new Array),this._previousPointerEventsByType.set(e,new Array);const r=new Array;this._latestPointerEventsByType.set(e,r),n.assert(void 0!==this._pointerEventProvider,"expected valid pointer event provider");const i=this._pointerEventProvider.observable(e);this._subscriptions.push(i.subscribe((e=>{r.push(e),this.invalidate()}))),this._pointerEventHandlerByType.get(e).push(t)}invokePointerEventHandler(e){const t=this._pointerEventHandlerByType.get(e);if(void 0===t||0===t.length)return;const r=this._latestPointerEventsByType.get(e);if(0===r.length)return;const i=this._previousPointerEventsByType.get(e);t.forEach((e=>e(r,i))),Object.assign(i,r),r.length=0}pushEyeGazeEventHandler(e,t){if(this._eyeGazeEventHandlerByType.has(e))return void this._eyeGazeEventHandlerByType.get(e).push(t);this._eyeGazeEventHandlerByType.set(e,new Array),this._previousEyeGazeEventsByType.set(e,new Array);const r=new Array;this._latestEyeGazeEventsByType.set(e,r),n.assert(void 0!==this._eyeGazeEventProvider,"expected valid eye gaze event provider");const i=this._eyeGazeEventProvider.observable(e);this._subscriptions.push(i.subscribe((e=>{r.push(e),this.invalidate()}))),this._eyeGazeEventHandlerByType.get(e).push(t)}invokeEyeGazeEventHandler(e){const t=this._eyeGazeEventHandlerByType.get(e);if(void 0===t||0===t.length)return;const r=this._latestEyeGazeEventsByType.get(e);if(0===r.length)return;const i=this._previousEyeGazeEventsByType.get(e);t.forEach((e=>e(r,i))),Object.assign(i,r),r.length=0}pushKeyboardEventHandler(e,t){if(this._keyboardEventHandlerByType.has(e))return void this._keyboardEventHandlerByType.get(e).push(t);this._keyboardEventHandlerByType.set(e,new Array),this._previousKeyboardEventsByType.set(e,new Array);const r=new Array;this._latestKeyboardEventsByType.set(e,r),n.assert(void 0!==this._keyboardEventProvider,"expected valid keyboard event provider");const i=this._keyboardEventProvider.observable(e);this._subscriptions.push(i.subscribe((e=>{r.push(e),this.invalidate()}))),this._keyboardEventHandlerByType.get(e).push(t)}invokeKeyboardEventHandler(e){const t=this._keyboardEventHandlerByType.get(e);if(void 0===t||0===t.length)return;const r=this._latestKeyboardEventsByType.get(e);if(0===r.length)return;const i=this._previousKeyboardEventsByType.get(e);t.forEach((e=>e(r,i))),Object.assign(i,r),r.length=0}dispose(){this._latestMouseEventsByType.forEach((e=>e.length=0)),this._previousMouseEventsByType.forEach((e=>e.length=0)),this._latestTouchEventsByType.forEach((e=>e.length=0)),this._previousTouchEventsByType.forEach((e=>e.length=0)),this._latestPointerEventsByType.forEach((e=>e.length=0)),this._previousPointerEventsByType.forEach((e=>e.length=0)),this._previousEyeGazeEventsByType.forEach((e=>e.length=0)),this._latestEyeGazeEventsByType.forEach((e=>e.length=0)),this._latestKeyboardEventsByType.forEach((e=>e.length=0)),this._previousKeyboardEventsByType.forEach((e=>e.length=0));for(const e of this._subscriptions)e.unsubscribe()}update(){this.invokeMouseEventHandler(a.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(a.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(a.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(a.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(a.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(a.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(a.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(c.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(c.TouchEventProvider.Type.End),this.invokeTouchEventHandler(c.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(c.TouchEventProvider.Type.Cancel),this.invokePointerEventHandler(o.PointerEventProvider.Type.Move),this.invokePointerEventHandler(o.PointerEventProvider.Type.Down),this.invokePointerEventHandler(o.PointerEventProvider.Type.Enter),this.invokePointerEventHandler(o.PointerEventProvider.Type.Up),this.invokePointerEventHandler(o.PointerEventProvider.Type.Leave),this.invokePointerEventHandler(o.PointerEventProvider.Type.Cancel),this.invokeEyeGazeEventHandler(s.EyeGazeEventProvider.Type.EyeGazeData),this.invokeEyeGazeEventHandler(s.EyeGazeEventProvider.Type.NewServerMessage),this.invokeEyeGazeEventHandler(s.EyeGazeEventProvider.Type.ConnectionStatus),this.invokeEyeGazeEventHandler(s.EyeGazeEventProvider.Type.BinaryMessageParsingError),this.invokeKeyboardEventHandler(h.KeyboardEventType.KeyDown),this.invokeKeyboardEventHandler(h.KeyboardEventType.KeyPress),this.invokeKeyboardEventHandler(h.KeyboardEventType.KeyUp)}offsets(e,t=!0){const r=new Array;let n=!1;if(e instanceof MouseEvent){const t=e;n=0!==t.offsetX&&0!==t.offsetY,r.push(n?i.vec2.fromValues(t.offsetX,t.offsetY):i.vec2.fromValues(t.clientX,t.clientY))}else if(e instanceof WheelEvent){const t=e;n=0!==t.offsetX&&0!==t.offsetY,r.push(n?i.vec2.fromValues(t.offsetX,t.offsetY):i.vec2.fromValues(t.clientX,t.clientY))}else if(e instanceof TouchEvent){const t=e;for(let e=0;e<t.touches.length;++e){const n=t.touches.item(e);r.push(i.vec2.fromValues(n.clientX,n.clientY))}}if(n){if(t)for(const e of r)i.vec2.scale(e,e,window.devicePixelRatio);return r}const s=(e.target||e.currentTarget||e.srcElement).getBoundingClientRect();for(const e of r)e[0]=Math.floor(e[0]-s.left),e[1]=Math.floor(e[1]-s.top),t&&i.vec2.scale(e,e,window.devicePixelRatio);return r}pushClickHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Click,e)}pushMouseEnterHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Enter,e)}pushMouseLeaveHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Leave,e)}pushMouseDownHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Down,e)}pushMouseUpHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Up,e)}pushMouseMoveHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Move,e)}pushMouseWheelHandler(e){this.pushMouseEventHandler(a.MouseEventProvider.Type.Wheel,e)}pushTouchStartHandler(e){this.pushTouchEventHandler(c.TouchEventProvider.Type.Start,e)}pushTouchEndHandler(e){this.pushTouchEventHandler(c.TouchEventProvider.Type.End,e)}pushTouchMoveHandler(e){this.pushTouchEventHandler(c.TouchEventProvider.Type.Move,e)}pushTouchCancelHandler(e){this.pushTouchEventHandler(c.TouchEventProvider.Type.Cancel,e)}pushPointerUpHandler(e){this.pushPointerEventHandler(o.PointerEventProvider.Type.Up,e)}pushPointerDownHandler(e){this.pushPointerEventHandler(o.PointerEventProvider.Type.Down,e)}pushPointerEnterHandler(e){this.pushPointerEventHandler(o.PointerEventProvider.Type.Enter,e)}pushPointerLeaveHandler(e){this.pushPointerEventHandler(o.PointerEventProvider.Type.Leave,e)}pushPointerMoveHandler(e){this.pushPointerEventHandler(o.PointerEventProvider.Type.Move,e)}pushPointerCancelHandler(e){this.pushPointerEventHandler(o.PointerEventProvider.Type.Cancel,e)}pushEyeGazeDataHandler(e){this.pushEyeGazeEventHandler(s.EyeGazeEventProvider.Type.EyeGazeData,e)}pushEyeGazeServerMessageHandler(e){this.pushEyeGazeEventHandler(s.EyeGazeEventProvider.Type.NewServerMessage,e)}pushEyeGazeConnectionStatusHandler(e){this.pushEyeGazeEventHandler(s.EyeGazeEventProvider.Type.ConnectionStatus,e)}pushEyeGazeBinaryMessageParsingErrorHandler(e){this.pushEyeGazeEventHandler(s.EyeGazeEventProvider.Type.BinaryMessageParsingError,e)}pushKeyDownHandler(e){this.pushKeyboardEventHandler(h.KeyboardEventType.KeyDown,e)}pushKeyPressHandler(e){this.pushKeyboardEventHandler(h.KeyboardEventType.KeyPress,e)}pushKeyUpHandler(e){this.pushKeyboardEventHandler(h.KeyboardEventType.KeyUp,e)}requestPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)}exitPointerLock(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)}}},8600:e=>{"use strict";var t;!function(e){e.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],e.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],e.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]}(t||(t={})),e.exports=t},9568:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsHash=void 0;const i=r(9696),n=r(8600);class s{static encode64(e){return i.assert(e>=0&&e<=63,`expected bitfield in range [ 0b000000, 0b111111 ], given ${e}`),s.BASE64_ALPHABET[e]}static decode64(e){i.assert(1===e.length,`expected single base64 character, given '${e}'`);const t=s.BASE64_ALPHABET.indexOf(e);return i.assert(t>-1,`unknown base64 character, given '${e}'`),t}static encode(e,t){const r=s.LATEST_VERSION,n=s.EXTENSIONS_BY_VERSION.get(r),a=s.WEBGL_BACKENDS.indexOf(e);i.assert(a>-1,`expected valid backend ${s.WEBGL_BACKENDS}, given ${e} `);let o=s.encode64(r<<3|a+1);if(0===t.length)return o;let c=0;for(let e=0;e<n.length;++e)c|=t.indexOf(n[e])>-1?32>>e%6:0,e%6<5&&e<n.length-1||(o+=s.encode64(c),c=0);return o}static decode(e){const t=s.decode64(e[0]),r=t>>3,n=(7&t)-1;i.assert(n<s.WEBGL_BACKENDS.length,`expected valid backend index, given ${n}`);const a=s.WEBGL_BACKENDS[n];i.assert(s.EXTENSIONS_BY_VERSION.has(r),`expected valid hash version, given ${r}`);const o=s.EXTENSIONS_BY_VERSION.get(r),c=Math.ceil(o.length/6)+1;i.assert(e.length===c,`expected hash of version ${r} to have a length of ${c}, given ${e}`);const h=new Array;for(let t=1;t<e.length;++t){const r=s.decode64(e[t]),i=6*(t-1);32&r&&h.push(o[i+0]),16&r&&h.push(o[i+1]),8&r&&h.push(o[i+2]),4&r&&h.push(o[i+3]),2&r&&h.push(o[i+4]),1&r&&h.push(o[i+5])}return[a,h]}static complement(e,t){const r=s.WEBGL_BACKENDS.indexOf(e);return i.assert(r>-1,`expected valid backend ${s.WEBGL_BACKENDS}, given ${e} `),s.WEBGL_EXTENSIONS_BY_BACKEND.get(r).filter((e=>t.indexOf(e)<0))}}t.ExtensionsHash=s,s.WEBGL_BACKENDS=["webgl1","webgl2"],s.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,n.WEBGL1_EXTENSIONS],[1,n.WEBGL2_EXTENSIONS]]),s.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),s.LATEST_VERSION=0,s.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+"},378:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeDataStreams=t.EyeGazeDataStream=t.EyeGazeEventTarget=void 0;const i=r(2497);class n extends EventTarget{}t.EyeGazeEventTarget=n;class s{constructor(){this._eyeGazeDataStreams=new a,this._eyeGazeEventTarget=new EventTarget}generateStreamConfigByte(){const e=Uint8Array.from([0]);return this._eyeGazeDataStreams.gazePosition&&(e[0]=1|e[0]),this._eyeGazeDataStreams.gazeOrigin&&(e[0]=2|e[0]),this._eyeGazeDataStreams.eyePositionNormalized&&(e[0]=4|e[0]),this._eyeGazeDataStreams.headPositionAndRotation&&(e[0]=8|e[0]),this._eyeGazeDataStreams.userPresence&&(e[0]=16|e[0]),e}performHandshake(){this._eyeGazeDataStreams.recalculateNumberOfFloats();const e=this.generateStreamConfigByte();this._webSocket.send(e)}parseEyeTrackingData(e){if(e.length<this._eyeGazeDataStreams.expectedNumberOfFloats)return new CustomEvent(s.BINARY_MESSAGE_PARSING_ERROR);let t=0;const r=new i.EyeGazeData;return this._eyeGazeDataStreams.gazePosition&&(r.gazePositionXY[0]=e[t++],r.gazePositionXY[1]=e[t++]),this._eyeGazeDataStreams.gazeOrigin&&(r.gazeOriginRightXYZ[0]=e[t++],r.gazeOriginRightXYZ[1]=e[t++],r.gazeOriginRightXYZ[2]=e[t++],r.gazeOriginLeftXYZ[0]=e[t++],r.gazeOriginLeftXYZ[1]=e[t++],r.gazeOriginLeftXYZ[2]=e[t++]),this._eyeGazeDataStreams.eyePositionNormalized&&(r.eyePositionRightNormalizedXYZ[0]=e[t++],r.eyePositionRightNormalizedXYZ[1]=e[t++],r.eyePositionRightNormalizedXYZ[2]=e[t++],r.eyePositionLeftNormalizedXYZ[0]=e[t++],r.eyePositionLeftNormalizedXYZ[1]=e[t++],r.eyePositionLeftNormalizedXYZ[2]=e[t++]),this._eyeGazeDataStreams.headPositionAndRotation&&(r.headPositionXYZ[0]=e[t++],r.headPositionXYZ[1]=e[t++],r.headPositionXYZ[2]=e[t++],r.headRotationXYZ[0]=e[t++],r.headRotationXYZ[1]=e[t++],r.headRotationXYZ[2]=e[t++]),this._eyeGazeDataStreams.userPresence&&(r.userPresence=0!==e[t]),new CustomEvent(s.EYE_GAZE_DATA,{detail:{eyeGazeData:r}})}onOpen(e){this.dispatchEvent(new CustomEvent(s.CONNECTION_STATUS,{detail:{message:s.SUCCESSFULLY_CONNECTED_TO_SERVER,event:e}})),this.performHandshake()}onClose(e){this.dispatchEvent(new CustomEvent(s.CONNECTION_STATUS,{detail:{message:s.DISCONNECTED_TO_SERVER,event:e}}))}onError(e){this.dispatchEvent(new CustomEvent(s.CONNECTION_STATUS,{detail:{message:s.CONNECTION_ERROR,event:e}}))}async onMessage(e){if("string"!=typeof e.data){const t=await e.data.arrayBuffer(),r=new Float32Array(t);this.dispatchEvent(this.parseEyeTrackingData(r))}else this.dispatchEvent(new CustomEvent(s.NEW_SERVER_MESSAGE,{detail:{message:e.data}}))}connect(e){this._webSocket=new WebSocket(e),this._webSocket.onopen=e=>{this.onOpen(e)},this._webSocket.onclose=e=>{this.onClose(e)},this._webSocket.onerror=e=>{this.onError(e)},this._webSocket.onmessage=e=>{this.onMessage(e)}}addEventListener(e,t,r){this._eyeGazeEventTarget.addEventListener(e,t||null,r)}dispatchEvent(e){return this._eyeGazeEventTarget.dispatchEvent(e)}removeEventListener(e,t,r){this._eyeGazeEventTarget.removeEventListener(e,t||null,r)}get connectionState(){return this._webSocket.readyState}get eyeGazeDataStreams(){return this._eyeGazeDataStreams}set eyeGazeDataStreams(e){this._eyeGazeDataStreams!==e&&(this._eyeGazeDataStreams=e)}}t.EyeGazeDataStream=s,s.EYE_GAZE_DATA="eyegazedata",s.NEW_SERVER_MESSAGE="newservermessage",s.CONNECTION_STATUS="connectionstatus",s.BINARY_MESSAGE_PARSING_ERROR="binarymessageparsingerror",s.SUCCESSFULLY_CONNECTED_TO_SERVER="successfully connected to server",s.DISCONNECTED_TO_SERVER="disconnected to server",s.CONNECTION_ERROR="connection error with server";class a{constructor(){this.gazePosition=!1,this.gazeOrigin=!1,this.eyePositionNormalized=!1,this.headPositionAndRotation=!1,this.userPresence=!1,this.expectedNumberOfFloats=0}recalculateNumberOfFloats(){let e=0;this.gazePosition&&(e+=2),this.gazeOrigin&&(e+=6),this.eyePositionNormalized&&(e+=6),this.headPositionAndRotation&&(e+=6),this.userPresence&&(e+=1),this.expectedNumberOfFloats=e}}t.EyeGazeDataStreams=a},2497:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeData=void 0,t.EyeGazeData=class{constructor(){this.gazePositionXY=[0,0],this.gazeOriginRightXYZ=[0,0,0],this.gazeOriginLeftXYZ=[0,0,0],this.eyePositionRightNormalizedXYZ=[0,0,0],this.eyePositionLeftNormalizedXYZ=[0,0,0],this.headPositionXYZ=[0,0,0],this.headRotationXYZ=[0,0,0],this.userPresence=!1}toString(){let e="";return e+=`Gaze Position: ${this.gazePositionXY}\n`,e+=`Gaze Origin Right: ${this.gazeOriginRightXYZ}\n`,e+=`Gaze Origin Left: ${this.gazeOriginLeftXYZ}\n`,e+=`Eye Position Normalized Right: ${this.eyePositionRightNormalizedXYZ}\n`,e+=`Eye Position Normalized Left: ${this.eyePositionLeftNormalizedXYZ}\n`,e+=`Head Position: ${this.headPositionXYZ}\n`,e+=`Head Rotation: ${this.headRotationXYZ}\n`,e+=`User Presence: ${this.userPresence}\n`,e}}},5838:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EyeGazeEventProvider=void 0;const i=r(9130),n=r(9696),s=r(378);class a{constructor(e,t){n.assert(void 0!==e,`expected a valid eye gaze data streams object on initialization, given ${e}.`),this._eyeGazeDataStream=new s.EyeGazeDataStream,this._eyeGazeDataStream.eyeGazeDataStreams=e,this._eyeGazeDataStream.connect(t)}preventDefaultOnEvent(e,t){n.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()}allowDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)&&(this._preventDefaultMask&=~t)}preventDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)||(this._preventDefaultMask|=t)}observable(e){switch(e){case a.Type.EyeGazeData:return this.EyeGazeData$;case a.Type.NewServerMessage:return this.NewServerMessage$;case a.Type.ConnectionStatus:return this.ConnectionStatus$;case a.Type.BinaryMessageParsingError:return this.BinaryMessageParsingError$;default:return}}get EyeGazeData$(){return void 0===this._eyeGazeDataSubject&&(this._eyeGazeDataSubject=new i.ReplaySubject(void 0,this._timeframe),this._eyeGazeDataListener=e=>{this.preventDefaultOnEvent(a.Type.EyeGazeData,e),this._eyeGazeDataSubject.next(e)},this._eyeGazeDataStream.addEventListener(s.EyeGazeDataStream.EYE_GAZE_DATA,this._eyeGazeDataListener)),this._eyeGazeDataSubject.asObservable()}get NewServerMessage$(){return void 0===this._newServerMessageSubject&&(this._newServerMessageSubject=new i.ReplaySubject(void 0,this._timeframe),this._newServerMessageListener=e=>{this.preventDefaultOnEvent(a.Type.NewServerMessage,e),this._newServerMessageSubject.next(e)},this._eyeGazeDataStream.addEventListener(s.EyeGazeDataStream.NEW_SERVER_MESSAGE,this._newServerMessageListener)),this._newServerMessageSubject.asObservable()}get ConnectionStatus$(){return void 0===this._connectionStatusSubject&&(this._connectionStatusSubject=new i.ReplaySubject(void 0,this._timeframe),this._connectionStatusListener=e=>{this.preventDefaultOnEvent(a.Type.ConnectionStatus,e),this._connectionStatusSubject.next(e)},this._eyeGazeDataStream.addEventListener(s.EyeGazeDataStream.CONNECTION_STATUS,this._connectionStatusListener)),this._connectionStatusSubject.asObservable()}get BinaryMessageParsingError$(){return void 0===this._binaryMessageParsingErrorSubject&&(this._binaryMessageParsingErrorSubject=new i.ReplaySubject(void 0,this._timeframe),this._binaryMessageParsingErrorListener=e=>{this.preventDefaultOnEvent(a.Type.BinaryMessageParsingError,e),this._binaryMessageParsingErrorSubject.next(e)},this._eyeGazeDataStream.addEventListener(s.EyeGazeDataStream.BINARY_MESSAGE_PARSING_ERROR,this._binaryMessageParsingErrorListener)),this._eyeGazeDataSubject.asObservable()}}t.EyeGazeEventProvider=a,function(e){let t;!function(e){e[e.EyeGazeData=1]="EyeGazeData",e[e.NewServerMessage=2]="NewServerMessage",e[e.ConnectionStatus=4]="ConnectionStatus",e[e.BinaryMessageParsingError=8]="BinaryMessageParsingError"}(t=e.Type||(e.Type={}))}(a=t.EyeGazeEventProvider||(t.EyeGazeEventProvider={}))},6869:(e,t,r)=>{"use strict";const i=r(3607);var n;!function(e){const t=(e,t)=>`fetching '${e}' failed (${t.status}): ${t.statusText}`;e.fetchAsync=function(e,r){return new Promise(((i,n)=>{const s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType=r,s.onload=()=>{s.status<200||s.status>=300?n(t(e,s)):i(s.response)},s.onerror=()=>n(t(e,s)),s.ontimeout=()=>n(t(e,s)),s.send()}))},e.fetchJsonAsync=function(e,r,n){return new Promise(((s,a)=>{const o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=()=>{if(o.status<200||o.status>=300)return void a(t(e,o));const c=o.responseText;if(void 0!==n&&!i.validate(c,n))return;let h;try{h=JSON.parse(c)}catch(t){return void a(`fetching '${e}' failed (${t.name}): ${t.message}`)}const l=r(h);void 0!==l?s(l):a(`fetching '${e}' failed (TransformError): transforming the object failed.`)},o.onerror=()=>a(t(e,o)),o.ontimeout=()=>a(t(e,o)),o.send()}))}}(n||(n={})),e.exports=n},9870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FirstPersonModifier=void 0;const i=r(3659),n=r(2111),s=r(6491);class a extends s.CameraModifier{constructor(){super(...arguments),this._rotation=i.mat4.create(),this._sensitivity=a.DEFAULT_SENSITIVITY}initiate(e){Object.assign(this._reference,this._camera),this._initialPoint=e}process(e,t){this._currentPoint=e;const r=i.vec2.create();void 0===t?i.vec2.subtract(r,this._initialPoint,this._currentPoint):i.vec2.copy(r,t),i.vec2.scale(r,r,window.devicePixelRatio*this._sensitivity),i.vec2.copy(this._initialPoint,this._currentPoint);const s=i.vec3.sub(n.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(s,s);const a=i.vec3.cross(n.v3(),s,this._reference.up),o=i.mat4.fromRotation(n.m4(),-r[0],this._reference.up),c=i.mat4.fromRotation(n.m4(),r[1],a);i.mat4.mul(this._rotation,c,o),this.update()}update(){if(void 0===this._camera)return;const e=i.mat4.fromTranslation(n.m4(),this._reference.eye);i.mat4.multiply(e,e,this._rotation),i.mat4.translate(e,e,i.vec3.negate(n.v3(),this._reference.eye));const t=i.vec3.transformMat4(n.v3(),this._reference.center,e);this._camera.center=t,Object.assign(this._reference,this._camera)}set sensitivity(e){this._sensitivity=e}get sensitivity(){return this._sensitivity}}t.FirstPersonModifier=a,a.DEFAULT_SENSITIVITY=8e-4},423:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.byteSizeOfFormat=void 0;const i=r(9696);let n;const s=new Map;t.byteSizeOfFormat=function(e,t){const r=e.gl;if(void 0===t)return i.assert(!1,"expected given format to be defined"),0;if(function(e,t){const r=e.gl,i=e.gl2facade;if(void 0===t)return!1;if(void 0===n){const t=e.supportsDepthTexture?e.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;n=new Array(r.UNSIGNED_BYTE,r.UNSIGNED_SHORT_5_6_5,r.UNSIGNED_SHORT_4_4_4_4,r.UNSIGNED_SHORT_5_5_5_1,r.UNSIGNED_SHORT,r.UNSIGNED_INT,t,r.FLOAT,i.HALF_FLOAT,r.BYTE,r.SHORT,r.INT,r.HALF_FLOAT,r.UNSIGNED_INT_2_10_10_10_REV,r.UNSIGNED_INT_10F_11F_11F_REV,r.UNSIGNED_INT_5_9_9_9_REV,r.UNSIGNED_INT_24_8,r.FLOAT_32_UNSIGNED_INT_24_8_REV)}return n.indexOf(t)>-1}(e,t))return i.assert(!1,`expected format instead of type ${t}`),0;if(t===r.DEPTH_COMPONENT||t===r.DEPTH_STENCIL)return i.assert(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0;const a=function(e){if(s.has(e))return s.get(e);const t=e.gl,r=new Map([[t.ALPHA,1],[t.LUMINANCE,1],[t.R8,1],[t.R8I,1],[t.R8UI,1],[t.STENCIL_INDEX8,1],[t.DEPTH_COMPONENT16,2],[t.LUMINANCE_ALPHA,2],[t.R16F,2],[t.R16I,2],[t.R16UI,2],[t.RG8,2],[t.RG8I,2],[t.RG8UI,2],[t.RGB565,2],[t.RGB5_A1,2],[t.RGBA4,2],[t.DEPTH_COMPONENT24,3],[t.RGB,3],[t.RGB8,3],[t.RGB8UI,3],[t.SRGB,3],[t.SRGB8,3],[t.DEPTH24_STENCIL8,4],[t.DEPTH_COMPONENT32F,4],[t.R11F_G11F_B10F,4],[t.R32F,4],[t.R32I,4],[t.R32UI,4],[t.RG16F,4],[t.RG16I,4],[t.RG16UI,4],[t.RGB10_A2,4],[t.RGB10_A2UI,4],[t.RGB9_E5,4],[t.RGBA,4],[t.RGBA8,4],[t.RGBA8I,4],[t.RGBA8UI,4],[t.SRGB8_ALPHA8,4],[t.SRGB_ALPHA,4],[t.SRGB_ALPHA8,4],[t.SRGB_APLHA8,4],[t.DEPTH32F_STENCIL8,5],[t.RGB16F,6],[t.RG32F,8],[t.RG32I,8],[t.RG32UI,8],[t.RGBA16F,8],[t.RGBA16I,8],[t.RGBA16UI,8],[t.RGB32F,12],[t.RGBA32F,16],[t.RGBA32I,16],[t.RGBA32UI,16]]);return e.isWebGL1&&e.supportsSRGB&&(r.set(e.sRGB.SRGB_EXT,3),r.set(e.sRGB.SRGB_ALPHA_EXT,4),r.set(e.sRGB.SRGB8_ALPHA8_EXT,4)),e.supportsColorBufferFloat&&(r.set(e.colorBufferFloat.RGB32F_EXT,12),r.set(e.colorBufferFloat.RGBA32F_EXT,16)),s.set(e,r),r}(e).get(t);return i.assert(void 0!==a,`size of format ${t} is unknown`),a||0}},9564:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Framebuffer=void 0;const n=r(9696),s=r(1030),a=r(2281),o=r(7540),c=r(6942);class h extends a.AbstractObject{constructor(){super(...arguments),this._buffersByAttachment=new Map,this._texturesByAttachment=new Map,this._colorClearQueue=new Array,this._drawBuffers=new Array,this._drawBuffersChanged=!1}static statusString(e,t){const r=e.gl;switch(t){case r.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case r.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case r.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return n.assert(!1,`expected known framebuffer status, given ${t}`),""}}create(e){const t=this._context.gl,r=this.context.gl2facade;this._object=t.createFramebuffer(),this._clearColors=new Array(r.COLOR_ATTACHMENT_MAX-r.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(const i of e){const e=i[0],n=i[1];if(n instanceof o.Renderbuffer?this._buffersByAttachment.set(e,n):n instanceof c.Texture2D&&this._texturesByAttachment.set(e,n),e<r.COLOR_ATTACHMENT_MIN||e>r.COLOR_ATTACHMENT_MAX)continue;this._drawBuffers.push(e);const s=e-t.COLOR_ATTACHMENT0;this._colorClearQueue.push(s),this._clearColors[s]=[0,0,0,0]}this._drawBuffersChanged=!0,t.bindFramebuffer(t.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach(((e,r)=>{t.framebufferRenderbuffer(t.FRAMEBUFFER,r,t.RENDERBUFFER,e.object)})),this._texturesByAttachment.forEach(((e,r)=>{t.framebufferTexture2D(t.FRAMEBUFFER,r,t.TEXTURE_2D,e.object,0)}));const i=t.checkFramebufferStatus(t.FRAMEBUFFER);return this._valid=t.isFramebuffer(this._object)&&i===t.FRAMEBUFFER_COMPLETE,n.logIf(!this._valid,n.LogLevel.Warning,h.statusString(this.context,i)),r.drawBuffers&&r.drawBuffers(this._drawBuffers),t.bindFramebuffer(t.FRAMEBUFFER,h.DEFAULT_FRAMEBUFFER),this._object}delete(){n.assert(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1}es2Clear(e,t=!0,r=!0){const i=this.context.gl,s=n.bitInBitfield(e,i.DEPTH_BUFFER_BIT),a=n.bitInBitfield(e,i.STENCIL_BUFFER_BIT),o=n.bitInBitfield(e,i.COLOR_BUFFER_BIT);if(o||s||a){if(t&&this.bind(),o&&void 0!==this._clearColors[0]){const e=this._clearColors[0];i.clearColor(e[0],e[1],e[2],e[3])}s&&void 0!==this._clearDepth&&i.clearDepth(this._clearDepth),a&&void 0!==this._clearStencil&&i.clearStencil(this._clearStencil),i.clear(e),r&&this.unbind()}}es3Clear(e,t=!0,r=!0,i){const s=this.context.gl,a=n.bitInBitfield(e,s.DEPTH_BUFFER_BIT),o=n.bitInBitfield(e,s.STENCIL_BUFFER_BIT),c=n.bitInBitfield(e,s.COLOR_BUFFER_BIT);if(c||a||o){if(t&&this.bind(),c){if(window.chrome&&(window.chrome.webstore||window.chrome.runtime)){const e=this._clearColors[0]?this._clearColors[0]:[0,0,0,1];s.clearColor(e[0],e[1],e[2],e[3]),s.clear(s.COLOR_BUFFER_BIT)}for(const e of i||this._colorClearQueue)s.clearBufferfv(s.COLOR,e,this._clearColors[e])}a&&o?(s.clearStencil(this._clearStencil),s.clearDepth(this._clearDepth),s.clear(s.STENCIL_BUFFER_BIT|s.DEPTH_BUFFER_BIT)):a?s.clearBufferfv(s.DEPTH,0,[this._clearDepth]):o&&(s.clearStencil(this._clearStencil),s.clear(s.STENCIL_BUFFER_BIT)),r&&this.unbind()}}hasAttachment(e){return this._texturesByAttachment.has(e)||this._buffersByAttachment.has(e)}bind(e=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(e,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)}unbind(e=this.context.gl.FRAMEBUFFER){this.context.gl.bindFramebuffer(e,h.DEFAULT_FRAMEBUFFER)}clearColor(e,t){n.assert(void 0===t||0===t||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");const r=e[3]<1&&!this.context.alpha;n.logIf(r,n.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");const i=[e[0],e[1],e[2],r?1:e[3]];if(this.context.premultipliedAlpha&&!r&&(i[0]*=i[3],i[1]*=i[3],i[2]*=i[3]),void 0!==t)this._clearColors[t]=i;else for(let e=0;e<this._clearColors.length;++e)this._clearColors[e]=i}clearDepth(e){this._clearDepth=e}clearStencil(e){this._clearStencil=e}texture(e){return this._texturesByAttachment.get(e)}resize(e,t,r=!0,i=!0){this._buffersByAttachment.forEach((n=>{n.resize(e,t,r,i)})),this._texturesByAttachment.forEach((n=>{n.resize(e,t,r,i)}))}get width(){this.assertInitialized();let e=NaN;return this._buffersByAttachment.forEach((t=>{(isNaN(e)||t.width<e)&&(e=t.width)})),this._texturesByAttachment.forEach((t=>{(isNaN(e)||t.width<e)&&(e=t.width)})),e}get height(){this.assertInitialized();let e=NaN;return this._buffersByAttachment.forEach((t=>{(isNaN(e)||t.height<e)&&(e=t.height)})),this._texturesByAttachment.forEach((t=>{(isNaN(e)||t.height<e)&&(e=t.height)})),e}get size(){return[this.width,this.height]}set drawBuffers(e){this.assertInitialized();const t=this.context.gl2facade;for(const r of e)n.assert(this.hasAttachment(r),`valid attachment expected for draw buffer, given ${r}`),n.assert(r>=t.COLOR_ATTACHMENT_MIN&&r<=t.COLOR_ATTACHMENT_MAX,`color attachment expected for draw buffer, given ${r}`),this._drawBuffersChanged=this._drawBuffersChanged||-1===this._drawBuffers.indexOf(r);this._drawBuffersChanged=this._drawBuffersChanged||e.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=e)}get drawBuffers(){return this.assertInitialized(),this._drawBuffers}}h.DEFAULT_FRAMEBUFFER=void 0,i([s.Initializable.assert_initialized()],h.prototype,"es2Clear",null),i([s.Initializable.assert_initialized()],h.prototype,"es3Clear",null),i([s.Initializable.assert_initialized()],h.prototype,"bind",null),i([s.Initializable.assert_initialized()],h.prototype,"unbind",null),i([s.Initializable.assert_initialized()],h.prototype,"clearColor",null),i([s.Initializable.assert_initialized()],h.prototype,"clearDepth",null),i([s.Initializable.assert_initialized()],h.prototype,"clearStencil",null),i([s.Initializable.assert_initialized()],h.prototype,"texture",null),i([s.Initializable.assert_initialized()],h.prototype,"resize",null),t.Framebuffer=h},9544:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FrameCapture=void 0;const i=r(9696),n=r(9564),s=r(6786);class a{static createDataURL(e,t,r){const i=document.createElement("canvas"),n=i.getContext("2d");return i.width=e.width,i.height=e.height,n.putImageData(e,0,0),i.toDataURL(t,r)}static captureDefaultFramebuffer(e,t,r){const i=e.context.gl;e.bind(),i.readPixels(t.x,t.y,t.width,t.height,i.RGBA,i.UNSIGNED_BYTE,r),e.unbind()}static captureFramebuffer(e,t,r,n){const s=e.context.gl,a=e.texture(t);if(i.assert(void 0!==a,`Framebuffer does not have given attachment ${t}.`),i.assert(a.format===s.RGBA,`Unsupported texture format ${a.format}.`),i.assert(a.type===s.UNSIGNED_BYTE||a.type===s.FLOAT||a.type===s.HALF_FLOAT,`Unsupported texture type ${a.type}.`),s.readBuffer(t),a.type===s.FLOAT||a.type===s.HALF_FLOAT){const e=new Float32Array(r.width*r.height*4);s.readPixels(r.x,r.y,r.width,r.height,s.RGBA,s.FLOAT,e),e.forEach(((e,t)=>{n[t]=255*e}))}else a.type===s.UNSIGNED_BYTE&&s.readPixels(r.x,r.y,r.width,r.height,s.RGBA,s.UNSIGNED_BYTE,n)}static flipImageDataVertically(e){const t=e.height,r=e.data.length/t,i=Math.floor(t/2);for(let n=0;n<i;++n){const i=e.data.slice(n*r,(n+1)*r);e.data.copyWithin(n*r,(t-n-1)*r,(t-n)*r),e.data.set(i,(t-n-1)*r)}}static capture(e,t,r){const i=e.context.gl,o=e.size;void 0===r&&(r={x:0,y:0,width:o[0],height:o[1]}),void 0===t&&(t=i.COLOR_ATTACHMENT0);const c=new ImageData(r.width,r.height),h=new Uint8Array(c.data.buffer);return e.bind(i.READ_FRAMEBUFFER),e instanceof s.DefaultFramebuffer?a.captureDefaultFramebuffer(e,r,h):e instanceof n.Framebuffer&&a.captureFramebuffer(e,t,r,h),e.unbind(i.READ_FRAMEBUFFER),a.flipImageDataVertically(c),c}}t.FrameCapture=a},5714:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.GaussFilter=void 0;const n=r(3659),s=r(9696),a=r(2111),o=r(1030),c=r(7570),h=r(4895),l=r(5263);class u extends o.Initializable{constructor(e){super(),this._kernelSize=7,this._standardDeviation=1,this._redistribute=!0,this._ndcTriangleShared=!1,this._context=e}recalculateWeights(){if(this._weights)return!1;const e=1/Math.sqrt(2*Math.PI)*this._standardDeviation,t=2*this._standardDeviation*this._standardDeviation;this._weights=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;for(let i=0;i<=Math.floor(this._kernelSize/2);i++)this._weights[i]=e*Math.pow(Math.E,-Math.pow(i,2)/t),r+=i>0?2*this._weights[i]:this._weights[i];if(this._redistribute){const e=1-r;for(let t=0;t<=Math.floor(this._kernelSize/2);t++)this._weights[t]+=this._weights[t]/r*e}return!0}get kernelSize(){return this._kernelSize}set kernelSize(e){s.assert(e>0,"Kernel size has to be positive."),s.assert(e<=2*(u._MAXKERNELSIZEHALF-1)+1,"Kernel size has to be smaller than "+(2*(u._MAXKERNELSIZEHALF-1)+2)+"."),s.assert(Number.isInteger(e),"Kernel size has to be an integer."),s.assert(e%2==1,"Kernel size has to be odd."),this._kernelSize=e,this._weights=void 0}get standardDeviation(){return this._standardDeviation}set standardDeviation(e){s.assert(e>0,"Standard deviation has to be positive."),this._standardDeviation=e,this._weights=void 0}get redistribute(){return this._redistribute}set redistribute(e){this._redistribute=e,this._weights=void 0}initialize(e){const t=this._context.gl,i=new l.Shader(this._context,t.VERTEX_SHADER,"gauss.vert");i.initialize(r(1622)),this._fragmentShader=new l.Shader(this._context,t.FRAGMENT_SHADER,"gauss.frag"),this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.initialize(r(4472)),this._program=new h.Program(this._context),this._program.initialize([i,this._fragmentShader]),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights");const n=this._program.attribute("a_vertex",0);return void 0===e?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"GaussFilterQuad"):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialize(n),!0}uninitialize(){this._program.uninitialize(),this._ndcTriangleShared||this._ndcTriangle.uninitialize()}filter(e,t){const r=this._context.gl,i=[n.vec2.fromValues(1,0),n.vec2.fromValues(0,1)];this.recalculateWeights()&&(this._fragmentShader.replace("$KERNEL_HALF_SIZE",`${Math.floor(this.kernelSize/2)}`),this._fragmentShader.compile(),this._program.link(),this._uDelta=this._program.uniform("u_delta"),this._uWeights=this._program.uniform("u_weights"),this._program.bind(),r.uniform1fv(this._uWeights,this._weights)),this._program.bind(),e.bind(r.TEXTURE0),r.uniform2fv(this._uDelta,n.vec2.divide(a.v2(),i[t],e.size)),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),e.unbind(r.TEXTURE0),this._program.unbind()}}u._MAXKERNELSIZEHALF=32,i([o.Initializable.initialize()],u.prototype,"initialize",null),i([o.Initializable.uninitialize()],u.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],u.prototype,"filter",null),t.GaussFilter=u,function(e){let t;!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t=e.Direction||(e.Direction={}))}(u=t.GaussFilter||(t.GaussFilter={}))},4894:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Geometry=void 0;const n=r(1030),s=r(5590);class a extends n.Initializable{constructor(e,t){super(),this._buffers=new Array,t=void 0!==t&&""!==t?t:this.constructor.name,this._vertexArray=new s.VertexArray(e,`${t}VAO`)}initialize(...e){const t=e[0],r=e[1];let i=!0;for(let e=0;e<this._buffers.length;++e)i=this._buffers[e].initialize(t[e])&&i;return this._vertexArray.initialize((()=>this.bindBuffers(r)),(()=>this.unbindBuffers(r))),this._vertexArray.valid&&i}uninitialize(){this._vertexArray.uninitialize(),this._buffers.forEach((e=>e.uninitialize()))}bind(){this._vertexArray.bind()}unbind(){this._vertexArray.unbind()}get buffers(){return this._buffers}get context(){return this._vertexArray.context}get vertexArray(){return this._vertexArray}}i([n.Initializable.initialize()],a.prototype,"initialize",null),i([n.Initializable.uninitialize()],a.prototype,"uninitialize",null),i([n.Initializable.assert_initialized()],a.prototype,"bind",null),i([n.Initializable.assert_initialized()],a.prototype,"unbind",null),t.Geometry=a},2111:(e,t,r)=>{"use strict";const i=r(3659);var n;!function(e){function t(e){return e>0?e-Math.floor(e):e-Math.ceil(e)}e.sign=function(e){return e>0?1:e<0?-1:0},e.clamp=function(e,t,r){return Math.max(t,Math.min(r,e))},e.fract=t,e.v2=function(){return i.vec2.create()},e.clamp2=function(e,t,r,i){return e[0]=Math.max(r[0],Math.min(i[0],t[0])),e[1]=Math.max(r[1],Math.min(i[1],t[1])),e},e.abs2=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e},e.v3=function(){return i.vec3.create()},e.clamp3=function(e,t,r,i){return e[0]=Math.max(r[0],Math.min(i[0],t[0])),e[1]=Math.max(r[1],Math.min(i[1],t[1])),e[2]=Math.max(r[2],Math.min(i[2],t[2])),e},e.abs3=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e};const r=1/256;e.encode_float24x1_to_uint8x3=function(e,r){return e[0]=Math.floor(256*r),e[1]=Math.floor(256*t(256*r)),e[2]=Math.floor(256*t(65536*r)),e},e.decode_float24x1_from_uint8x3=function(e){return(e[0]+(e[1]+e[2]*r)*r)*r},e.encode_uint24_to_rgb8=function(e,t){return e[0]=t>>>0&255,e[1]=t>>>8&255,e[2]=t>>>16&255,e},e.encode_uint32_to_rgba8=function(e,t){return e[0]=t>>>0&255,e[1]=t>>>8&255,e[2]=t>>>16&255,e[3]=t>>>24&255,e},e.decode_uint24_from_rgb8=function(e){return e[0]+(e[1]<<8)+(e[2]<<16)},e.decode_uint32_from_rgba8=function(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)>>>0},e.fromVec4=function(e){return 0===e[3]?i.vec3.fromValues(e[0],e[1],e[2]):i.vec3.fromValues(e[0]/e[3],e[1]/e[3],e[2]/e[3])},e.v4=function(){return i.vec4.create()},e.clamp4=function(e,t,r,i){return e[0]=Math.max(r[0],Math.min(i[0],t[0])),e[1]=Math.max(r[1],Math.min(i[1],t[1])),e[2]=Math.max(r[2],Math.min(i[2],t[2])),e[3]=Math.max(r[3],Math.min(i[3],t[3])),e},e.abs4=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e[3]=Math.abs(t[3]),e},e.fromVec3=function(e){return i.vec4.fromValues(e[0],e[1],e[2],1)},e.parseVec2=function(e){if(void 0===e||""===e)return;let t=[];try{t=JSON.parse(`[${e}]`)}catch(e){return}return 2!==t.length||isNaN(t[0])||isNaN(t[1])?void 0:i.vec2.clone(t)},e.parseVec3=function(e){if(void 0===e||""===e)return;let t=[];try{t=JSON.parse(`[${e}]`)}catch(e){return}return 3!==t.length||isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?void 0:i.vec3.clone(t)},e.parseVec4=function(e){if(void 0===e||""===e)return;let t=[];try{t=JSON.parse(`[${e}]`)}catch(e){return}return 4!==t.length||isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?void 0:i.vec4.clone(t)},e.mix=function(e,t,r){return e*(1-r)+t*r},e.m2=function(){return i.mat2.create()},e.m3=function(){return i.mat3.create()},e.m4=function(){return i.mat4.create()}}(n||(n={})),e.exports=n},5218:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GL2Facade=void 0;const i=r(9696),n=r(4518);t.GL2Facade=class{constructor(e){this.drawBuffers=void 0,i.assert(void 0!==e,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(e),this.queryColorAttachments(e),this.queryInstancedArraySupport(e),this.queryDrawBuffersSupport(e),this.queryVertexArrayObjectSupport(e),this.queryMaxUniformVec3Components(e),this.queryBufferSubDataInterface(e),this.queryTexImageInterface(e)}get HALF_FLOAT(){return this._halfFloat}queryHalfFloatSupport(e){switch(e.backend){case n.Context.BackendType.WebGL1:this._halfFloat=e.supportsTextureHalfFloat&&e.textureHalfFloat?e.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case n.Context.BackendType.WebGL2:default:this._halfFloat=e.gl.HALF_FLOAT}}get COLOR_ATTACHMENT_MIN(){return this._colorAttachmentMin}get COLOR_ATTACHMENT_MAX(){return this._colorAttachmentMax}get COLOR_ATTACHMENT0(){return this._colorAttachments[0]}get COLOR_ATTACHMENT1(){return this._colorAttachments[1]}get COLOR_ATTACHMENT2(){return this._colorAttachments[2]}get COLOR_ATTACHMENT3(){return this._colorAttachments[3]}get COLOR_ATTACHMENT4(){return this._colorAttachments[4]}get COLOR_ATTACHMENT5(){return this._colorAttachments[5]}get COLOR_ATTACHMENT6(){return this._colorAttachments[6]}get COLOR_ATTACHMENT7(){return this._colorAttachments[7]}get COLOR_ATTACHMENT8(){return this._colorAttachments[8]}get COLOR_ATTACHMENT9(){return this._colorAttachments[9]}get COLOR_ATTACHMENT10(){return this._colorAttachments[10]}get COLOR_ATTACHMENT11(){return this._colorAttachments[11]}get COLOR_ATTACHMENT12(){return this._colorAttachments[12]}get COLOR_ATTACHMENT13(){return this._colorAttachments[13]}get COLOR_ATTACHMENT14(){return this._colorAttachments[14]}get COLOR_ATTACHMENT15(){return this._colorAttachments[15]}queryColorAttachments(e){const t=e.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=t.COLOR_ATTACHMENT0,e.backend){case n.Context.BackendType.WebGL1:const r=e.supportsDrawBuffers?e.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(r?t.getParameter(r.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=r?r.COLOR_ATTACHMENT0_WEBGL:t.COLOR_ATTACHMENT0,!r)break;for(let e=1;e<16;++e)this._colorAttachments[e]=r.COLOR_ATTACHMENT0_WEBGL+e;break;case n.Context.BackendType.WebGL2:default:this._colorAttachmentMin=e.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=e.gl.COLOR_ATTACHMENT0+t.getParameter(t.MAX_COLOR_ATTACHMENTS);for(let e=0;e<16;++e)this._colorAttachments[e]=t.COLOR_ATTACHMENT0+e}}queryInstancedArraySupport(e){(e.isWebGL2||e.supportsInstancedArrays)&&(this.drawArraysInstanced=e.isWebGL2?(t,r,i,n)=>e.gl.drawArraysInstanced(t,r,i,n):(t,r,i,n)=>e.instancedArrays.drawArraysInstancedANGLE(t,r,i,n),this.drawElementsInstanced=e.isWebGL2?(t,r,i,n,s)=>e.gl.drawElementsInstanced(t,r,i,n,s):(t,r,i,n,s)=>e.instancedArrays.drawElementsInstancedANGLE(t,r,i,n,s),this.vertexAttribDivisor=e.isWebGL2?(t,r)=>e.gl.vertexAttribDivisor(t,r):(t,r)=>e.instancedArrays.vertexAttribDivisorANGLE(t,r))}get MAX_DRAW_BUFFERS(){return this._maxDrawBuffers}queryDrawBuffersSupport(e){(e.isWebGL2||e.supportsDrawBuffers)&&(this.drawBuffers=e.isWebGL2?t=>e.gl.drawBuffers(t):t=>e.drawBuffers.drawBuffersWEBGL(t),this._maxDrawBuffers=e.isWebGL2?e.gl.MAX_DRAW_BUFFERS:e.drawBuffers.MAX_DRAW_BUFFERS_WEBGL)}queryVertexArrayObjectSupport(e){(e.isWebGL2||e.supportsVertexArrayObject)&&(this.createVertexArray=e.isWebGL2?()=>e.gl.createVertexArray():()=>e.vertexArrayObject.createVertexArrayOES(),this.deleteVertexArray=e.isWebGL2?t=>e.gl.deleteVertexArray(t):t=>e.vertexArrayObject.deleteVertexArrayOES(t),this.isVertexArray=e.isWebGL2?t=>e.gl.isVertexArray(t):t=>e.vertexArrayObject.isVertexArrayOES(t),this.bindVertexArray=e.isWebGL2?t=>e.gl.bindVertexArray(t):t=>e.vertexArrayObject.bindVertexArrayOES(t))}get maxUniformVec3Components(){return this._maxUniformVec3Components}queryMaxUniformVec3Components(e){const t=e.gl;this._maxUniformVec3Components=e.isWebGL2?t.getParameter(t.MAX_VERTEX_UNIFORM_COMPONENTS):3*t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS)}queryBufferSubDataInterface(e){const t=e.gl;e.isWebGL2?this.bufferSubData=(e,r,i,n,s=0)=>t.bufferSubData(e,r,i,n,s):this.bufferSubData=(e,r,n,s=0,a=0)=>(i.logIf(0!==s,i.LogLevel.Warning,"srcOffset ignored (not supported in WebGL)"),i.logIf(0!==a,i.LogLevel.Warning,"length ignored (not supported in WebGL)"),t.bufferSubData(e,r,n))}queryTexImageInterface(e){const t=e.gl;e.isWebGL2?this.texImage2D=(e,r,n,s,a,o,c,h,l,u)=>l instanceof ArrayBuffer?t.texImage2D(e,r,n,s,a,o,c,h,void 0===l?null:l,u):(i.assert(void 0===u,"offset expected to be undefined for non ArrayBuffer source"),t.texImage2D(e,r,n,s,a,o,c,h,void 0===l?null:l)):this.texImage2D=(e,r,i,n,s,a,o,c,h,l)=>void 0===h?t.texImage2D(e,r,i,n,s,a,o,c,null):h instanceof Int8Array||h instanceof Uint8Array||h instanceof Uint8ClampedArray||h instanceof Int16Array||h instanceof Uint16Array||h instanceof Int32Array||h instanceof Uint32Array||h instanceof Float32Array||h instanceof Float64Array||h instanceof DataView?t.texImage2D(e,r,i,n,s,a,o,c,h):t.texImage2D(e,r,i,o,c,h),e.supportsTexImage3D?this.texImage3D=(e,r,n,s,a,o,c,h,l,u,d)=>u instanceof ArrayBuffer?t.texImage3D(e,r,n,s,a,o,c,h,l,void 0===u?null:u,d):(i.assert(void 0===d,"offset expected to be undefined for non ArrayBuffer source"),t.texImage3D(e,r,n,s,a,o,c,h,l,void 0===u?null:u)):this.texImage3D=(e,t,r,n,s,a,o,c,h,l,u)=>i.assert(!1,"texImage3D not supported on this context")}}},8269:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFHelper=void 0;const i=r(9696);t.GLTFHelper=class{static modeToEnum(e,t){return(t<0||t>6)&&i.log(i.LogLevel.Error,`Specified draw mode is ${t} but is required to be between 0 and 6`),0===t?e.POINTS:1===t?e.LINES:2===t?e.LINE_LOOP:3===t?e.LINE_STRIP:4===t?e.TRIANGLES:5===t?e.TRIANGLE_STRIP:6===t?e.TRIANGLE_FAN:e.TRIANGLES}static nameToAttributeIndex(e){return"POSITION"===e?0:"NORMAL"===e?1:"TANGENT"===e?2:"TEXCOORD_0"===e?3:"TEXCOORD_1"===e?4:"TEXCOORD_2"===e?5:"JOINTS_0"===e?6:"WEIGHTS_0"===e?7:"COLOR_0"===e?8:(i.log(i.LogLevel.Warning,`Unknown attribute name '${e}' encountered.             Possibly this model uses an unsupported extension.`),-1)}}},5500:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFLoader=void 0;const i=r(3659),n=r(9696),s=r(3041),a=r(8269),o=r(858),c=r(7964),h=r(4303),l=r(6404),u=r(2194),d=r(4895),_=r(9922),f=r(9981),p=r(5263),m=r(6942);t.GLTFLoader=class{constructor(e){this._context=e;const t=this._context.gl;this._resourceManager=new u.ResourceManager(this._context),this._scenes=new Array;const i=new p.Shader(this._context,t.VERTEX_SHADER,"gltf_default.vert");i.initialize(r(6263));const n=new p.Shader(this._context,t.FRAGMENT_SHADER,"gltf_default.frag");n.initialize(r(6277)),this._pbrProgram=new d.Program(this._context,"GLTFPbrProgram"),this._pbrProgram.initialize([i,n])}async loadTextures(e){const t=this._context.gl;this._uriTextureMap=new Map;const r=e.gltf.textures,i=e.gltf.images,s=e.gltf.samplers;if(!r||!i)return;let a=0;for(const o of r){if(void 0===o.source){n.log(n.LogLevel.Warning,"The GLTF model does not specify a texture source. Possibly it uses an unsupported extension."),a++;continue}const r=o.source,c=i[r],h=this._sceneName+"_texture_"+a,l=void 0===c.name?c.uri:c.name;let u=await e.imageData.get(r);if(!n.isPowerOfTwo(u.width)||!n.isPowerOfTwo(u.height)){const e=document.createElement("canvas");e.width=n.upperPowerOfTwo(u.width),e.height=n.upperPowerOfTwo(u.height);const t=e.getContext("2d");void 0===t&&n.log(n.LogLevel.Error,"Failed to create context while trying to resize non power of two texture"),t.drawImage(u,0,0,e.width,e.height),u=e}const d=new m.Texture2D(this._context,l);if(d.initialize(u.width,u.height,t.RGBA8,t.RGBA,t.UNSIGNED_BYTE),d.data(u),void 0===s||void 0===o.sampler)d.wrap(t.REPEAT,t.REPEAT),d.filter(t.LINEAR,t.LINEAR);else{const e=s[o.sampler];d.wrap(e.wrapS||t.REPEAT,e.wrapT||t.REPEAT),d.filter(e.magFilter||t.LINEAR,e.minFilter||t.LINEAR),e.minFilter!==t.NEAREST_MIPMAP_NEAREST&&e.minFilter!==t.LINEAR_MIPMAP_NEAREST&&e.minFilter!==t.NEAREST_MIPMAP_LINEAR&&e.minFilter!==t.LINEAR_MIPMAP_LINEAR||d.generateMipMap()}this._resourceManager.add(d,[l,h]);const _=c.uri?c.uri:h;this._uriTextureMap.set(_,d),a++}}getTexture(e){const t=this._sceneName+"_texture_"+e,r=this._resourceManager.get(t);if(void 0!==r)return r;n.log(n.LogLevel.Warning,`Texture with index ${e} could not be located.`)}async loadMaterials(e){this._pbrDefaultMaterial=new c.GLTFPbrMaterial(this._context,"DefaultMaterial"),this._resourceManager.add(this._pbrDefaultMaterial,[this._pbrDefaultMaterial.name]);const t=e.gltf.materials;if(!t)return;let r=0;for(const e of t){const t=this._sceneName+"_material_"+r,s=new c.GLTFPbrMaterial(this._context,e.name),a=e.normalTexture;void 0!==a&&(s.normalTexture=this.getTexture(a.index),s.normalTexCoord=a.texCoord||0,s.normalScale=a.scale||1);const o=e.occlusionTexture;void 0!==o&&(s.occlusionTexture=this.getTexture(o.index),s.occlusionTexCoord=o.texCoord||0);const h=e.emissiveTexture;void 0!==h&&(s.emissiveTexture=this.getTexture(h.index),s.emissiveTexCoord=h.texCoord||0),s.emissiveFactor=i.vec3.fromValues(0,0,0),void 0!==e.emissiveFactor&&(s.emissiveFactor=i.vec3.fromValues.apply(void 0,e.emissiveFactor)),s.alphaMode=c.GLTFAlphaMode.OPAQUE,"MASK"===e.alphaMode?(s.alphaMode=c.GLTFAlphaMode.MASK,void 0===e.alphaCutoff?s.alphaCutoff=.5:s.alphaCutoff=e.alphaCutoff):"BLEND"===e.alphaMode&&(s.alphaMode=c.GLTFAlphaMode.BLEND,s.isTransparent=!0),s.isDoubleSided=e.doubleSided||!1;const l=e.pbrMetallicRoughness;void 0===l&&n.log(n.LogLevel.Warning,"Model contains a material without PBR information");const u=l.baseColorTexture;void 0!==u&&(s.baseColorTexture=this.getTexture(u.index),s.baseColorTexCoord=u.texCoord||0);const d=l.metallicRoughnessTexture;void 0!==d&&(s.metallicRoughnessTexture=this.getTexture(d.index),s.metallicRoughnessTexCoord=d.texCoord||0),s.baseColorFactor=i.vec4.fromValues(1,1,1,1),void 0!==l.baseColorFactor&&(s.baseColorFactor=i.vec4.fromValues.apply(void 0,l.baseColorFactor)),s.metallicFactor=1,void 0!==l.metallicFactor&&(s.metallicFactor=l.metallicFactor),s.roughnessFactor=1,void 0!==l.roughnessFactor&&(s.roughnessFactor=l.roughnessFactor),this._resourceManager.add(s,[e.name,t]),r++}}inferBufferUsage(e,t){const r=this._context.gl,i=e.gltf.meshes,s=e.gltf.accessors;if(void 0===i||void 0===s)return n.log(n.LogLevel.Error,"Asset does not include any meshes or accessors"),r.ARRAY_BUFFER;for(const e of i)for(const i of e.primitives){const e=i.indices;if(void 0===e)continue;const n=s[e].bufferView;if(void 0!==n&&n===t)return r.ELEMENT_ARRAY_BUFFER}return r.ARRAY_BUFFER}async loadBuffers(e){const t=this._context.gl,r=e.gltf.bufferViews,i=e.gltf.accessors;if(!r)return void n.log(n.LogLevel.Warning,"The asset does not include any buffer view information.");if(!i)return void n.log(n.LogLevel.Warning,"The asset does not include any accessor information.");let s=0;for(const i of r){const r=this._sceneName+"_bufferView_"+s,n=await e.bufferViewData(s);let a=i.target;void 0===a&&(a=this.inferBufferUsage(e,s));const o=new l.Buffer(this._context,r);o.initialize(a),o.data(n,t.STATIC_DRAW),this._resourceManager.add(o,[r]),s++}let a=0;for(const r of i){const i=r.bufferView,n=r.sparse;if(void 0===i||void 0!==n){const r=this._sceneName+"_accessor_"+a,i=new l.Buffer(this._context,r),n=await e.accessorData(a);i.initialize(t.ARRAY_BUFFER),i.data(n,t.STATIC_DRAW),this._resourceManager.add(i,[r])}a++}}async loadMeshes(e){this._meshes=new Array,this._nameMeshMap=new Map;const t=e.gltf.meshes;if(void 0===t)return n.log(n.LogLevel.Warning,"The asset does not contain any mesh information"),this._meshes;let r=0;for(const i of t){const t=new o.GLTFMesh(i.name);for(const n of i.primitives){const i=await this.loadPrimitive(e,n,r);void 0!==i&&t.addPrimitive(i),r++}i.name&&this._nameMeshMap.set(i.name,t),this._meshes.push(t)}return this._meshes}async loadPrimitive(e,t,r){const i=this._context.gl,o=e.gltf.accessors,l=e.gltf.bufferViews;if(void 0===o)return void n.log(n.LogLevel.Error,"GLTF asset does not have any accessors.");if(void 0===l)return void n.log(n.LogLevel.Error,"GLTF asset does not have any buffer views.");let u=t.mode;const d=this._sceneName+"_primitive_"+r;u||(u=4);const _=a.GLTFHelper.modeToEnum(i,u),f=new Array;let p=this._pbrDefaultMaterial;if(void 0!==t.material){const e=this._sceneName+"_material_"+t.material,r=this._resourceManager.get(e);void 0!==r?p=r:n.log(n.LogLevel.Warning,`Material ${e} could not be found.`)}let m,v=0;for(const e in t.attributes){const r=a.GLTFHelper.nameToAttributeIndex(e);"NORMAL"===e&&(v|=c.GLTFShaderFlags.HAS_NORMALS),"TANGENT"===e&&(v|=c.GLTFShaderFlags.HAS_TANGENTS),"COLOR_0"===e&&(v|=c.GLTFShaderFlags.HAS_COLORS),"TEXCOORD_0"!==e&&"TEXCOORD_1"!==e&&"TEXCOORD_2"!==e||(v|=c.GLTFShaderFlags.HAS_UV);const i=t.attributes[e],n=o[i],u=n.bufferView,d=n.sparse;let _,p=0;if(void 0===u||void 0!==d){const e=this._sceneName+"_accessor_"+i;_=this._resourceManager.get(e)}else{const e=l[u],t=this._sceneName+"_bufferView_"+u;_=this._resourceManager.get(t),p=e.byteStride||0}const m=new h.VertexBinding;m.buffer=_,m.attributeIndex=r,m.numVertices=n.count,m.normalized=n.normalized||!1,m.size=s.GLTF_ELEMENTS_PER_TYPE[n.type],m.offset=n.byteOffset||0,m.stride=p,m.type=n.componentType,f.push(m)}if(void 0!==t.indices){const e=o[t.indices],r=e.bufferView;void 0===!r&&n.log(n.LogLevel.Error,"Accessor does not reference a BufferView.");const i=this._sceneName+"_bufferView_"+r,s=this._resourceManager.get(i);m=new h.IndexBinding,m.buffer=s,m.numIndices=e.count,m.offset=e.byteOffset||0,m.type=e.componentType}const g=new h.GLTFPrimitive(this._context,f,m,_,p,v);return g.initialize(),this._resourceManager.add(g,[d]),g}async generateScenes(e){const t=e.gltf.nodes,r=e.gltf.scenes;if(!t||!r)return void n.log(n.LogLevel.Warning,"The asset does not contain any nodes or scene information.");const s=new Map;let a=0;for(const e of t){const t=e.name||"node_"+a,r=new f.SceneNode(t);if(s.set(a,r),e.matrix){const t=i.mat4.fromValues.apply(void 0,e.matrix),n=new _.TransformComponent(t);r.addComponent(n)}else if(e.translation||e.rotation||e.scale){let t=i.quat.create();e.rotation&&(t=i.quat.fromValues.apply(void 0,e.rotation));let n=i.vec3.create();e.translation&&(n=i.vec3.fromValues.apply(void 0,e.translation));let s=i.vec3.fromValues(1,1,1);e.scale&&(s=i.vec3.fromValues.apply(void 0,e.scale));const a=i.mat4.fromRotationTranslationScale(i.mat4.create(),t,n,s),o=new _.TransformComponent(a);r.addComponent(o)}if(void 0!==e.mesh){const t=this._meshes[e.mesh];for(const e of t.primitives){const t=new _.GeometryComponent;t.material=e.material,t.geometry=e,r.addComponent(t)}}(e.skin||e.weights)&&n.log(n.LogLevel.Info,"Imported GLTF assets uses skins, which are not supported yet."),a++}a=0;for(const e of t){const t=s.get(a);if(n.assert(void 0!==t,"Scene node could not be found."),e.children)for(const r of e.children){const e=s.get(r);e||n.log(n.LogLevel.Error,"Model references a node that does not exist."),t.addNode(e)}a++}let o=0;for(const e of r){const t=e.name||"scene_"+o,r=new f.SceneNode(t);if(e.nodes)for(const t of e.nodes){const e=s.get(t);e||n.log(n.LogLevel.Error,"Scene references a node that does not exist."),r.addNode(e)}else n.log(n.LogLevel.Warning,`Scene ${t} does not contain any nodes.`);this._scenes.push(r),o++}const c=e.gltf.scene;void 0!==c&&(this._defaultScene=this._scenes[c])}async loadAsset(e){const t=new s.GltfLoader,r=await t.load(e),i=r.gltf;this._sceneName="scene",i.scenes&&i.scene&&i.scenes[i.scene].name&&(this._sceneName=i.scenes[i.scene].name),await this.loadTextures(r).then((()=>this.loadMaterials(r))).then((()=>this.loadBuffers(r))).then((()=>this.loadMeshes(r))).then((()=>this.generateScenes(r)))}uninitialize(){this._scenes=[],this._defaultScene=void 0,this._resourceManager.uninitialize()}getMeshByName(e){return this._nameMeshMap.get(e)}get meshes(){return this._meshes}get uriTextureMap(){return this._uriTextureMap}get pbrProgram(){return this._pbrProgram}get scenes(){return this._scenes}get defaultScene(){return void 0!==this._defaultScene?this._defaultScene:void 0!==this._scenes&&this._scenes.length>0?this._scenes[0]:(n.log(n.LogLevel.Warning,"Default scene was requested, but none is available."),new f.SceneNode("EmptyScene"))}}},858:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=void 0,t.GLTFMesh=class{constructor(e){this._name=e,this._primitives=new Array}get primitives(){return this._primitives}addPrimitive(e){this._primitives.push(e)}}},7964:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFShaderFlags=void 0;const i=r(3659),n=r(9922);var s,a;!function(e){e[e.HAS_NORMALS=1]="HAS_NORMALS",e[e.HAS_TANGENTS=2]="HAS_TANGENTS",e[e.HAS_UV=4]="HAS_UV",e[e.HAS_COLORS=8]="HAS_COLORS",e[e.USE_IBL=16]="USE_IBL",e[e.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",e[e.HAS_NORMALMAP=64]="HAS_NORMALMAP",e[e.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",e[e.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",e[e.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",e[e.USE_TEX_LOD=1024]="USE_TEX_LOD"}(s=t.GLTFShaderFlags||(t.GLTFShaderFlags={})),function(e){e[e.OPAQUE=0]="OPAQUE",e[e.MASK=1]="MASK",e[e.BLEND=2]="BLEND"}(a=t.GLTFAlphaMode||(t.GLTFAlphaMode={}));class o extends n.Material{constructor(e,t){super(e,t),this.baseColorTexCoord=0,this.metallicRoughnessTexCoord=0,this.normalTexCoord=0,this.occlusionTexCoord=0,this.emissiveTexCoord=0,this._alphaMode=a.OPAQUE,this._alphaCutoff=1,this._baseColorFactor=i.vec4.fromValues(1,1,1,1),this._metallicFactor=1,this._roughnessFactor=1,this._emissiveFactor=i.vec3.fromValues(0,0,0),this._isDoubleSided=!1,this._normalScale=1}set baseColorTexture(e){this._baseColorTexture=e}get baseColorTexture(){return this._baseColorTexture}set metallicRoughnessTexture(e){this._metallicRoughnessTexture=e}get metallicRoughnessTexture(){return this._metallicRoughnessTexture}set normalTexture(e){this._normalTexture=e}get normalTexture(){return this._normalTexture}set occlusionTexture(e){this._occlusionTexture=e}get occlusionTexture(){return this._occlusionTexture}set emissiveTexture(e){this._emissiveTexture=e}get emissiveTexture(){return this._emissiveTexture}set emissiveFactor(e){this._emissiveFactor=e}get emissiveFactor(){return this._emissiveFactor}set baseColorFactor(e){this._baseColorFactor=e}get baseColorFactor(){return this._baseColorFactor}set metallicFactor(e){this._metallicFactor=e}get metallicFactor(){return this._metallicFactor}set roughnessFactor(e){this._roughnessFactor=e}get roughnessFactor(){return this._roughnessFactor}get normalScale(){return this._normalScale}set normalScale(e){this._normalScale=e}set isDoubleSided(e){this._isDoubleSided=e}get isDoubleSided(){return this._isDoubleSided}set alphaMode(e){this._alphaMode=e}get alphaMode(){return this._alphaMode}set alphaCutoff(e){this._alphaCutoff=e}get alphaCutoff(){return this._alphaCutoff}get flags(){let e=0;return void 0!==this.baseColorTexture&&(e|=s.HAS_BASECOLORMAP),void 0!==this.metallicRoughnessTexture&&(e|=s.HAS_METALROUGHNESSMAP),void 0!==this.normalTexture&&(e|=s.HAS_NORMALMAP),void 0!==this.occlusionTexture&&(e|=s.HAS_OCCLUSIONMAP),void 0!==this.emissiveTexture&&(e|=s.HAS_EMISSIVEMAP),e}}t.GLTFPbrMaterial=o},4303:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFPrimitive=t.VertexBinding=t.IndexBinding=void 0;const i=r(4894),n=r(8269);t.IndexBinding=class{},t.VertexBinding=class{};class s extends i.Geometry{constructor(e,t,r,i,n,s,a){super(e,a),this._bindings=t,this._indexBinding=r,this._material=n,this._geometryFlags=s,this._drawMode=i}bindBuffers(){this._indexBinding&&this._indexBinding.buffer.bind();for(const e of this._bindings)e.buffer.attribEnable(e.attributeIndex,e.size,e.type,e.normalized,e.stride,e.offset,!0,!0)}unbindBuffers(){this._indexBinding&&this._indexBinding.buffer.unbind();for(const e of this._bindings)e.buffer.attribDisable(e.attributeIndex,!0,!0)}draw(){const e=this.context.gl;this._indexBinding?e.drawElements(this._drawMode,this._indexBinding.numIndices,this._indexBinding.type,this._indexBinding.offset):e.drawArrays(this._drawMode,0,this._bindings[0].numVertices)}get drawMode(){return this._drawMode}get material(){return this._material}get flags(){return this._geometryFlags}get indexBufferInformation(){return this._indexBinding}getVertexBufferInformationFromAttribute(e){const t=n.GLTFHelper.nameToAttributeIndex(e);for(const e of this._bindings)if(e.attributeIndex===t)return e}}t.GLTFPrimitive=s},3733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLTFMesh=t.GLTFPrimitive=t.GLTFShaderFlags=t.GLTFPbrMaterial=t.GLTFAlphaMode=t.GLTFLoader=void 0;var i=r(5500);Object.defineProperty(t,"GLTFLoader",{enumerable:!0,get:function(){return i.GLTFLoader}});var n=r(7964);Object.defineProperty(t,"GLTFAlphaMode",{enumerable:!0,get:function(){return n.GLTFAlphaMode}}),Object.defineProperty(t,"GLTFPbrMaterial",{enumerable:!0,get:function(){return n.GLTFPbrMaterial}}),Object.defineProperty(t,"GLTFShaderFlags",{enumerable:!0,get:function(){return n.GLTFShaderFlags}});var s=r(4303);Object.defineProperty(t,"GLTFPrimitive",{enumerable:!0,get:function(){return s.GLTFPrimitive}});var a=r(858);Object.defineProperty(t,"GLTFMesh",{enumerable:!0,get:function(){return a.GLTFMesh}})},1030:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Initializable=void 0;const i=r(9696);class n{constructor(){this._initialized=!1,this.assertInitialized=()=>n.assertInitializedFalse(this),this.assertUninitialized=()=>{}}static initialize(){return(e,t,r)=>{const s=r.value;return r.value=function(){return i.assert(!1===this._initialized,"re-initialization of initialized object not anticipated"),this._initialized=s.apply(this,arguments),this._initialized?(this.assertInitialized=()=>{},this.assertUninitialized=()=>n.assertUninitializedFalse(this)):(this.assertUninitialized=()=>{},this.assertInitialized=()=>n.assertInitializedFalse(this)),this._initialized},r}}static uninitialize(){return(e,t,r)=>{const s=r.value;return r.value=function(){i.assert(!0===this._initialized,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>n.assertInitializedFalse(this)},r}}static discard(){return(e,t,r)=>{const s=r.value;return r.value=function(){i.assert(!0===this._initialized,"expected object to be initialized in order to uninitialize"),s.apply(this),this._initialized=!1,this.assertUninitialized=()=>{},this.assertInitialized=()=>n.assertInitializedFalse(this)},r}}static assert_initialized(){return(e,t,r)=>{const i=r.value;return r.value=function(){return this.assertInitialized(),i.apply(this,arguments)},r}}static assert_uninitialized(){return(e,t,r)=>{const i=r.value;return r.value=function(){this.assertUninitialized(),i.apply(this,arguments)},r}}get initialized(){return this._initialized}}t.Initializable=n,n.assertInitializedFalse=e=>i.assert(!1,`instance of ${e.constructor.name} expected to be initialized`),n.assertUninitializedFalse=e=>i.assert(!1,`instance of ${e.constructor.name} not expected to be initialized`)},4563:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KernelI8=t.KernelUI8=t.KernelI32=t.KernelUI32=t.KernelF32=t.AbstractKernel=void 0;const i=r(9696);class n{constructor(e,t,r=1,i=1){this._components=e,this._width=isNaN(t)?1:Math.max(1,t),this._height=Math.max(1,r),this._depth=Math.max(1,i),this.resize()}get(e,t,r){let n;switch(n=void 0===t&&void 0===r?this._components*e:this.index(e,t,r||0),i.assert(n<this.length,`index expected to be in range [0, ${this.length-1}], given ${n}`),this._components){case 1:return[this._samples[n]];case 2:return[this._samples[n],this._samples[n+1]];case 3:return[this._samples[n],this._samples[n+1],this._samples[n+2]];case 4:return[this._samples[n],this._samples[n+1],this._samples[n+2],this._samples[n+3]]}}set(e,t,r,n){let s;switch(i.assert(e.length===this._components,`number of components expected to be ${this._components}, given ${e.length}`),s=void 0===r&&void 0===n?this._components*Math.min(this.elements,Math.max(0,t)):this._components*this.index(t,r,n||0),i.assert(s<this.length,`index expected to be in range [0, ${this.length-1}], given ${s}`),this._components){case 4:this._samples[s+3]=e[3];case 3:this._samples[s+2]=e[2];case 2:this._samples[s+1]=e[1];case 1:this._samples[s+0]=e[0]}}fromJSON(e){i.assert(e.size&&void 0!==e.size.width&&void 0!==e.size.height&&void 0!==e.size.depth,`expected kernel width, height, and depth to be set, given '${e.size}'`);const t=e=>e.reduce(((e,r)=>e.concat(Array.isArray(r)?t(r):r)),[]);this._width=Math.max(1,e.size.width),this._height=Math.max(1,e.size.height),this._depth=Math.max(1,e.size.depth);const r=t(e.kernel);this._components=Math.floor(r.length/this.elements),this.resize(),this.fromArray(r)}index(e,t=0,r=0){return this._width*(this._height*Math.min(this._depth,Math.max(0,r))+Math.min(this._height,Math.max(0,t)))+Math.min(this._width,Math.max(0,e))}position(e){let t=Math.min(this.elements,Math.max(0,e));const r=Math.floor(t/(this._width*this._height));t-=r*this._width*this._height;const i=Math.floor(t/this._width);return t-=i*this._width,[t,i,r]}sort(e){if(this.elements<2)return;const t=Array(this.elements);for(let e=0;e<this.elements;++e){let r=0;n.SortApproach.BySquaredLength;for(let t=0;t<this._components;++t){const i=this._samples[e*this._components+t];r+=i*i}t[e]=[e,r]}n.SortApproach.BySquaredLength,t.sort(((e,t)=>e[1]-t[1]));const r=this._samples.slice();for(let e=0;e<t.length;++e)for(let i=0;i<this._components;++i){const n=t[e][0]*this._components+i,s=e*this._components+i;this._samples[s]=r[n]}}get samples(){return this._samples}get length(){return this._width*this._height*this._depth*this._components}get elements(){const e=this._width*this._height*this._depth;return isNaN(e)?0:e}get components(){return this._components}get width(){return this._width}get height(){return this._height}get depth(){return this._depth}get xStride(){return this.bytesPerComponent*this._components}get yStride(){return this.bytesPerComponent*this._components*this._width}get zStride(){return this.bytesPerComponent*this._components*this._width*this._depth}get bytesLength(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth}}t.AbstractKernel=n,function(e){let t;!function(e){e[e.BySquaredLength=0]="BySquaredLength"}(t=e.SortApproach||(e.SortApproach={}))}(n=t.AbstractKernel||(t.AbstractKernel={})),t.KernelF32=class extends n{resize(){this._samples=new Float32Array(this.length)}fromArray(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(e))}get bytesPerComponent(){return 4}},t.KernelUI32=class extends n{resize(){this._samples=new Uint32Array(this.length)}fromArray(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(e))}get bytesPerComponent(){return 4}},t.KernelI32=class extends n{resize(){this._samples=new Int32Array(this.length)}fromArray(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(e))}get bytesPerComponent(){return 4}},t.KernelUI8=class extends n{resize(){this._samples=new Uint8Array(this.length)}fromArray(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(e))}get bytesPerComponent(){return 4}},t.KernelI8=class extends n{resize(){this._samples=new Int8Array(this.length)}fromArray(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(e))}get bytesPerComponent(){return 4}}},3668:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardEventType=t.KeyboardEventProvider=void 0;const i=r(9130),n=r(9696);var s;t.KeyboardEventProvider=class{constructor(e,t){n.assert(void 0!==e,`expected valid canvas element on initialization, given ${e}`),this._element=e,this._timeframe=t}preventDefaultOnEvent(e,t){n.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()}preventDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)||(this._preventDefaultMask|=t)}allowDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)&&(this._preventDefaultMask&=~t)}observable(e){switch(e){case s.KeyDown:return this.keyDown$;case s.KeyPress:return this.keyPress$;case s.KeyUp:return this.keyUp$;default:return}}get keyDown$(){return void 0===this._keyDownSubject&&(this._keyDownSubject=new i.ReplaySubject(void 0,this._timeframe),this._keyDownListener=e=>{this.preventDefaultOnEvent(s.KeyDown,e),this._keyDownSubject.next(e)},this._element.addEventListener("keydown",this._keyDownListener)),this._keyDownSubject.asObservable()}get keyPress$(){return void 0===this._keyPressSubject&&(this._keyPressSubject=new i.ReplaySubject(void 0,this._timeframe),this._keyPressListener=e=>{this.preventDefaultOnEvent(s.KeyPress,e),this._keyPressSubject.next(e)},this._element.addEventListener("keypress",this._keyPressListener)),this._keyPressSubject.asObservable()}get keyUp$(){return void 0===this._keyUpSubject&&(this._keyUpSubject=new i.ReplaySubject(void 0,this._timeframe),this._keyUpListener=e=>{this.preventDefaultOnEvent(s.KeyUp,e),this._keyUpSubject.next(e)},this._element.addEventListener("keyup",this._keyUpListener)),this._keyUpSubject.asObservable()}},function(e){e[e.KeyDown=1]="KeyDown",e[e.KeyPress=2]="KeyPress",e[e.KeyUp=4]="KeyUp"}(s=t.KeyboardEventType||(t.KeyboardEventType={}))},4841:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MouseEventProvider=void 0;const i=r(9130),n=r(9696),s=r(6157),a=r(9258);class o{constructor(e,t){this._pointerLockRequestPending=!1,n.assert(void 0!==e,`expected valid canvas element on initialization, given ${e}`),this._element=e,this._timeframe=t,this._element.addEventListener("click",(()=>this.processPointerLockRequests())),(s.IS_EDGE||s.IS_IE11)&&this._element.addEventListener("dragstart",(e=>e.preventDefault()))}processPointerLockRequests(){this._pointerLockRequestPending&&a.PointerLock.request(this._element)}preventDefaultOnEvent(e,t){n.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()}preventDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)||(this._preventDefaultMask|=t)}allowDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)&&(this._preventDefaultMask&=~t)}observable(e){switch(e){case o.Type.Click:return this.click$;case o.Type.Enter:return this.enter$;case o.Type.Leave:return this.leave$;case o.Type.Down:return this.down$;case o.Type.Up:return this.up$;case o.Type.Move:return this.move$;case o.Type.Wheel:return this.wheel$;case o.Type.Drag:return this.drag$;default:return}}set pointerLock(e){this._pointerLockRequestPending=e,!1===e&&(this._pointerLockRequestPending=!1,a.PointerLock.exit())}get pointerLock(){return a.PointerLock.active(this._element)}get click$(){return void 0===this._clickSubject&&(this._clickSubject=new i.ReplaySubject(void 0,this._timeframe),this._clickListener=e=>{this.preventDefaultOnEvent(o.Type.Click,e),this._clickSubject.next(e)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()}get enter$(){return void 0===this._enterSubject&&(this._enterSubject=new i.ReplaySubject(void 0,this._timeframe),this._enterListener=e=>{this.preventDefaultOnEvent(o.Type.Enter,e),this._enterSubject.next(e)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return void 0===this._leaveSubject&&(this._leaveSubject=new i.ReplaySubject(void 0,this._timeframe),this._leaveListener=e=>{this.preventDefaultOnEvent(o.Type.Leave,e),this._leaveSubject.next(e)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return void 0===this._downSubject&&(this._downSubject=new i.ReplaySubject(void 0,this._timeframe),this._downListener=e=>{this.preventDefaultOnEvent(o.Type.Down,e),this._downSubject.next(e)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()}get up$(){return void 0===this._upSubject&&(this._upSubject=new i.ReplaySubject(void 0,this._timeframe),this._upListener=e=>{this.preventDefaultOnEvent(o.Type.Up,e),this._upSubject.next(e)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()}get move$(){return void 0===this._moveSubject&&(this._moveSubject=new i.ReplaySubject(void 0,this._timeframe),this._moveListener=e=>{this.preventDefaultOnEvent(o.Type.Move,e),this._moveSubject.next(e)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()}get wheel$(){return void 0===this._wheelSubject&&(this._wheelSubject=new i.ReplaySubject(void 0,this._timeframe),this._wheelListener=e=>{this.preventDefaultOnEvent(o.Type.Wheel,e),this._wheelSubject.next(e)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()}get drag$(){return void 0===this._dragSubject&&(this._dragSubject=new i.ReplaySubject(void 0,this._timeframe),this._dragListener=e=>{this.preventDefaultOnEvent(o.Type.Drag,e),this._dragSubject.next(e)},this._element.addEventListener("drag",this._dragListener)),this._dragSubject.asObservable()}}t.MouseEventProvider=o,function(e){let t;!function(e){e[e.Click=1]="Click",e[e.Wheel=2]="Wheel",e[e.Enter=4]="Enter",e[e.Leave=8]="Leave",e[e.Move=16]="Move",e[e.Down=32]="Down",e[e.Up=64]="Up",e[e.Drag=128]="Drag"}(t=e.Type||(e.Type={}))}(o=t.MouseEventProvider||(t.MouseEventProvider={}))},6157:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IS_EDGE=t.IS_IE11=void 0,t.IS_IE11="undefined"==typeof navigator?void 0:/MSIE 11|Windows/i.test(navigator.userAgent),t.IS_EDGE="undefined"==typeof navigator?void 0:/Edge\/\d./i.test(navigator.userAgent)},8652:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Navigation=void 0;const i=r(3659),n=r(7595),s=r(9258),a=r(9696),o=r(9870),c=r(8287),h=r(8357),l=r(2763),u=r(2783),d=r(9817);class _{constructor(e,t){this._alwaysRotateOnMove=!1,this._invalidate=e,this._eventHandler=new n.EventHandler(e,t),this._eventHandler.pushPointerDownHandler(((e,t)=>this.onPointerDown(e,t))),this._eventHandler.pushPointerUpHandler(((e,t)=>this.onPointerUp(e,t))),this._eventHandler.pushPointerEnterHandler(((e,t)=>this.onPointerEnter(e,t))),this._eventHandler.pushPointerLeaveHandler(((e,t)=>this.onPointerLeave(e,t))),this._eventHandler.pushPointerMoveHandler(((e,t)=>this.onPointerMove(e,t))),this._eventHandler.pushPointerCancelHandler(((e,t)=>this.onPointerCancel(e,t))),this._eventHandler.pushMouseWheelHandler(((e,t)=>this.onWheel(e,t))),this.rotationMetaphor=_.RotationMetaphor.Turntable,this._pan=new c.PanModifier,this._pinch=new h.PinchZoomModifier,this._wheelZoom=new d.WheelZoomModifier,this._activeEvents=new Map}mode(){const e=Array.from(this._activeEvents.values()),t=this.getPrimaryEvent(e);if(void 0===t)return void a.log(a.LogLevel.Warning,"No primary pointer event detected in Navigation::mode.");const r="mouse"===t.pointerType,i="touch"===t.pointerType||"pen"===t.pointerType,n=1&t.buttons,o=t.shiftKey,c=s.PointerLock.active()&&this._alwaysRotateOnMove,h=this._activeEvents.size,l=r&&n&&1===h,u=i&&1===h,d=r&&n&&o&&1===h,f=i&&2===h;return c?_.Modes.Rotate:d?_.Modes.Pan:f?_.Modes.MultiTouch:l||u?_.Modes.Rotate:void 0}resolveMultiTouch(){if(this._activeEvents.size<2)return void a.log(a.LogLevel.Warning,"MultiTouch resolution was canceled because less than two touches were detected.");const e=Array.from(this._activeEvents.values()),t=i.vec2.fromValues(e[0].movementX,e[0].movementY),r=i.vec2.fromValues(e[1].movementX,e[1].movementY);return 0===i.vec2.length(t)||0===i.vec2.length(r)?_.Modes.Zoom:(i.vec2.normalize(t,t),i.vec2.normalize(r,r),i.vec2.dot(t,r)>.2?_.Modes.Pan:_.Modes.Zoom)}rotate(e){if(1!==this._activeEvents.size)return void a.log(a.LogLevel.Info,"Rotate event was canceled because less or more than two pointers were detected.");const t=Array.from(this._activeEvents.values()),r=this._eventHandler.offsets(t[0])[0];switch(this._rotationMetaphor){case _.RotationMetaphor.FirstPerson:const t=this._firstPerson;let n;s.PointerLock.active()&&event instanceof MouseEvent&&(n=i.vec2.fromValues(event.movementX,event.movementY)),e?t.initiate(r):t.process(r,n);break;case _.RotationMetaphor.Trackball:const a=this._trackball;e?a.initiate(r):a.process(r);break;case _.RotationMetaphor.Turntable:const o=this._turntable;e?o.initiate(r):o.process(r)}}pan(e){const t=Array.from(this._activeEvents.values()),r=this.getPrimaryEvent(t);if(void 0===r)return void a.log(a.LogLevel.Warning,"Pan event was canceled because no primary event was detected.");const i=this._eventHandler.offsets(r)[0],n=this._pan;e?n.initiate(i):n.process(i)}pinch(e){if(2!==this._activeEvents.size)return void a.log(a.LogLevel.Info,"Pinch event was canceled because less or more than two pointers were detected.");const t=Array.from(this._activeEvents.values()),r=this._eventHandler.offsets(t[0])[0],i=this._eventHandler.offsets(t[1])[0],n=this._pinch;e?n.initiate(r,i):n.process(r,i)}getPrimaryEvent(e){for(const t of e)if(t.isPrimary)return t}onPointerDown(e,t){for(const t of e)this._activeEvents.set(t.pointerId,t);switch(this._mode=this.mode(),this._mode){case _.Modes.Rotate:this.rotate(!0);break;case _.Modes.Pan:this.pan(!0);break;case _.Modes.Zoom:this.pinch(!0)}}onPointerUp(e,t){for(const t of e)this._activeEvents.delete(t.pointerId)}onPointerEnter(e,t){}onPointerLeave(e,t){for(const t of e)this._activeEvents.delete(t.pointerId)}onPointerCancel(e,t){for(const t of e)this._activeEvents.delete(t.pointerId)}onPointerMove(e,t){for(const t of e)this._activeEvents.set(t.pointerId,t);if(void 0===this._mode)return;const r=Array.from(this._activeEvents.values()),i=this.getPrimaryEvent(r);i&&"mouse"===i.pointerType&&(this._mode=this.mode());let n=!1;switch(this._mode===_.Modes.MultiTouch&&(this._mode=this.resolveMultiTouch(),n=!0),this._mode){case _.Modes.Rotate:this.rotate(n);break;case _.Modes.Pan:this.pan(n);break;case _.Modes.Zoom:this.pinch(n)}this._lastInteractionTime=performance.now()}onWheel(e,t){const r=e[0];this._wheelZoom.process(r.deltaY)}update(){this._eventHandler.update()}set camera(e){this._camera=e,this._firstPerson&&(this._firstPerson.camera=e),this._trackball&&(this._trackball.camera=e),this._turntable&&(this._turntable.camera=e),this._pan&&(this._pan.camera=e),this._pinch&&(this._pinch.camera=e),this._wheelZoom&&(this._wheelZoom.camera=e)}set rotationMetaphor(e){if(this._rotationMetaphor!==e){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._rotationMetaphor=e,this._rotationMetaphor){case _.RotationMetaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new o.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case _.RotationMetaphor.Trackball:this._trackball=new l.TrackballModifier,this._trackball.camera=this._camera;break;case _.RotationMetaphor.Turntable:this._turntable=new u.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}}get rotationMetaphor(){return this._rotationMetaphor}}t.Navigation=_,function(e){let t,r;!function(e){e[e.Move=0]="Move",e[e.Pan=1]="Pan",e[e.MultiTouch=2]="MultiTouch",e[e.Rotate=3]="Rotate",e[e.Zoom=4]="Zoom",e[e.ZoomStep=5]="ZoomStep"}(t=e.Modes||(e.Modes={})),function(e){e.FirstPerson="firstperson",e.Flight="flight",e.Trackball="trackball",e.Turntable="turntable"}(r=e.RotationMetaphor||(e.RotationMetaphor={}))}(_=t.Navigation||(t.Navigation={}))},7429:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingRectangle=void 0;const n=r(6404),s=r(4894),a=r(1030);class o extends s.Geometry{constructor(e,t){super(e,t),t=void 0!==t&&""!==t?t:this.constructor.name;const r=new n.Buffer(e,`${t}VBO`);this._buffers.push(r)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(e=0){this._vertexLocation=e;const t=this.context.gl,r=super.initialize([t.ARRAY_BUFFER]);return this._buffers[0].data(o.VERTICES,t.STATIC_DRAW),r}draw(){const e=this.context.gl;e.drawArrays(e.TRIANGLE_STRIP,0,4)}get vertexLocation(){return this._vertexLocation}}o.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),i([a.Initializable.assert_initialized()],o.prototype,"draw",null),t.NdcFillingRectangle=o},7570:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.NdcFillingTriangle=void 0;const n=r(6404),s=r(4894),a=r(1030);class o extends s.Geometry{constructor(e,t){super(e,t),t=void 0!==t&&""!==t?t:this.constructor.name;const r=new n.Buffer(e,`${t}VBO`);this._buffers.push(r)}bindBuffers(){this._buffers[0].attribEnable(this._vertexLocation,2,this.context.gl.FLOAT,!1,0,0,!0,!1)}unbindBuffers(){this._buffers[0].attribDisable(this._vertexLocation,!0,!0)}initialize(e=0){this._vertexLocation=e;const t=this.context.gl,r=super.initialize([t.ARRAY_BUFFER]);return this._buffers[0].data(o.VERTICES,t.STATIC_DRAW),r}draw(){const e=this.context.gl;e.drawArrays(e.TRIANGLES,0,3)}get vertexLocation(){return this._vertexLocation}}o.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),i([a.Initializable.assert_initialized()],o.prototype,"draw",null),t.NdcFillingTriangle=o},2281:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractObject=void 0;const n=r(9696),s=r(1030);class a extends s.Initializable{constructor(e,t){super(),this._valid=!1,this._referenceCount=0,this._context=e,this._identifier=void 0!==t&&""!==t?t:"Object"}initialize(...e){return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create(...e),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),n.log(n.LogLevel.Error,`initialization of '${this._identifier}' failed`)),this._valid}uninitialize(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),n.assert(void 0===this._object,`expected object '${this._identifier}' to be undefined after delete`),n.assert(!1===this._valid,`expected object '${this._identifier}' to be invalid after delete`)}get context(){return this._context}get identifier(){return this._identifier}get object(){return n.assert(void 0!==this._object,"access to undefined object"),this._object}get valid(){return this._valid}ref(){n.assert(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount}unref(){n.assert(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount}}i([s.Initializable.initialize()],a.prototype,"initialize",null),i([s.Initializable.uninitialize()],a.prototype,"uninitialize",null),t.AbstractObject=a},8287:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PanModifier=void 0;const i=r(3659),n=r(2111),s=r(6491);class a extends s.CameraModifier{constructor(){super(...arguments),this._sensitivity=a.DEFAULT_SENSITIVITY,this._translation=n.v3()}initiate(e){Object.assign(this._reference,this._camera),this._initialPoint=e}process(e){this._currentPoint=e;const t=i.vec2.subtract(n.v2(),this._initialPoint,this._currentPoint);i.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity);const r=i.vec3.sub(n.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(r,r);const s=this._reference.up;i.vec3.normalize(s,s);const a=i.vec3.cross(n.v3(),s,r),o=i.vec3.scale(n.v3(),a,t[0]),c=i.vec3.scale(n.v3(),s,t[1]);i.vec3.negate(c,c),this._translation=i.vec3.add(n.v3(),c,o),this.update()}update(){if(void 0===this._camera)return;const e=i.mat4.fromTranslation(n.m4(),this._translation),t=i.vec3.transformMat4(n.v3(),this._reference.eye,e),r=i.vec3.transformMat4(n.v3(),this._reference.center,e);this._camera.eye=t,this._camera.center=r}}t.PanModifier=a,a.DEFAULT_SENSITIVITY=.002},8357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PinchZoomModifier=void 0;const i=r(3659),n=r(2111),s=r(6491);class a extends s.CameraModifier{constructor(){super(...arguments),this._sensitivity=a.DEFAULT_SENSITIVITY,this._translation=n.v3()}initiate(e,t){Object.assign(this._reference,this._camera);const r=i.vec2.subtract(n.v2(),e,t);this._initialDistance=i.vec2.length(r)}process(e,t){const r=i.vec2.subtract(n.v2(),e,t);this._currentDistance=i.vec2.length(r);const s=(this._currentDistance/this._initialDistance-1)*a.DEFAULT_SENSITIVITY,o=i.vec3.sub(n.v3(),this._reference.center,this._reference.eye);i.vec3.normalize(o,o),this._translation=i.vec3.scale(n.v3(),o,s),this.update()}update(){if(void 0===this._camera)return;const e=i.mat4.fromTranslation(n.m4(),this._translation),t=i.vec3.transformMat4(n.v3(),this._reference.eye,e);this._camera.eye=t}}t.PinchZoomModifier=a,a.DEFAULT_SENSITIVITY=2},8319:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointerEventProvider=void 0;const i=r(9130),n=r(9696),s=r(6157),a=r(9258);class o{constructor(e,t){this._pointerLockRequestPending=!1,n.assert(void 0!==e,`expected valid canvas element on initialization, given ${e}`),this._element=e,this._timeframe=t,this._element.addEventListener("click",(()=>this.processPointerLockRequests())),(s.IS_EDGE||s.IS_IE11)&&this._element.addEventListener("dragstart",(e=>e.preventDefault()))}processPointerLockRequests(){this._pointerLockRequestPending&&a.PointerLock.request(this._element)}preventDefaultOnEvent(e,t){n.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()}preventDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)||(this._preventDefaultMask|=t)}allowDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)&&(this._preventDefaultMask&=~t)}observable(e){switch(e){case o.Type.Enter:return this.enter$;case o.Type.Leave:return this.leave$;case o.Type.Down:return this.down$;case o.Type.Up:return this.up$;case o.Type.Move:return this.move$;case o.Type.Cancel:return this.cancel$;default:return}}set pointerLock(e){this._pointerLockRequestPending=e,!1===e&&(this._pointerLockRequestPending=!1,a.PointerLock.exit())}get pointerLock(){return a.PointerLock.active(this._element)}get enter$(){return void 0===this._enterSubject&&(this._enterSubject=new i.ReplaySubject(void 0,this._timeframe),this._enterListener=e=>{this.preventDefaultOnEvent(o.Type.Enter,e),this._enterSubject.next(e)},this._element.addEventListener("pointerenter",this._enterListener)),this._enterSubject.asObservable()}get leave$(){return void 0===this._leaveSubject&&(this._leaveSubject=new i.ReplaySubject(void 0,this._timeframe),this._leaveListener=e=>{this.preventDefaultOnEvent(o.Type.Leave,e),this._leaveSubject.next(e)},this._element.addEventListener("pointerleave",this._leaveListener)),this._leaveSubject.asObservable()}get down$(){return void 0===this._downSubject&&(this._downSubject=new i.ReplaySubject(void 0,this._timeframe),this._downListener=e=>{this.preventDefaultOnEvent(o.Type.Down,e),this._downSubject.next(e)},this._element.addEventListener("pointerdown",this._downListener)),this._downSubject.asObservable()}get up$(){return void 0===this._upSubject&&(this._upSubject=new i.ReplaySubject(void 0,this._timeframe),this._upListener=e=>{this.preventDefaultOnEvent(o.Type.Up,e),this._upSubject.next(e)},this._element.addEventListener("pointerup",this._upListener)),this._upSubject.asObservable()}get move$(){return void 0===this._moveSubject&&(this._moveSubject=new i.ReplaySubject(void 0,this._timeframe),this._moveListener=e=>{this.preventDefaultOnEvent(o.Type.Move,e),this._moveSubject.next(e)},this._element.addEventListener("pointermove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return void 0===this._cancelSubject&&(this._cancelSubject=new i.ReplaySubject(void 0,this._timeframe),this._cancelListener=e=>{this.preventDefaultOnEvent(o.Type.Cancel,e),this._cancelSubject.next(e)},this._element.addEventListener("pointercancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.PointerEventProvider=o,function(e){let t;!function(e){e[e.Enter=1]="Enter",e[e.Leave=2]="Leave",e[e.Move=4]="Move",e[e.Down=8]="Down",e[e.Up=16]="Up",e[e.Cancel=32]="Cancel"}(t=e.Type||(e.Type={}))}(o=t.PointerEventProvider||(t.PointerEventProvider={}))},9258:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PointerLock=void 0;const i=r(9696);class n{static queryAndCacheAPI(){if(void 0!==n._exit)return;const e=window.document,t=[e.exitPointerLock,e.mozExitPointerLock,e.webkitExitPointerLock,void 0];let r=0;for(;r<t.length&&void 0===t[r];++r);switch(r){case 0:n._exit=()=>e.exitPointerLock(),n._request=e=>e.requestPointerLock(),n._element=()=>e.pointerLockElement;break;case 1:n._exit=()=>e.mozCancelPointerLock(),n._request=e=>e.mozRequestPointerLock(),n._element=()=>e.mozPointerLockElement;break;case 2:n._exit=()=>e.webkitExitPointerLock(),n._request=e=>e.webkitRequestPointerLock(),n._element=()=>e.webkitPointerLockElement;break;default:i.assert(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}static active(e){return void 0!==this._element&&(void 0!==e&&n._element()===e||void 0===e&&void 0!==n._element()&&null!==n._element())}static request(e,t){void 0!==e&&(n.queryAndCacheAPI(),n.active()&&n._element()!==e&&n._exit(),n.active()||n._request(e))}static exit(){n._exit&&n._exit()}}t.PointerLock=n},5254:function(){"use strict";void 0===String.prototype.repeat&&(String.prototype.repeat=function(e){if(null===this)throw new TypeError("can't convert "+this+" to object");const t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0===t.length||0===e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");let r="";for(let i=0;i<e;i++)r+=t;return r}),void 0===String.prototype.startsWith&&(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),void 0===String.prototype.endsWith&&(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),void 0===String.prototype.includes&&(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),void 0===String.prototype.trimLeft&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),void 0===String.prototype.trimRight&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),void 0===Array.prototype.forEach&&(Array.prototype.forEach=(e,t)=>{const r=this.length;for(let i=0;i<r;i++)i in this&&e.call(t,this[i],i,this)}),void 0===Array.prototype.fill&&(Array.prototype.fill=(e,t,r)=>{if(null===this)throw new TypeError("this is null or not defined");const i=Object(this),n=i.length>>>0,s=t>>0;let a=s<0?Math.max(n+s,0):Math.min(s,n);const o=void 0===r?n:r>>0,c=o<0?Math.max(n+o,0):Math.min(o,n);for(;a<c;)i[a]=e,++a;return i}),void 0===Math.log10&&(Math.log10=e=>Math.log(e)*Math.LOG10E),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Uint8Array,Int8Array,Uint32Array,Int32Array].forEach((e=>{e.prototype.slice||Object.defineProperty(e.prototype,"slice",{value:Array.prototype.slice}),e.prototype.reduce||Object.defineProperty(e.prototype,"reduce",{value:Array.prototype.reduce}),e.prototype.filter||Object.defineProperty(e.prototype,"filter",{value:Array.prototype.filter}),e.prototype.map||Object.defineProperty(e.prototype,"map",{value:Array.prototype.map}),e.prototype.indexOf||Object.defineProperty(e.prototype,"indexOf",{value:Array.prototype.indexOf})})),void 0===Object.assign&&Object.defineProperty(Object,"assign",{value(e,t){if(void 0===e&&null===e)throw new TypeError("Cannot convert undefined or null to object");const r=Object(e);for(let e=1;e<arguments.length;e++){const t=arguments[e];if(null!=t)for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e])}return r},configurable:!0,writable:!0})},4895:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;const n=r(9696),s=r(1030),a=r(2281);class o extends a.AbstractObject{constructor(){super(...arguments),this._shaders=new Array,this._linked=!1}create(e=new Array,t=!0){const r=this._context.gl;let i=0,s=0;for(const t of e)switch(t.type){case r.VERTEX_SHADER:++i;break;case r.FRAGMENT_SHADER:++s;break;default:n.assert(!1,"Unknown shader type detected.")}if(n.logIf(i<1,n.LogLevel.Error,"at least one vertex shader is expected"),n.logIf(s<1,n.LogLevel.Error,"at least one fragment shader is expected"),!(i<1||s<1))return this._object=r.createProgram(),this._valid=r.isProgram(this._object),n.assert(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),e.length>0&&this.attach(e,t),this._object}delete(){n.assert(void 0!==this._object,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1}attach(e,t=!1){n.assert(void 0!==this._object,"expected a WebGLProgram object");const r=this._context.gl;for(const t of e instanceof Array?e:[e])this._shaders.indexOf(t)>-1||(this._shaders.push(t),t.initialized?(r.attachShader(this._object,t.object),t.ref()):n.log(n.LogLevel.Error,`shader '${t.identifier}' not initialized.`));return t&&this.link(),!0}detach(e){n.assert(void 0!==this._object,"expected WebGLProgram object");const t=this._context.gl;for(const r of e instanceof Array?e:[e]){const e=this._shaders.indexOf(r);e>-1&&this._shaders.splice(e),n.assert(r.initialized,`expected shader '${r.identifier}' to be initialized`),t.detachShader(this._object,r.object),r.unref()}}link(){n.assert(void 0!==this._object,"expected WebGLProgram object");const e=this._context.gl;if(e.linkProgram(this._object),e.getProgramParameter(this._object,e.LINK_STATUS))this._linked=!0;else{const t=e.getProgramInfoLog(this._object);n.log(n.LogLevel.Error,`linking of program '${this._identifier}' failed: '${t}'`),this._linked=!1}return this._linked}bind(){this._context.gl.useProgram(this._object)}unbind(){this._context.gl.useProgram(o.DEFAULT_PROGRAM)}uniform(e){return this._context.gl.getUniformLocation(this._object,e)}attribute(e,t){return void 0!==t?(n.logIf(this._linked,n.LogLevel.Debug,`name-to-generic attribute index mapping does go into effect on next linking, given ${e} -> ${t} (${this.identifier})`),this._context.gl.bindAttribLocation(this._object,t,e),t):this._context.gl.getAttribLocation(this._object,e)}get shaders(){return this._shaders}get linked(){return this._linked}}o.DEFAULT_PROGRAM=void 0,i([s.Initializable.assert_initialized()],o.prototype,"bind",null),i([s.Initializable.assert_initialized()],o.prototype,"unbind",null),i([s.Initializable.assert_initialized()],o.prototype,"uniform",null),i([s.Initializable.assert_initialized()],o.prototype,"attribute",null),t.Program=o},3607:(e,t,r)=>{"use strict";const i=r(634),n=r(9696);function s(e,t){const r=t.properties,i=Object.getOwnPropertyNames(r);for(const t of i){const i=r[t],s="object"===i.type,a=e.hasOwnProperty(t),c=i.hasOwnProperty("properties"),h=i.hasOwnProperty("default");n.assert(c&&s||!c&&!s,`expected property '${t}' to be of type 'object', given '${i.type}'`),a&&c?o.complement(e[t],i):!a&&h&&Object.defineProperty(e,t,{value:i.default,writable:!0})}}function a(e,t){const r=t.items;if("object"===r.type)for(const t of Object.getOwnPropertyNames(e))"length"!==t&&o.complement(e[t],r)}var o;!function(e){e.validate=function(e,t,r){const s=new i.Validator;if(void 0!==r)for(const e of r)s.addSchema(e[0],e[1]);const a=s.validate(e,t);return n.logIf(!a.valid,n.LogLevel.Warning,`schema expected to be valid:\n${a.toString()}`),a.valid},e.complement=function(e,t){if(void 0!==e)switch(n.assert(t.hasOwnProperty("properties")&&"object"===t.type||t.hasOwnProperty("items")&&"array"===t.type,`expected schema to have 'properties' or 'items', given ${t}`),t.type){case"object":s(e,t);break;case"array":a(e,t)}},e.compare=function e(t,r,i,s=""){const a=void 0!==i;if(n.assert(!a||i.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),void 0===t&&void 0!==r||void 0!==t&&void 0===r)return a&&i.alter(s),!0;let o=!0,c=[typeof t,typeof r];const h=[t instanceof Array,r instanceof Array];if(!(h[0]&&h[1]||"object"===c[0]&&"object"===c[1]))return o=t===r,!o&&a&&i.alter(`${s}`),!o;const l=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(t),Object.getOwnPropertyNames(r))).values());for(const n of l){if("length"===n)continue;const l=[t[n],r[n]];c=[typeof l[0],typeof l[1]];const u=`${s}${s.length>0&&!h[0]?".":""}${h[0]?"":n}`;if(l[0]instanceof Array&&l[1]instanceof Array||"object"===c[0]&&"object"===c[1])o=o&&!e(l[0],l[1],i,u);else{if(c[0]===c[1]&&l[0]===l[1])continue;o=!1,a&&i.alter(u)}}return!o}}(o||(o={})),e.exports=o},5785:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomSquareKernel=void 0;const i=r(9696),n=r(4563);class s extends n.KernelF32{constructor(e){super(2,e),this.generate()}generate(){i.assert(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(let e=1;e<this.width;++e)this.set([i.rand(-.5,.5),i.rand(-.5,.5)],e)}get width(){return this._width}set width(e){this._width!==e&&(this._width=e,this.resize(),this.generate())}}t.RandomSquareKernel=s},3942:(e,t,r)=>{"use strict";const i=r(3659),n=r(2111),s=r(9696);var a;!function(e){function t(e,t,r=1){const s=i.vec2.subtract(n.v2(),t,e);if(i.vec2.equals(s,i.vec2.fromValues(0,0)))return;const a=i.vec2.squaredLength(s),o=2*i.vec2.dot(s,e),c=o*o-4*a*(i.vec2.squaredLength(e)-r*r);if(c<0)return;const h=Math.sqrt(c),l=Math.min((-o+h)/(2*a),(-o-h)/(2*a)),u=i.vec2.scale(n.v2(),s,l);return i.vec2.add(u,u,e)}function r(e,t,r,s){const a=e,o=i.vec2.sub(n.v2(),t,e),c=r,h=i.vec2.sub(n.v2(),s,r),l=i.vec2.cross(n.v3(),o,h)[2];if(0===l)return;const u=i.vec2.sub(n.v2(),c,a),d=i.vec2.cross(n.v3(),u,i.vec2.scale(n.v2(),o,1/l))[2],_=i.vec2.cross(n.v3(),u,i.vec2.scale(n.v2(),h,1/l))[2];return d<0||d>1||_<0?void 0:[i.vec2.add(n.v2(),c,i.vec2.scale(n.v2(),h,d)),_]}function a(e,t,r=i.vec3.fromValues(0,0,0),s=i.vec3.fromValues(0,1,0)){const a=i.vec3.normalize(n.v3(),i.vec3.subtract(n.v3(),t,e)),o=i.vec3.dot(a,s);if(i.vec3.equals(a,[0,0,0])||o>=0)return;const c=i.vec3.dot(i.vec3.subtract(n.v3(),r,e),s)/o;return i.vec3.add(n.v3(),i.vec3.scale(n.v3(),a,c),e)}function o(e,t,r){const s=i.vec3.subtract(n.v3(),t,e),a=i.vec3.squaredLength(s);if(0===a)return 0;const o=i.vec3.subtract(n.v3(),r,e);return i.vec3.dot(o,s)/a}e.rayCircleIntersection=t,e.pointSquareIntersection=function(e,t=1){const r=n.abs2(n.v2(),e);return r[0]>=r[1]?i.vec2.fromValues(n.sign(e[0])*t,e[1]/r[0]*t):i.vec2.fromValues(e[0]/r[1]*t,n.sign(e[1])*t)},e.raySquareIntersection=function(e,t,n=1){const s=[i.vec2.fromValues(-n,+n),i.vec2.fromValues(-n,-n),i.vec2.fromValues(+n,-n),i.vec2.fromValues(+n,+n)],a=new Array;for(let i=0;i<4;++i){const n=r(e,t,s[i],s[(i+1)%4]);n&&a.push(n[1])}return a},e.rayLineIntersection=r,e.rayPlaneIntersection=a,e.raySphereIntersection=function(e,t,r=i.vec3.fromValues(0,0,0),s=1){const a=i.vec3.subtract(n.v3(),e,r),o=i.vec3.normalize(n.v3(),i.vec3.subtract(n.v3(),t,e)),c=i.vec3.dot(o,a),h=c*c-i.vec3.squaredLength(a)+s*s;if(!(h<=0))return i.vec3.add(n.v3(),e,i.vec3.scale(n.v3(),o,-c-Math.sqrt(h)))},e.rayPlaneIntersection_tube=function(e,r,n=1){const s=a(e,r);if(void 0!==s&&i.vec3.length(s)<n)return s;const o=t(i.vec2.fromValues(e[0],e[2]),i.vec2.fromValues(r[0],r[2]),n);return o?i.vec3.fromValues(o[0],0,o[1]):void 0},e.isPointWithinSquare=function(e,t=1){const r=n.abs2(n.v2(),e);return r[0]<=t&&r[1]<=t},e.isPointWithinNDC=function(e,t){const r=i.vec3.transformMat4(n.v3(),t,e),s=n.abs3(n.v3(),r);return s[0]<=1&&s[1]<=1&&r[2]>=0&&r[2]<=1},e.distancePointToRay=o,e.eyeWithPointInView=function(e,t){const r=i.vec3.subtract(n.v3(),e.center,e.eye),a=i.vec3.normalize(n.v3(),r),c=i.vec3.normalize(n.v3(),i.vec3.cross(n.v3(),a,e.up)),h=i.vec3.normalize(n.v3(),i.vec3.cross(n.v3(),c,a)),l=o(e.eye,e.center,t),u=i.vec3.add(n.v3(),e.eye,i.vec3.scale(n.v3(),r,l)),d=i.vec3.subtract(n.v3(),t,u),_=Math.abs(i.vec3.dot(d,c))/e.aspect,f=Math.abs(i.vec3.dot(d,h)),p=Math.max(_,f)/Math.tan(e.fovy*s.DEG2RAD*.5);return i.vec3.subtract(n.v3(),u,i.vec3.scale(n.v3(),a,p))}}(a||(a={})),e.exports=a},9314:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.ReadbackPass=void 0;const n=r(3659),s=r(9696),a=r(2111),o=r(9564),c=r(1030),h=r(7570),l=r(4895),u=r(5263),d=r(6942);class _ extends c.Initializable{constructor(e){super(),this._cache=!1,this._depthAttachment=0,this._cachedDepths=new Map,this._cachedIDs=new Map,this._buffer=new Uint8Array(4),this._ndcTriangleShared=!1,this._context=e}static maxClearDepth(){return a.decode_float24x1_from_uint8x3(n.vec3.fromValues(255,255,255))}onFrame(){this._cachedDepths.clear(),this._cachedIDs.clear()}hash(e,t){return 65535*t+e}directReadDepthAt(e,t){s.assert(void 0!==this._depthFBO&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const r=this._depthFBO.texture(this._depthAttachment),i=this._context.gl,n=r.size;this._depthFBO.bind();const a=void 0===this._referenceSize?[1,1]:[n[0]/this._referenceSize[0],n[1]/this._referenceSize[1]];return(this._context.isWebGL2||this._context.supportsDrawBuffers)&&i.readBuffer(this._depthAttachment),i.readPixels(e*a[0],n[1]-t*a[1],1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer),this._buffer}renderThenReadDepthAt(e,t){s.assert(void 0!==this._depthFBO&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");const r=this._depthFBO.texture(this._depthAttachment),i=this._context.gl,n=r.size,a=void 0===this._referenceSize?[1,1]:[n[0]/this._referenceSize[0],n[1]/this._referenceSize[1]];return i.viewport(0,0,1,1),this._program.bind(),i.uniform2f(this._uOffset,e*a[0]/n[0],(n[1]-t*a[1])/n[1]),i.uniform2f(this._uScale,1/n[0],1/n[1]),r.bind(i.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),r.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&i.readBuffer&&i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind(),this._buffer}initialize(e,t){const i=this._context.gl,n=this._context.gl2facade;if(t)return this.readDepthAt=this.directReadDepthAt,!0;this.readDepthAt=this.renderThenReadDepthAt;const s=new u.Shader(this._context,i.VERTEX_SHADER,"ndcvertices.vert (readback)");s.initialize(r(3643));const a=new u.Shader(this._context,i.FRAGMENT_SHADER,"readbackdepth.frag");return a.initialize(r(5081)),this._program=new l.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([s,a],!1),void 0===e?this._ndcTriangle=new h.NdcFillingTriangle(this._context):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized||this._ndcTriangle.initialize(),this._program.attribute("a_vertex",this._ndcTriangle.vertexLocation),this._program.link(),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),i.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new d.Texture2D(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,i.RGBA,i.RGBA,i.UNSIGNED_BYTE),this._framebuffer=new o.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[n.COLOR_ATTACHMENT0,this._texture]]),!0}uninitialize(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())}depthAt(e,t){const r=this.hash(e,t);if(this._cache&&this._cachedDepths.has(r))return this._cachedDepths.get(r);const i=this.readDepthAt(e,t),s=255===i[0]&&255===i[1]&&255===i[2]?void 0:a.decode_float24x1_from_uint8x3(n.vec3.fromValues(i[0],i[1],i[2]));return this._cache&&this._cachedDepths.set(r,s),s}coordsAt(e,t,r,i){const s=this._depthFBO.texture(this._depthAttachment).size,a=void 0===r?this.depthAt(e,t):r;if(void 0===a)return;const o=void 0===this._referenceSize?[1,1]:[s[0]/this._referenceSize[0],s[1]/this._referenceSize[1]],c=n.vec3.fromValues(e*o[0]*2/s[0]-1,1-t*o[1]*2/s[1],2*a-1);return n.vec3.transformMat4(n.vec3.create(),c,i)}idAt(e,t){const r=this.hash(e,t);if(this._cache&&this._cachedIDs.has(r))return this._cachedIDs.get(r);const i=this._context.gl,s=this._idFBO.texture(this._idAttachment).size,o=void 0===this._referenceSize?[1,1]:[s[0]/this._referenceSize[0],s[1]/this._referenceSize[1]];this._idFBO.bind(),this._context.isWebGL2&&i.readBuffer(this._idAttachment),i.readPixels(e*o[0],s[1]-t*o[1],1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer);const c=a.decode_uint32_from_rgba8(n.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(r,c),c}frame(){this.onFrame()}set cache(e){this._cache=e}set depthFBO(e){this._depthFBO=e}set depthAttachment(e){this._depthAttachment=e}set idFBO(e){this._idFBO=e}set idAttachment(e){this._idAttachment=e}set coordinateReferenceSize(e){this._referenceSize=e}}i([c.Initializable.assert_initialized()],_.prototype,"directReadDepthAt",null),i([c.Initializable.assert_initialized()],_.prototype,"renderThenReadDepthAt",null),i([c.Initializable.initialize()],_.prototype,"initialize",null),i([c.Initializable.uninitialize()],_.prototype,"uninitialize",null),i([c.Initializable.assert_initialized()],_.prototype,"depthAt",null),i([c.Initializable.assert_initialized()],_.prototype,"coordsAt",null),i([c.Initializable.assert_initialized()],_.prototype,"idAt",null),t.ReadbackPass=_},7540:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderbuffer=void 0;const n=r(9696),s=r(423),a=r(1030),o=r(2281);class c extends o.AbstractObject{constructor(){super(...arguments),this._internalFormat=void 0}create(e,t,r,i=1){n.assert(e>0&&t>0,"renderbuffer object requires valid width and height greater than zero");const a=this.context.gl;this._object=a.createRenderbuffer(),this._width=e,this._height=t,this._internalFormat=r,this._samples=i,a.bindRenderbuffer(a.RENDERBUFFER,this._object),this._samples>1?a.renderbufferStorageMultisample(a.RENDERBUFFER,this._samples,r,e,t):a.renderbufferStorage(a.RENDERBUFFER,r,e,t),this._valid=a.isRenderbuffer(this._object),a.bindRenderbuffer(a.RENDERBUFFER,c.DEFAULT_RENDER_BUFFER);const o=e*t*s.byteSizeOfFormat(this.context,r);return this.context.allocationRegister.reallocate(this._identifier,o),this._object}delete(){n.assert(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0}bind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)}unbind(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,c.DEFAULT_RENDER_BUFFER)}resize(e,t,r=!1,i=!1){if(e===this._width&&t===this._height)return;this._width=e,this._height=t;const n=this.context.gl;r&&this.bind(),this._samples>1?n.renderbufferStorageMultisample(n.RENDERBUFFER,this._samples,this._internalFormat,e,t):n.renderbufferStorage(n.RENDERBUFFER,this._internalFormat,e,t),i&&this.unbind();const a=e*t*s.byteSizeOfFormat(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,a)}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get samples(){return this.assertInitialized(),this._samples}get multisampling(){return this.assertInitialized(),this._samples>1}get size(){return[this.width,this.height]}}c.DEFAULT_RENDER_BUFFER=void 0,i([a.Initializable.assert_initialized()],c.prototype,"bind",null),i([a.Initializable.assert_initialized()],c.prototype,"unbind",null),i([a.Initializable.assert_initialized()],c.prototype,"resize",null),t.Renderbuffer=c},3205:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=t.LoadingStatus=void 0;const n=r(9130),s=r(3659),a=r(9696),o=r(2111),c=r(4597),h=r(1030),l=r(4934),u=r(1284);var d;!function(e){e[e.Started=0]="Started",e[e.Finished=1]="Finished"}(d=t.LoadingStatus||(t.LoadingStatus={}));class _ extends h.Initializable{constructor(){super(...arguments),this._altered=Object.assign(new c.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),this._frameSize=[0,0],this._canvasSize=[0,0],this._framePrecision=u.Wizard.Precision.half,this._clearColor=[0,0,0,1],this._debugTextures=new Array,this._debugTextureSubject=new n.ReplaySubject(1)}invalidate(e=!1){this._invalidate(e)}debugTextureNext(){this._debugTextureSubject.next(this._debugTexture)}get context(){return this.assertInitialized(),this._context}get canvasSize(){return this.assertInitialized(),this._canvasSize}get altered(){return this._altered.any}onSwap(){}startLoading(){this._isLoading=!0,this._loadingStatusSubscription.next(d.Started)}finishLoading(){this._isLoading=!1,this._loadingStatusSubscription.next(d.Finished)}initialize(e,t,r){return a.assert(void 0!==e,"valid webgl context required"),this._context=e,a.assert(void 0!==t,"valid multi-frame update callback required"),this._invalidate=t,this._isLoading=!0,this._loadingStatusSubscription=new n.ReplaySubject,this.onInitialize(e,t,r)}uninitialize(){this.onUninitialize()}discard(){this.onDiscarded()}update(e){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==e&&(this._multiFrameNumber=e,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any}prepare(){this.onPrepare()}frame(e){this.onFrame(e)}swap(){this.onSwap()}frameCoords(e,t){const r=s.vec2.divide(o.v2(),this._frameSize,this.canvasSize);return s.vec2.floor(r,s.vec2.multiply(r,[e+.5,t+.5],r)),s.vec2.add(r,r,[.5,.5]),l.tuple2(r)}set frameSize(e){this.assertInitialized(),s.vec2.equals(this._frameSize,e)||(Object.assign(this._frameSize,e),this._altered.alter("frameSize"),this.invalidate())}set framePrecision(e){this.assertInitialized(),this._framePrecision!==e&&(this._framePrecision=e,this._altered.alter("framePrecision"),this.invalidate())}set clearColor(e){this.assertInitialized(),s.vec4.equals(this._clearColor,e)||(Object.assign(this._clearColor,e),this._altered.alter("clearColor"),this.invalidate())}get debugTextures(){return this.assertInitialized(),this._debugTextures}get debugTexture(){return this.assertInitialized(),this._debugTexture}set debugTexture(e){this.assertInitialized(),this._debugTexture!==e&&(a.logIf(e>=this._debugTextures.length,a.LogLevel.Error,`invalid texture index, debug texture disabled (index set to -1) | ${e} not in [-1,+${this._debugTextures.length-1}]`),this._debugTexture=e<this._debugTextures.length?o.clamp(e,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())}get debugTexture$(){return this._debugTextureSubject.asObservable()}get isLoading(){return this._isLoading}get loadingStatus$(){return this._loadingStatusSubscription.asObservable()}}i([h.Initializable.assert_initialized()],_.prototype,"invalidate",null),i([h.Initializable.initialize()],_.prototype,"initialize",null),i([h.Initializable.uninitialize()],_.prototype,"uninitialize",null),i([h.Initializable.discard()],_.prototype,"discard",null),i([h.Initializable.assert_initialized()],_.prototype,"update",null),i([h.Initializable.assert_initialized()],_.prototype,"prepare",null),i([h.Initializable.assert_initialized()],_.prototype,"frame",null),i([h.Initializable.assert_initialized()],_.prototype,"swap",null),t.Renderer=_},6346:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Resizable=void 0;const i=r(9696);class n{constructor(){if(this._resizeEventListener=()=>n.resize(),this._mutationEventListener=()=>{this._mutationObserver.takeRecords(),n.resize()},0===n.instances.length){const e=`on${n.EVENT_IDENTIFIER}`;n.eventSupported=document&&(e in document.documentElement||e in document.body),i.logIf(!n.eventSupported,i.LogLevel.Warning,"resize event not supported")}0===n.instances.length&&n.eventSupported&&window.addEventListener(n.EVENT_IDENTIFIER,this._resizeEventListener),n.instances.push(this)}static resize(){i.assert(n.instances.length>0,"resize event received without a single resizable registered"),n.instances.forEach((e=>e.onResize()))}static elementSize(e){if(void 0===e||void 0===window||"number"!=typeof window.devicePixelRatio)return[0,0];const t=window.devicePixelRatio,r=getComputedStyle(e);if(null===r.width||!r.width.endsWith("px")||null===r.height||!r.height.endsWith("px"))return void i.log(i.LogLevel.Debug,`computed element size expected in 'px', given ${r.width} ${r.height}`);const n=[parseFloat(r.width),parseFloat(r.height)];return[Math.round(n[0]*t),Math.round(n[1]*t)]}observe(e){void 0!==e&&(this._mutationObserver=new MutationObserver(this._mutationEventListener)),this._mutationObserver.observe(e,n.MUTATION_OBSERVER_CONFIG)}dispose(){const e=n.instances.indexOf(this);i.assert(-1!==e,"invalid reference counting of resizable instances"),n.instances.splice(e,1),0===n.instances.length&&n.eventSupported&&window.removeEventListener(n.EVENT_IDENTIFIER,this._resizeEventListener),this._mutationObserver&&this._mutationObserver.disconnect()}}t.Resizable=n,n.EVENT_IDENTIFIER="resize",n.instances=[],n.eventSupported=!1,n.MUTATION_OBSERVER_CONFIG={attributes:!0,attributeFilter:["style","class"],childList:!0,subtree:!0}},9092:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.ForwardSceneRenderPass=void 0;const n=r(3659),s=r(9696),a=r(4597),o=r(1030),c=r(3946);class h extends c.SceneRenderPass{constructor(e){super(),this._altered=Object.assign(new a.ChangeLookup,{any:!1,camera:!1}),this._context=e,this._opaqueGeometryMap=new Map,this._transparentGeometryMap=new Map}preprocessScene(){s.assert(void 0!==this._scene,"Scene was undefined during preprocessing."),void 0!==this._scene&&(this._opaqueGeometryMap.clear(),this._transparentGeometryMap.clear(),this.preprocessNode(this._scene,n.mat4.create()))}preprocessNode(e,t){const r=n.mat4.clone(t),i=e.componentsOfType("TransformComponent");if(s.assert(i.length<=1,"SceneNode can not have more than one transform component"),1===i.length){const e=i[0];n.mat4.mul(r,r,e.transform)}const a=e.componentsOfType("GeometryComponent");for(const e of a){const t=e,i=t.material,n=t.geometry;if(i.isTransparent){let e=this._transparentGeometryMap.get(i);void 0===e&&(e=[]),e.push([n,r]),this._transparentGeometryMap.set(i,e)}else{let e=this._opaqueGeometryMap.get(i);void 0===e&&(e=[]),e.push([n,r]),this._opaqueGeometryMap.set(i,e)}}if(void 0!==e.nodes)for(const t of e.nodes)this.preprocessNode(t,r)}renderGeometryMap(e){for(const t of Array.from(e.keys())){this.bindMaterial(t);const r=e.get(t);for(const[e,t]of r)e.bind(),void 0!==this.bindGeometry&&this.bindGeometry(e),this.updateModelTransform(t),e.draw(),e.unbind()}}initialize(){return!0}uninitialize(){}prepare(){}update(e=!1){}frame(){if(s.assert(this._target&&this._target.valid,"valid target expected"),s.assert(this._program&&this._program.valid,"valid program expected"),s.assert(void 0!==this.updateModelTransform,"Model transform function needs to be initialized."),s.assert(void 0!==this.updateViewProjectionTransform,"View Projection transform function needs to be initialized."),s.assert(void 0!==this.bindMaterial,"Material binding function needs to be initialized."),void 0===this._scene)return;const e=this._context.gl;e.enable(e.DEPTH_TEST);const t=this._target.size;e.viewport(0,0,t[0],t[1]),this._program.bind(),void 0!==this.bindUniforms&&this.bindUniforms(),this.updateViewProjectionTransform(this._camera.viewProjection),this.drawCalls(),this._program.unbind(),e.disable(e.BLEND)}drawCalls(e=!0){void 0!==this._scene&&(this.renderGeometryMap(this._opaqueGeometryMap),e&&this.renderGeometryMap(this._transparentGeometryMap))}set target(e){this.assertInitialized(),this._target=e}set ndcOffset(e){this.assertInitialized(),this._ndcOffset=e}set camera(e){this.assertInitialized(),this._camera!==e&&(this._camera=e,this._altered.alter("camera"))}set clearColor(e){this._clearColor=e}set program(e){this._program=e}}i([o.Initializable.initialize()],h.prototype,"initialize",null),i([o.Initializable.uninitialize()],h.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],h.prototype,"update",null),i([o.Initializable.assert_initialized()],h.prototype,"frame",null),i([o.Initializable.assert_initialized()],h.prototype,"drawCalls",null),t.ForwardSceneRenderPass=h},4614:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeometryComponent=void 0;const i=r(922);class n extends i.SceneNodeComponent{constructor(){super("GeometryComponent")}set geometry(e){this._geometry=e}get geometry(){return this._geometry}set material(e){this._material=e}get material(){return this._material}}t.GeometryComponent=n},9922:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=t.Material=t.GeometryComponent=t.TransformComponent=t.SceneNodeComponent=t.SceneNode=t.ForwardSceneRenderPass=void 0;var i=r(9092);Object.defineProperty(t,"ForwardSceneRenderPass",{enumerable:!0,get:function(){return i.ForwardSceneRenderPass}});var n=r(9981);Object.defineProperty(t,"SceneNode",{enumerable:!0,get:function(){return n.SceneNode}});var s=r(922);Object.defineProperty(t,"SceneNodeComponent",{enumerable:!0,get:function(){return s.SceneNodeComponent}});var a=r(8425);Object.defineProperty(t,"TransformComponent",{enumerable:!0,get:function(){return a.TransformComponent}});var o=r(4614);Object.defineProperty(t,"GeometryComponent",{enumerable:!0,get:function(){return o.GeometryComponent}});var c=r(9699);Object.defineProperty(t,"Material",{enumerable:!0,get:function(){return c.Material}});var h=r(3946);Object.defineProperty(t,"SceneRenderPass",{enumerable:!0,get:function(){return h.SceneRenderPass}})},9699:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Material=void 0,t.Material=class{constructor(e,t){this._context=e,this._name=t,this._isTransparent=!1}get name(){return this._name}get isTransparent(){return this._isTransparent}set isTransparent(e){this._isTransparent=e}}},9981:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNode=void 0,t.SceneNode=class{constructor(e){this._nodes=new Array,this._components=new Array,this._name=e,this._parent=void 0}traverse(e){e(this);for(const t of this._nodes)t.traverse(e)}addNode(e){return e._parent=this,this._nodes.push(e),e}addComponent(e){return this._components.push(e),e}componentsOfType(e){return this._components.filter((t=>e===t.type))}get name(){return this._name}get parent(){return this._parent}get nodes(){return this._nodes}get components(){return this._components}get isLeaf(){return 0===this._nodes.length}get isRoot(){return void 0===this._parent}}},922:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SceneNodeComponent=void 0,t.SceneNodeComponent=class{constructor(e){this._type=e}get type(){return this._type}}},3946:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SceneRenderPass=void 0;const i=r(1030);class n extends i.Initializable{set scene(e){this._scene=e,void 0!==this._scene&&this.preprocessScene()}get scene(){return this._scene}}t.SceneRenderPass=n},8425:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransformComponent=void 0;const i=r(922);class n extends i.SceneNodeComponent{constructor(e){super("TransformComponent"),this._transform=e}get transform(){return this._transform}}t.TransformComponent=n},5263:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shader=void 0;const i=r(9696),n=r(2281);class s extends n.AbstractObject{constructor(e,t,r){super(e,r),this._compiled=!1;const n=e.gl;if(void 0===r)switch(t){case e.gl.FRAGMENT_SHADER:r="FragmentShader";break;case e.gl.VERTEX_SHADER:r="VertexShader";break;default:i.assert(!1,`expected either a FRAGMENT_SHADER (${n.FRAGMENT_SHADER}) or a VERTEX_SHADER (${n.VERTEX_SHADER}), given ${t}`)}this._type=t}create(e,t=!0){const r=this._context.gl;return this._object=r.createShader(this._type),this._valid=r.isShader(this._object),this._compiled=!1,i.assert(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),e&&(this.source=e),e&&t&&this.compile(),this._object}delete(){i.assert(void 0!==this._object,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1,this._compiled=!1}compile(){const e=this._context.gl;let t=this.sourceWithReplacements;if(this._context.isWebGL2&&(t=`#version 300 es\n${t}`),e.shaderSource(this._object,t),e.compileShader(this._object),this._compiled=e.getShaderParameter(this._object,e.COMPILE_STATUS),!this._compiled){const t=e.getShaderInfoLog(this._object);i.log(i.LogLevel.Error,`compilation of shader '${this._identifier}' failed: ${t}`)}}replace(e,t){void 0===this._replacements&&(this._replacements=new Map),this._replacements.set(e,t)}get type(){return this.assertInitialized(),this._type}set source(e){this._source!==e&&(this._source=e)}get source(){return this.assertInitialized(),this._source}get sourceWithReplacements(){if(void 0===this._replacements)return this._source;let e=this._source;return this._replacements.forEach(((t,r)=>{const i=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp(i,"g"),t)})),e}get compiled(){return this.assertInitialized(),this._compiled}}t.Shader=s},6210:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.ShadowPass=void 0;const n=r(9696),s=r(9564),a=r(5714),o=r(1030),c=r(7540),h=r(6942),l=r(1284);class u extends o.Initializable{constructor(e){super(),this._gaussFilterKernelSize=21,this._context=e}get shadowMapFBO(){return this._shadowMapFBO}get shadowMapTexture(){return this.hasBlur?this._blurTexture:this._shadowMapTexture}get hasBlur(){return this._shadowType!==u.ShadowMappingType.HardLinear}get blurSize(){return this._gaussFilterKernelSize}set blurSize(e){e!==this._gaussFilterKernelSize&&(void 0!==this._gaussFilter&&(this._gaussFilter.kernelSize=e,this._gaussFilter.standardDeviation=e/6),this._gaussFilterKernelSize=e)}resize(e,t=!0,r=!0){n.assert(e[0]>0&&e[1]>0,"Size has to be > 0."),this._shadowMapSize=e,this._shadowMapFBO.resize(this._shadowMapSize[0],this._shadowMapSize[1],t,r)}resizeBlurTexture(e,t=!0,r=!0){n.assert(e[0]>0&&e[1]>0,"Size has to be > 0."),this._blurredShadowMapSize=e,this._intermediateBlurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],t,r),this._blurFBO.resize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],t,r)}initialize(e,t,r){n.assert(t[0]>0&&t[1]>0,"Size has to be > 0."),this._shadowType=e,this._shadowMapSize=t,this._blurredShadowMapSize=void 0!==r?r:this._shadowMapSize;const i=this._context.gl,o=this._context.gl2facade;let d=i.RGBA;if(this._context.isWebGL2){const e=this._context.gl;switch(this._shadowType){case u.ShadowMappingType.HardLinear:case u.ShadowMappingType.HardExponential:d=e.RED;break;case u.ShadowMappingType.SoftLinear:d=e.RG;break;case u.ShadowMappingType.SoftExponential:d=e.RGBA;break;default:n.assert(!1,"Unexpected value for shadowType")}}const[_,f]=l.Wizard.queryInternalTextureFormat(this._context,d,l.Wizard.Precision.float);this._shadowType!==u.ShadowMappingType.HardLinear&&f!==i.FLOAT&&(n.log(n.LogLevel.Warning,"floating point textures are not supported, falling back to HardLinear"),this._shadowType=u.ShadowMappingType.HardLinear);let p=i.LINEAR;return f!==i.FLOAT||this._context.supportsTextureFloatLinear||(p=i.NEAREST),f!==o.HALF_FLOAT||this._context.supportsTextureHalfFloatLinear||(p=i.NEAREST),this._shadowMapTexture=new h.Texture2D(this._context),this._shadowMapTexture.initialize(this._shadowMapSize[0],this._shadowMapSize[1],_,d,i.FLOAT),this._shadowMapTexture.wrap(i.CLAMP_TO_EDGE,i.CLAMP_TO_EDGE),this._shadowMapTexture.filter(p,p),this._shadowMapRenderbuffer=new c.Renderbuffer(this._context),this._shadowMapRenderbuffer.initialize(this._shadowMapSize[0],this._shadowMapSize[1],i.DEPTH_COMPONENT16),this._shadowMapFBO=new s.Framebuffer(this._context),this._shadowMapFBO.initialize([[o.COLOR_ATTACHMENT0,this._shadowMapTexture],[i.DEPTH_ATTACHMENT,this._shadowMapRenderbuffer]]),this._shadowMapFBO.clearColor([1,1,1,1]),this._shadowMapFBO.clearDepth(1),this.hasBlur&&(this._gaussFilter=new a.GaussFilter(this._context),this._gaussFilter.kernelSize=this._gaussFilterKernelSize,this._gaussFilter.standardDeviation=this._gaussFilterKernelSize/6,this._gaussFilter.initialize(),this._intermediateBlurTexture=new h.Texture2D(this._context,"IntermediateBlurTexture"),this._intermediateBlurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],_,d,i.FLOAT),this._intermediateBlurTexture.wrap(i.CLAMP_TO_EDGE,i.CLAMP_TO_EDGE),this._intermediateBlurTexture.filter(p,p),this._intermediateBlurFBO=new s.Framebuffer(this._context,"IntermediateBlurFramebuffer"),this._intermediateBlurFBO.initialize([[o.COLOR_ATTACHMENT0,this._intermediateBlurTexture]]),this._intermediateBlurFBO.clearColor([1,1,1,1]),this._intermediateBlurFBO.clearDepth(1),this._blurTexture=new h.Texture2D(this._context,"BlurTexture"),this._blurTexture.initialize(this._blurredShadowMapSize[0],this._blurredShadowMapSize[1],_,d,i.FLOAT),this._blurTexture.wrap(i.CLAMP_TO_EDGE,i.CLAMP_TO_EDGE),this._blurTexture.filter(p,p),this._blurFBO=new s.Framebuffer(this._context,"BlurFramebuffer"),this._blurFBO.initialize([[o.COLOR_ATTACHMENT0,this._blurTexture]]),this._blurFBO.clearColor([1,1,1,1]),this._blurFBO.clearDepth(1)),!0}uninitialize(){this._shadowMapFBO.uninitialize(),this._shadowMapRenderbuffer.uninitialize(),this._shadowMapTexture.uninitialize(),this.hasBlur&&(this._intermediateBlurFBO.uninitialize(),this._intermediateBlurTexture.uninitialize(),this._blurFBO.uninitialize(),this._blurTexture.uninitialize(),this._gaussFilter.uninitialize())}frame(e){const t=this._context.gl;t.viewport(0,0,this._shadowMapSize[0],this._shadowMapSize[1]),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),this._shadowMapFBO.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT,!0,!1),e(),t.disable(t.DEPTH_TEST),t.depthFunc(t.LESS),this.hasBlur&&(t.viewport(0,0,this._intermediateBlurFBO.width,this._intermediateBlurFBO.height),this._intermediateBlurFBO.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._shadowMapTexture,a.GaussFilter.Direction.Horizontal),t.viewport(0,0,this._blurFBO.width,this._blurFBO.height),this._blurFBO.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT,!0,!1),this._gaussFilter.filter(this._intermediateBlurTexture,a.GaussFilter.Direction.Vertical))}}i([o.Initializable.assert_initialized()],u.prototype,"resize",null),i([o.Initializable.assert_initialized()],u.prototype,"resizeBlurTexture",null),i([o.Initializable.initialize()],u.prototype,"initialize",null),i([o.Initializable.uninitialize()],u.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],u.prototype,"frame",null),t.ShadowPass=u,function(e){let t;!function(e){e[e.HardLinear=0]="HardLinear",e[e.SoftLinear=1]="SoftLinear",e[e.HardExponential=2]="HardExponential",e[e.SoftExponential=3]="SoftExponential"}(t=e.ShadowMappingType||(e.ShadowMappingType={}))}(u=t.ShadowPass||(t.ShadowPass={}))},6902:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontFace=void 0;const i=r(9696),n=r(6942),s=r(1284),a=r(6869),o=r(7115),c=r(6885);class h{constructor(e,t){this._ascent=0,this._descent=0,this._lineGap=0,this._glyphTextureExtent=[0,0],this._glyphTexturePadding=[0,0,0,0],this._glyphs=new Map,this._context=e;const r=e.gl;t=void 0!==t&&""!==t?t:this.constructor.name,this._glyphTexture=new n.Texture2D(e,`${t}GlyphAtlas`);const i=s.Wizard.queryInternalTextureFormat(e,r.RGBA,s.Wizard.Precision.byte);this._glyphTexture.initialize(1,1,i[0],r.RGBA,i[1]),this._glyphTexture.filter(r.LINEAR,r.LINEAR)}static fromFile(e,t,r=!1,i){return a.fetchAsync(e,"text").then((n=>{const s=new h(t,i);return o.FontFaceLoader.process(s,n,e,void 0,r).then((e=>e)).catch((e=>Promise.reject(`processing font face data failed: ${e}`)))}))}static fromFiles(e,t,r,i=!1,n){return a.fetchAsync(e,"text").then((s=>{const a=new h(r,n);return o.FontFaceLoader.process(a,s,e,t,i).then((e=>e)).catch((e=>Promise.reject(`processing font face data failed: ${e}`)))}))}hasGlyph(e){return!!this._glyphs.get(e)}glyph(e){const t=this._glyphs.get(e);if(t)return t;const r=new c.Glyph;return r.index=e,r}addGlyph(e){i.assert(!this._glyphs.get(e.index),"expected glyph to not already exist"),this._glyphs.set(e.index,e)}arrayOfGlyphIndices(){return Array.from(this._glyphs.keys())}depictable(e){return this.glyph(e).depictable()}kerning(e,t){const r=this._glyphs.get(e);return r?r.kerning(t):0}setKerning(e,t,r){const n=this._glyphs.get(e);n&&this.hasGlyph(t)?n.setKerning(t,r):i.assert(!1,`expected glyph or glyph of subsequent index to exist,                 given ${e} and ${t} respectively`)}set size(e){i.assert(e>0,`expected size to be greater than 0.0, given ${e}`),this._size=e}get size(){return this._size}set base(e){i.assert(e>0,`expected base to be greater than 0.0, given ${e}`),this._base=e}get base(){return this._base}set ascent(e){i.assert(e>0,`expected ascent to be greater than 0.0, given ${e}`),this._ascent=e}get ascent(){return this._ascent}set descent(e){this._descent=e}get descent(){return this._descent}set lineGap(e){this._lineGap=e}get lineGap(){return this._lineGap}set lineHeight(e){i.assert(this.size>0,"expected size to be greater than zero to derive line gap from line height"),this._lineGap=e-this.size}get lineHeight(){return this.size+this.lineGap}set lineSpace(e){this._lineGap=this.size*(e-1)}get lineSpace(){return 0===this.lineHeight?this.lineHeight:this.size/this.lineHeight}set glyphTextureExtent(e){i.assert(e[0]>0,`expected extent.x to be greater than 0.0, given ${e[0]}`),i.assert(e[1]>0,`expected extent.y to be greater than 0.0, given ${e[1]}`),this._glyphTextureExtent=e}get glyphTextureExtent(){return this._glyphTextureExtent}set glyphTexturePadding(e){i.assert(e[0]>=0,`expected padding[0] to be greater than 0.0, given ${e[0]}`),i.assert(e[1]>=0,`expected padding[1] to be greater than 0.0, given ${e[1]}`),i.assert(e[2]>=0,`expected padding[2] to be greater than 0.0, given ${e[2]}`),i.assert(e[3]>=0,`expected padding[3] to be greater than 0.0, given ${e[3]}`),this._glyphTexturePadding=e}get glyphTexturePadding(){return this._glyphTexturePadding}set glyphTexture(e){this._glyphTexture=e}get glyphTexture(){return this._glyphTexture}}t.FontFace=h},7115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontFaceLoader=void 0;const i=r(9696),n=r(6885);class s{static processInfo(e,t){const r=new Map;if(!this.readKeyValuePairs(e,["size","padding"],r))return!1;t.size=parseFloat(r.get("size"));const n=r.get("padding").split(",");if(4!==n.length)return i.log(i.LogLevel.Warning,`expected 4 values for padding, given ${n} (${n.length})`),!1;const s=[parseFloat(n[0]),parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3])];return t.glyphTexturePadding=s,!0}static processCommon(e,t){const r=new Map;return!!this.readKeyValuePairs(e,["lineHeight","base","scaleW","scaleH"],r)&&(t.base=parseFloat(r.get("base")),r.has("ascent")&&(t.ascent=parseFloat(r.get("ascent"))),r.has("descent")&&(t.descent=parseFloat(r.get("descent"))),t.lineHeight=parseFloat(r.get("lineHeight")),t.glyphTextureExtent=[parseFloat(r.get("scaleW")),parseFloat(r.get("scaleH"))],!0)}static processPage(e,t,r){const n=new Map;if(!this.readKeyValuePairs(e,["file"],n))return;const s=i.dirname(r);let a=n.get("file");return a=a.replace(/['"]+/g,""),t.glyphTexture.fetch(`${s}/${a}`,!0,!0).catch((()=>Promise.reject(`page '${a}' referenced in font file '${r}' was not found`)))}static processPages(e,t){i.logIf(1!==t.size,i.LogLevel.Warning,"glyph atlas supports a single page only (impl. for multiple pages pending)"),i.assert(t.has(0),"page with page ID 0 expected for glyph atlas (impl. for multiple pages pending)");const r=t.get(0);if(r)return e.glyphTexture.fetch(`${r}`,!0,!0).catch((()=>Promise.reject(`fetching page '0' from '${r}' failed`)))}static processChar(e,t){const r=new Map;if(!this.readKeyValuePairs(e,["id","x","y","width","height","xoffset","yoffset","xadvance"],r))return!1;const s=parseInt(r.get("id"),10);i.logIf(s<=0,i.LogLevel.Warning,`expected glyph index to be greater than 0, given ${s}`);const a=new n.Glyph;a.index=s;const o=[1/t.glyphTextureExtent[0],1/t.glyphTextureExtent[1]],c=[parseFloat(r.get("width")),parseFloat(r.get("height"))];return a.subTextureOrigin=[parseFloat(r.get("x"))*o[0],1-(parseFloat(r.get("y"))+c[1])*o[1]],a.extent=c,a.subTextureExtent[0]=c[0]*o[0],a.subTextureExtent[1]=c[1]*o[1],a.bearingFromFontBaseAndOffset(t.base,parseFloat(r.get("xoffset")),parseFloat(r.get("yoffset"))),a.advance=parseFloat(r.get("xadvance")),t.addGlyph(a),!0}static processKerning(e,t){const r=new Map;if(!this.readKeyValuePairs(e,["first","second","amount"],r))return!1;const n=parseInt(r.get("first"),10);if(n<=0)return i.log(i.LogLevel.Warning,`expected kerning's first to be greater than 0, given ${n}`),!1;const s=parseInt(r.get("second"),10);if(s<=0)return i.log(i.LogLevel.Warning,`expected kerning's second to be greater than 0, given ${s}`),!1;const a=parseFloat(r.get("amount"));return t.setKerning(n,s,a),!0}static readKeyValuePairs(e,t,r){let n,s;for(const t of e){const e=t.split("=");n=e[0],s=e[1],r.set(n,s)}let a=!0;return t.forEach((e=>a=a&&r.has(e))),a||i.log(i.LogLevel.Warning,`Not all required keys are provided! Mandatory keys: ${t}`),a}static findAscentAndDescentIfNoneProvided(e,t){if(e.ascent>0&&e.descent<0)return;e.ascent>0&&(e.descent=e.ascent-t),e.descent<0&&(e.ascent=e.descent-t);let r=Number.MIN_VALUE;for(const t of e.arrayOfGlyphIndices())0!==e.glyph(t).extent[1]&&(r=Math.max(e.glyph(t).bearing[1],r));e.ascent=r,e.descent=e.ascent-t,i.log(i.LogLevel.Debug,`ascent not specified, derived ${e.ascent} from maximum y-offset`)}static process(e,t,r,n,a=!1){const o=t.split("\n"),c=new Array;let h=!0;if(!a&&n){const t=this.processPages(e,n);void 0!==t&&c.push(t)}for(const t of o){let i=t.split(" ");const s=i[0];switch(i=i.slice(1),s){case"info":h=this.processInfo(i,e);break;case"common":h=this.processCommon(i,e);break;case"page":if(a||n)break;const t=this.processPage(i,e,r);void 0!==t&&c.push(t);break;case"char":h=this.processChar(i,e);break;case"kerning":this.processKerning(i,e)}if(!1===h)break}return s.findAscentAndDescentIfNoneProvided(e,e.size),e.size<=0&&i.log(i.LogLevel.Warning,`expected fontFace.size to be greater than 0, given ${e.size}`),Promise.all(c).then((()=>e))}}t.FontFaceLoader=s},6885:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Glyph=void 0;const i=r(4934);t.Glyph=class{constructor(e=0,t=0){this._bearing=[0,0],this._extent=[0,0],this._kernings=new Map,this._subTextureOrigin=[0,0],this._subTextureExtent=[0,0],this._index=e,this._advance=t}depictable(){return this._subTextureExtent[0]>0&&this._subTextureExtent[1]>0}kerning(e){const t=this._kernings.get(e);return void 0!==t?t:0}setKerning(e,t){this._kernings.set(e,t)}set index(e){this._index=e}get index(){return this._index}set subTextureOrigin(e){this._subTextureOrigin=i.clampf2(e,"texture origin")}get subTextureOrigin(){return this._subTextureOrigin}set subTextureExtent(e){this._subTextureExtent=i.clampf2(e,"texture extent")}get subTextureExtent(){return this._subTextureExtent}set bearing(e){this._bearing=e}get bearing(){return this._bearing}bearingFromFontBaseAndOffset(e,t,r){this._bearing[0]=t,this._bearing[1]=e-r}set extent(e){this._extent=e}get extent(){return this._extent}set advance(e){this._advance=e}get advance(){return this._advance}}},7326:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphVertices=void 0;class r{constructor(e){const t=Math.max(0,e);this._texCoords=new Float32Array(t*r.FLOATS_PER_TEXCOORD),this._origins=new Float32Array(t*r.FLOATS_PER_ORIGIN),this._tangents=new Float32Array(t*r.FLOATS_PER_TANGENT),this._ups=new Float32Array(t*r.FLOATS_PER_UP)}static concat(e){let t=0;e.forEach((e=>t+=e?e.length:0));const i=new r(t);let n=0;for(let t=0;t<e.length;++t){const s=e[t];void 0!==s&&0!==s.length&&(i._texCoords.set(s._texCoords,n*r.FLOATS_PER_TEXCOORD),i._origins.set(s._origins,n*r.FLOATS_PER_ORIGIN),i._tangents.set(s._tangents,n*r.FLOATS_PER_TANGENT),i._ups.set(s._ups,n*r.FLOATS_PER_UP),n+=s.length)}return i}shrink(e){const t=Math.max(0,e);if(this.length===t)return;const i=(e,t,r)=>new Float32Array(e.buffer.slice(0,t*e.BYTES_PER_ELEMENT*r),0,t*r);i(this._texCoords,t,r.FLOATS_PER_TEXCOORD),i(this._origins,t,r.FLOATS_PER_ORIGIN),i(this._ups,t,r.FLOATS_PER_TANGENT),i(this._tangents,t,r.FLOATS_PER_UP)}uvLowerLeft(e){const t=e*r.FLOATS_PER_TEXCOORD+0;return this._texCoords.subarray(t,t+2)}uvUpperRight(e){const t=e*r.FLOATS_PER_TEXCOORD+2;return this._texCoords.subarray(t,t+2)}origin(e){const t=e*r.FLOATS_PER_ORIGIN;return this._origins.subarray(t,t+r.FLOATS_PER_ORIGIN)}tangent(e){const t=e*r.FLOATS_PER_TANGENT;return this._tangents.subarray(t,t+r.FLOATS_PER_TANGENT)}up(e){const t=e*r.FLOATS_PER_UP;return this._ups.subarray(t,t+r.FLOATS_PER_UP)}get length(){return this._origins.length/r.FLOATS_PER_ORIGIN}get origins(){return this._origins}get tangents(){return this._tangents}get ups(){return this._ups}get texCoords(){return this._texCoords}}t.GlyphVertices=r,r.FLOATS_PER_TEXCOORD=4,r.FLOATS_PER_ORIGIN=3,r.FLOATS_PER_TANGENT=3,r.FLOATS_PER_UP=3},2709:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=t.Text=t.Projected3DLabel=t.Position3DLabel=t.Position2DLabel=t.LabelRenderPass=t.LabelGeometry=t.Label=t.GlyphVertices=t.FontFace=void 0;var i=r(6902);Object.defineProperty(t,"FontFace",{enumerable:!0,get:function(){return i.FontFace}});var n=r(7326);Object.defineProperty(t,"GlyphVertices",{enumerable:!0,get:function(){return n.GlyphVertices}});var s=r(8733);Object.defineProperty(t,"Label",{enumerable:!0,get:function(){return s.Label}});var a=r(8852);Object.defineProperty(t,"LabelGeometry",{enumerable:!0,get:function(){return a.LabelGeometry}});var o=r(8597);Object.defineProperty(t,"LabelRenderPass",{enumerable:!0,get:function(){return o.LabelRenderPass}});var c=r(8254);Object.defineProperty(t,"Position2DLabel",{enumerable:!0,get:function(){return c.Position2DLabel}});var h=r(8115);Object.defineProperty(t,"Position3DLabel",{enumerable:!0,get:function(){return h.Position3DLabel}});var l=r(1648);Object.defineProperty(t,"Projected3DLabel",{enumerable:!0,get:function(){return l.Projected3DLabel}});var u=r(819);Object.defineProperty(t,"Text",{enumerable:!0,get:function(){return u.Text}});var d=r(3210);Object.defineProperty(t,"Typesetter",{enumerable:!0,get:function(){return d.Typesetter}})},8733:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Label=void 0;const i=r(3659),n=r(4597),s=r(7677),a=r(7326),o=r(819);class c{constructor(e,t,r){this._alignment=c.Alignment.Left,this._lineAnchor=c.LineAnchor.Baseline,this._lineWidth=NaN,this._fontSizeUnit=c.Unit.World,this._color=new s.Color(c.DEFAULT_COLOR),this._altered=Object.assign(new n.ChangeLookup,{any:!1,color:!1,resources:!1,text:!1,typesetting:!1,static:!1,dynamic:!1}),this._wrap=!1,this._elide=c.Elide.None,this._ellipsis=c.DEFAULT_ELLIPSIS,this._text=e,this._type=t,this._staticTransform=i.mat4.create(),this._dynamicTransform=i.mat4.create(),this._extent=[0,0],r&&(this._fontFace=r)}static devicePixelRatio(){return void 0===window||"number"!=typeof window.devicePixelRatio?1:window.devicePixelRatio}vertices(){return new a.GlyphVertices(this.length+this.ellipsis.length)}charAt(e){return this._text.charAt(e)}charCodeAt(e){return this._text.charCodeAt(e)}lineFeedAt(e){return this.charAt(e)===this.lineFeed}kerningBefore(e){return e<1||e>this.length?NaN:this._fontFace.kerning(this.charCodeAt(e-1),this.charCodeAt(e))}kerningAfter(e){return e<0||e>this.length-1?NaN:this._fontFace.kerning(this.charCodeAt(e),this.charCodeAt(e+1))}advance(e){return e<0||e>this.length?NaN:this._fontFace.glyph(this.charCodeAt(e)).advance}toString(){return this._text instanceof o.Text?this._text.text:this._text}reset(){this._altered.reset()}set text(e){this._altered.alter("text"),this._text=e}get text(){return this._text}get type(){return this._type}get length(){return this._text.length}get lineFeed(){return this._text instanceof o.Text?this._text.lineFeed:o.Text.DEFAULT_LINE_FEED}set wrap(e){this._wrap=e}get wrap(){return this._wrap}set elide(e){this._elide=e}get elide(){return this._elide}set ellipsis(e){this._ellipsis!==e&&(this._ellipsis=e,this._elide!==c.Elide.None&&this._altered.alter("typesetting"))}get ellipsis(){return this._ellipsis}set lineWidth(e){this._lineWidth!==e&&(this._lineWidth=e,this._altered.alter("typesetting"))}get lineWidth(){return this._lineWidth*this._fontFace.size/this.fontSize}set alignment(e){this._alignment!==e&&(this._alignment=e,this._altered.alter("typesetting"))}get alignment(){return this._alignment}set lineAnchor(e){this._lineAnchor!==e&&(this._lineAnchor=e,this._altered.alter("typesetting"))}get lineAnchor(){return this._lineAnchor}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this._altered.alter("typesetting"))}get fontSize(){return this._fontSize}set fontSizeUnit(e){this._fontSizeUnit!==e&&(this._fontSizeUnit=e,this._altered.alter("typesetting"))}get fontSizeUnit(){return this._fontSizeUnit}set fontFace(e){this._fontFace!==e&&(this._fontFace=e,this._altered.alter("typesetting"),this._altered.alter("resources"))}get fontFace(){return this._fontFace}set color(e){this._color.equals(e)||(this._color=e,this._altered.alter("color"))}get color(){return this._color}set backgroundColor(e){this._backgroundColor.equals(e)||(this._backgroundColor=e,this._altered.alter("color"))}get backgroundColor(){return this._backgroundColor}set staticTransform(e){i.mat4.equals(this._staticTransform,e)||(this._staticTransform=e,this._altered.alter("static"))}get staticTransform(){const e=this.fontSize/this._fontFace.size,t=i.mat4.create();return i.mat4.scale(t,this._staticTransform,i.vec3.fromValues(e,e,e)),t}set dynamicTransform(e){this._altered.alter("dynamic"),this._dynamicTransform=e}get dynamicTransform(){return this._dynamicTransform}set extent(e){this._extent=e}get extent(){return this._extent}get altered(){return this._altered.any||this._text.altered||this._color.altered}get valid(){return void 0!==this._fontFace&&this._fontFace.glyphTexture.valid&&this._text.length>0}}t.Label=c,c.DEFAULT_COLOR=[.1098,.4588,.7373,1],c.DEFAULT_ELLIPSIS="...",function(e){let t,r,i,n,s;!function(e){e.Static="static",e.Dynamic="dynamic"}(t=e.Type||(e.Type={})),function(e){e.None="none",e.Left="left",e.Middle="middle",e.Right="right"}(r=e.Elide||(e.Elide={})),function(e){e.Left="left",e.Center="center",e.Right="right"}(i=e.Alignment||(e.Alignment={})),function(e){e.Top="top",e.Ascent="ascent",e.Center="center",e.Baseline="baseline",e.Descent="descent",e.Bottom="bottom"}(n=e.LineAnchor||(e.LineAnchor={})),function(e){e.World="world",e.Pixel="pixel",e.Mixed="mixed"}(s=e.Unit||(e.Unit={}))}(c=t.Label||(t.Label={}))},8852:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelGeometry=void 0;const n=r(9696),s=r(6404),a=r(4894),o=r(1030);class c extends a.Geometry{constructor(e,t){super(e,t),this._numberOfGlyphs=0,n.assert(e.isWebGL2||e.supportsInstancedArrays,"expected extension 'ANGLE_instanced_arrays' to be supported"),t=void 0!==t&&""!==t?t:this.constructor.name,this._vertices=new s.Buffer(e,`${t}VBO`),this._buffers.push(this._vertices),this._texCoords=new s.Buffer(e,`${t}TexCoordVBO`),this._buffers.push(this._texCoords),this._origins=new s.Buffer(e,`${t}OriginVBO`),this._buffers.push(this._origins),this._tangents=new s.Buffer(e,`${t}TangentVBO`),this._buffers.push(this._tangents),this._ups=new s.Buffer(e,`${t}UpVBO`),this._buffers.push(this._ups)}bindBuffers(){const e=this.context.gl,t=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,e.FLOAT,!1,8,0,!0,!1),t.vertexAttribDivisor(this._vertexLocation,0),this._texCoords.attribEnable(this._texCoordLocation,4,e.FLOAT,!1,16,0,!0,!1),t.vertexAttribDivisor(this._texCoordLocation,1),this._origins.attribEnable(this._originLocation,3,e.FLOAT,!1,12,0,!0,!1),t.vertexAttribDivisor(this._originLocation,1),this._tangents.attribEnable(this._tangentLocation,3,e.FLOAT,!1,12,0,!0,!1),t.vertexAttribDivisor(this._tangentLocation,1),this._ups.attribEnable(this._upLocation,3,e.FLOAT,!1,12,0,!0,!1),t.vertexAttribDivisor(this._upLocation,1)}unbindBuffers(){this._vertices.attribDisable(this._vertexLocation,!1,!1),this._texCoords.attribDisable(this._texCoordLocation,!1,!1),this._origins.attribDisable(this._originLocation,!1,!1),this._tangents.attribDisable(this._tangentLocation,!1,!1),this._ups.attribDisable(this._upLocation,!1,!1)}initialize(e=0,t=1,r=2,i=3,n=4){this._vertexLocation=e,this._texCoordLocation=t,this._originLocation=r,this._tangentLocation=i,this._upLocation=n;const s=this.context.gl,a=super.initialize([s.ARRAY_BUFFER,s.ARRAY_BUFFER,s.ARRAY_BUFFER,s.ARRAY_BUFFER,s.ARRAY_BUFFER]);return this._vertices.data(c.VERTICES,s.STATIC_DRAW),a}update(e,t,r,i){this._numberOfGlyphs=e.length/3;const n=this.context.gl;this._texCoords.data(i,n.STATIC_DRAW),this._origins.data(e,n.STATIC_DRAW),this._tangents.data(t,n.STATIC_DRAW),this._ups.data(r,n.STATIC_DRAW)}draw(e=0,t=0){const r=this.context.gl,i=this.context.gl2facade;this._vertices.attribEnable(this._vertexLocation,2,r.FLOAT,!1,8,0,!0,!1),this._texCoords.attribEnable(this._texCoordLocation,4,r.FLOAT,!1,16,16*e,!0,!1),this._origins.attribEnable(this._originLocation,3,r.FLOAT,!1,12,12*e,!0,!1),this._tangents.attribEnable(this._tangentLocation,3,r.FLOAT,!1,12,12*e,!0,!1),this._ups.attribEnable(this._upLocation,3,r.FLOAT,!1,12,12*e,!0,!1),i.drawArraysInstanced(r.TRIANGLE_STRIP,0,4,t)}get numGlyphs(){return this._numberOfGlyphs}get valid(){const e=this._vertices&&this._vertices.valid,t=this._texCoords&&this._texCoords.valid,r=this._origins&&this._origins.valid,i=this._tangents&&this._tangents.valid,n=this._ups&&this._ups.valid;return this.initialized&&e&&t&&r&&i&&n}get vertexLocation(){return this._vertexLocation}get texCoordLocation(){return this._texCoordLocation}get originLocation(){return this._originLocation}get tangentLocation(){return this._tangentLocation}get upLocation(){return this._upLocation}}c.VERTICES=new Float32Array([0,0,0,1,1,0,1,1]),i([o.Initializable.assert_initialized()],c.prototype,"draw",null),t.LabelGeometry=c},8597:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.LabelRenderPass=void 0;const n=r(3659),s=r(9696),a=r(4597),o=r(1030),c=r(4895),h=r(5263),l=r(6942),u=r(7326),d=r(8733),_=r(8852),f=r(8254),p=r(8115),m=r(1648);class v extends o.Initializable{constructor(e){super(),this._altered=Object.assign(new a.ChangeLookup,{any:!1,camera:!1,geometry:!1,labels:!1,aaStepScale:!1,aaSampling:!1}),this._ndcOffset=[0,0],this._depthMask=!1,this._aaSampling=v.Sampling.Smooth1,this._labels=new Array,this._ranges=new Array,this._verticesPerLabel=new Array,this._context=e,this._depthFunc=e.gl.LESS,this._program=new c.Program(e,"LabelRenderProgram"),this._geometry=new _.LabelGeometry(this._context,"LabelGeometry"),this._aaStepScale=v.DEFAULT_AA_STEP_SCALE}prepare(){const e=this._camera.viewport;for(let t=0;t<this._labels.length;++t){const r=this._labels[t];let i;const n=this._altered.labels&&void 0===this._verticesPerLabel[t];r instanceof f.Position2DLabel?(r.frameSize=e,i=r.typeset(n)):r instanceof m.Projected3DLabel?(r.camera=this._camera,i=r.typeset(n)):r instanceof p.Position3DLabel&&(i=r.typeset(n)),void 0===i?i=this._verticesPerLabel[t]:this._verticesPerLabel[t]=i;const s=t>0?this._ranges[t-1][1]:0,a=s+(void 0===i?0:i.length);this._ranges[t]=[s,a]}const t=u.GlyphVertices.concat(this._verticesPerLabel);this._geometry.update(t.origins,t.tangents,t.ups,t.texCoords)}draw(){const e=this._context.gl,t=[0,0];let r,i;const s=n.mat4.create();for(let n=0;n<this._labels.length;++n){const a=this._labels[n];if(t[1]=this._ranges[n][1],t[0]===t[1]||n<this._labels.length-1&&!a.valid)continue;const o=n<this._labels.length-1?this._labels[n+1]:void 0,c=o&&a.type===d.Label.Type.Static&&o.type===d.Label.Type.Static,h=o&&a.color.equals(o.color),l=o&&a.fontFace===o.fontFace,u=o&&a.fontSizeUnit===o.fontSizeUnit;if(o&&(this._ranges[n+1][0]===this._ranges[n+1][1]||c&&h&&l&&u))continue;const _=a.type===d.Label.Type.Dynamic;switch(e.uniform1i(this._uDynamic,_),_&&e.uniformMatrix4fv(this._uTransform,!1,a.dynamicTransform),void 0!==r&&r.equals(a.color)||(e.uniform4fv(this._uColor,a.color.rgbaF32),r=a.color),i!==a.fontFace&&(a.fontFace.glyphTexture.bind(e.TEXTURE0),i=a.fontFace),a.fontSizeUnit){case d.Label.Unit.Pixel:e.uniformMatrix4fv(this._uViewProjection,!1,s);break;case d.Label.Unit.World:case d.Label.Unit.Mixed:default:e.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection)}this._geometry.draw(t[0],t[1]-t[0]),t[0]=t[1]}}initialize(){const e=this._context.gl;this._geometry.initialize(),this._context.enable(["OES_standard_derivatives"]);const t=new h.Shader(this._context,e.VERTEX_SHADER,"glyph.vert");t.initialize(r(1176));const i=new h.Shader(this._context,e.FRAGMENT_SHADER,"glyph.frag");return i.initialize(r(9761)),this._program.initialize([t,i],!1),this._program.attribute("a_vertex",this._geometry.vertexLocation),this._program.attribute("a_texCoord",this._geometry.texCoordLocation),this._program.attribute("a_origin",this._geometry.originLocation),this._program.attribute("a_tangent",this._geometry.tangentLocation),this._program.attribute("a_up",this._geometry.upLocation),this._program.link(),this._uViewProjection=this._program.uniform("u_viewProjection"),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uColor=this._program.uniform("u_color"),this._uAAStepScale=this._program.uniform("u_aaStepScale"),this._uAASampling=this._program.uniform("u_aaSampling"),this._uTransform=this._program.uniform("u_transform"),this._uDynamic=this._program.uniform("u_dynamic"),this._program.bind(),e.uniform1i(this._program.uniform("u_glyphs"),0),e.uniform1f(this._uAAStepScale,this._aaStepScale),e.uniform1i(this._uAASampling,this._aaSampling),this._program.unbind(),!0}uninitialize(){this._geometry.uninitialize(),this._program.uninitialize(),this._uViewProjection=void 0,this._uNdcOffset=void 0,this._uColor=void 0,this._uAAStepScale=void 0,this._uAASampling=void 0,this._uTransform=void 0,this._uDynamic=void 0}update(e=!1){const t=this._context.gl;this._program.bind(),(e||this._altered.camera||this._camera.altered)&&t.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),(e||this._altered.aaStepScale)&&t.uniform1f(this._uAAStepScale,this._aaStepScale),(e||this._altered.aaSampling)&&t.uniform1i(this._uAASampling,this._aaSampling);let r=e||this._altered.labels||this._altered.camera||this._camera.altered,i=0;for(;!1===r&&i<this._labels.length;)r=this._labels[i].altered,++i;r&&this.prepare(),this._altered.reset()}frame(){if(0===this._geometry.numGlyphs||0===this._labels.length)return;s.assert(this._target&&this._target.valid,"valid target expected");const e=this._context.gl,t=this._target.size;e.viewport(0,0,t[0],t[1]),e.enable(e.DEPTH_TEST),e.depthFunc(this._depthFunc),!1===this._depthMask&&e.depthMask(this._depthMask),e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),this._program.bind(),e.uniform2fv(this._uNdcOffset,this._ndcOffset),e.uniformMatrix4fv(this._uViewProjection,!1,this._camera.viewProjection),this._target.bind(),this._geometry.bind(),this.draw(),e.bindTexture(e.TEXTURE_2D,l.Texture2D.DEFAULT_TEXTURE),!1===this._depthMask&&e.depthMask(!0),e.depthFunc(e.LESS),e.disable(e.DEPTH_TEST),e.disable(e.BLEND)}unbind(){this._geometry.valid&&this._geometry.unbind(),this._program.valid&&this._program.unbind()}set target(e){this.assertInitialized(),this._target=e}set ndcOffset(e){this.assertInitialized(),this._ndcOffset=e}set camera(e){this.assertInitialized(),this._camera!==e&&(this._camera=e,this._altered.alter("camera"))}set depthMask(e){this._depthMask=e}get depthMask(){return this._depthMask}set depthFunc(e){this._depthFunc=e}get depthFunc(){return this._depthFunc}set labels(e){this._labels=e,this._ranges.length=this._labels.length,this._verticesPerLabel.length=this._labels.length,this._verticesPerLabel.fill(void 0),this._altered.alter("labels")}get labels(){return this._labels}set aaStepScale(e){this._aaStepScale!==e&&(this._aaStepScale=e,this._altered.alter("aaStepScale"))}get aaStepScale(){return this._aaStepScale}set aaSampling(e){this._aaSampling!==e&&(this._aaSampling=e,this._altered.alter("aaSampling"))}get aaSampling(){return this._aaSampling}get geometry(){return this._geometry}get program(){return this._program}}v.DEFAULT_AA_STEP_SCALE=.6666,i([o.Initializable.initialize()],v.prototype,"initialize",null),i([o.Initializable.uninitialize()],v.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],v.prototype,"update",null),i([o.Initializable.assert_initialized()],v.prototype,"frame",null),i([o.Initializable.assert_initialized()],v.prototype,"unbind",null),t.LabelRenderPass=v,function(e){let t;!function(e){e[e.None=0]="None",e[e.Smooth1=1]="Smooth1",e[e.Horizontal3=2]="Horizontal3",e[e.Vertical3=3]="Vertical3",e[e.Grid3x3=4]="Grid3x3",e[e.Grid4x4=5]="Grid4x4"}(t=e.Sampling||(e.Sampling={}))}(v=t.LabelRenderPass||(t.LabelRenderPass={}))},8254:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Position2DLabel=void 0;const i=r(3659),n=r(9696),s=r(2111),a=r(7326),o=r(8733),c=r(3210);class h extends o.Label{constructor(e,t,r){super(e,t,r),this._position=i.vec2.fromValues(0,0),this._direction=i.vec2.fromValues(1,0),this._frameSize=i.vec2.create(),this._fontSize=h.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=o.Label.Unit.Pixel}typeset(e=!1){const t=e||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!t&&!this._altered.dynamic&&!e)return;if(!this.valid)return new a.GlyphVertices(0);const r=i.vec4.create(),n=i.mat4.create();i.mat4.translate(n,s.m4(),i.vec3.fromValues(-1,-1,0)),i.mat4.scale(n,n,i.vec3.fromValues(2/this._frameSize[0],2/this._frameSize[1],1));const h=i.vec2.sub(s.v2(),i.vec2.fromValues(this._frameSize[0],this._frameSize[1]),i.vec2.fromValues(r[3]+r[1],r[2]+r[0])),l=i.vec3.fromValues(.5*h[0],.5*h[1],0);i.vec3.add(l,l,i.vec3.fromValues(r[3],r[2],0)),i.mat4.translate(n,n,l),i.mat4.translate(n,n,i.vec3.fromValues(this._position[0],this._position[1],0));const u=i.vec2.fromValues(1,0);let d=i.vec2.angle(u,this._direction);switch(u[0]*this._direction[1]-u[1]*this._direction[0]<0&&(d=-d),i.mat4.rotateZ(n,n,d),this._type){case o.Label.Type.Static:this.staticTransform=i.mat4.clone(n),this.dynamicTransform=s.m4();break;case o.Label.Type.Dynamic:this.staticTransform=s.m4(),this.dynamicTransform=i.mat4.clone(n)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!t)return;const _=this.vertices();return c.Typesetter.typeset(this,_),_}set frameSize(e){i.vec2.equals(this._frameSize,e)||(i.vec2.max(this._frameSize,e,[1,1]),this._altered.alter(this._type))}get frameSize(){return this._frameSize}set position(e){i.vec2.equals(this._position,e)||(this._position=i.vec2.clone(e),this._altered.alter(this._type))}get position(){return this._position}set direction(e){i.vec2.normalize(this._direction,e),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(e){n.logIf(e!==o.Label.Unit.Pixel,n.LogLevel.Warning,`font size unit other than 'px' are not supported in position-2d-label, given ${e}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position2DLabel=h,h.DEFAULT_FONTSIZE_PX=20},8115:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Position3DLabel=void 0;const i=r(3659),n=r(9696),s=r(2111),a=r(7326),o=r(8733),c=r(3210);class h extends o.Label{constructor(e,t,r){super(e,t,r),this._position=i.vec3.fromValues(0,0,0),this._direction=i.vec3.fromValues(1,0,0),this._up=i.vec3.fromValues(0,1,0),this._fontSize=h.DEFAULT_FONTSIZE_WORLD,this._fontSizeUnit=o.Label.Unit.World}typeset(e=!1){const t=e||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!t&&!this._altered.dynamic&&!e)return;if(!this.valid)return new a.GlyphVertices(0);const r=i.mat4.create();i.mat4.translate(r,s.m4(),this._position);const n=i.vec3.cross(s.v3(),this._direction,this._up),h=i.mat4.fromValues(this._direction[0],this._direction[1],this._direction[2],0,this._up[0],this._up[1],this._up[2],0,n[0],n[1],n[2],0,0,0,0,1);switch(i.mat4.mul(r,r,h),this._type){case o.Label.Type.Static:this.staticTransform=i.mat4.clone(r),this.dynamicTransform=s.m4();break;case o.Label.Type.Dynamic:this.staticTransform=s.m4(),this.dynamicTransform=i.mat4.clone(r)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!t)return;const l=this.vertices();return c.Typesetter.typeset(this,l),l}set position(e){this._position=i.vec3.clone(e),this._altered.alter(this._type)}get position(){return this._position}set direction(e){i.vec3.normalize(this._direction,e),this._altered.alter(this._type)}get direction(){return this._direction}set up(e){this._up=i.vec3.normalize(this._up,e),this._altered.alter(this._type)}get up(){return this._up}set fontSizeUnit(e){n.logIf(e!==o.Label.Unit.World,n.LogLevel.Warning,`font size unit other than 'world' are not supported in position-3d-label, given ${e}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Position3DLabel=h,h.DEFAULT_FONTSIZE_WORLD=.05},1648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Projected3DLabel=void 0;const i=r(3659),n=r(9696),s=r(2111),a=r(7326),o=r(8733),c=r(3210);class h extends o.Label{constructor(e,t,r){super(e,t,r),this._position=i.vec3.fromValues(0,0,0),this._direction=i.vec2.fromValues(1,0),this._fontSize=h.DEFAULT_FONTSIZE_PX,this._fontSizeUnit=o.Label.Unit.Mixed}typeset(e=!1){const t=e||this._altered.typesetting||this._altered.static||this._altered.text||this.text.altered;if(!t&&!this._altered.dynamic&&!e)return;if(!this.valid||void 0===this._camera)return new a.GlyphVertices(0);const r=i.vec4.create(),h=i.mat4.create();i.mat4.translate(h,h,i.vec3.fromValues(-1,-1,0)),i.mat4.scale(h,h,i.vec3.fromValues(2/this._camera.viewport[0],2/this._camera.viewport[1],1)),i.mat4.scale(h,h,i.vec3.fromValues(1,1,1));const l=i.vec2.create();i.vec2.sub(l,i.vec2.fromValues(this._camera.viewport[0]/1,this._camera.viewport[1]/1),i.vec2.fromValues(r[3]+r[1],r[2]+r[0]));const u=i.vec3.fromValues(.5*l[0],.5*l[1],0);i.vec3.add(u,u,i.vec3.fromValues(r[3],r[2],0)),i.mat4.translate(h,h,u);const d=i.vec4.fromValues(this._position[0],this._position[1],this._position[2],1);i.vec4.transformMat4(d,d,this._camera.viewProjection);const _=i.mat4.create(),f=d[3];i.mat4.translate(_,_,i.vec3.fromValues(d[0]/f,d[1]/f,d[2]/f)),i.mat4.mul(h,_,h);const p=i.vec2.fromValues(1,0);let m=i.vec2.angle(p,this._direction);switch(p[0]*this._direction[1]-p[1]*this._direction[0]<0&&(m=-m),i.mat4.rotateZ(h,h,m),this._camera.viewProjectionInverse?i.mat4.mul(h,this._camera.viewProjectionInverse,h):n.log(n.LogLevel.Warning,"camera.viewProjectionInverse is null"),this._type){case o.Label.Type.Static:this.staticTransform=i.mat4.clone(h),this.dynamicTransform=s.m4();break;case o.Label.Type.Dynamic:this.staticTransform=s.m4(),this.dynamicTransform=i.mat4.clone(h)}if(this._altered.reset(),this._text.altered=!1,this._color.altered=!1,!t)return;const v=this.vertices();return c.Typesetter.typeset(this,v),v}set camera(e){this._camera=e,this._altered.alter(this._type)}get camera(){return this._camera}set position(e){this._position=i.vec3.clone(e),this._altered.alter(this._type)}get position(){return this._position}set direction(e){i.vec2.normalize(this._direction,e),this._altered.alter(this._type)}get direction(){return this._direction}set fontSizeUnit(e){n.logIf(e!==o.Label.Unit.Mixed,n.LogLevel.Warning,`font size unit other than 'px' are not supported in projected-3d-label, given ${e}`)}get fontSizeUnit(){return this._fontSizeUnit}}t.Projected3DLabel=h,h.DEFAULT_FONTSIZE_PX=20},819:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0;class r{constructor(e,t){this._lineFeed=r.DEFAULT_LINE_FEED,this._altered=!1,this._text=e||"",this._lineFeed=void 0!==t?t:this._lineFeed}get length(){return this._text.length}charAt(e){return this._text.charAt(e)}charCodeAt(e){return this._text.charCodeAt(e)}set text(e){this._text!==e&&(this._altered=!0,this._text=e)}get text(){return this._text}set lineFeed(e){this._lineFeed!==e&&(this._altered=!0,this._lineFeed=e)}get lineFeed(){return this._lineFeed}set altered(e){this._altered=e}get altered(){return this._altered}}t.Text=r,r.DEFAULT_LINE_FEED="\n"},3210:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Typesetter=void 0;const i=r(3659),n=r(9696),s=r(2111),a=r(8733);class o{static writeVertex(e,t,r,n,s){if(void 0===n||!1===r.depictable())return;const a=e.glyphTexturePadding,o=n.origin(s);i.vec3.set(o,t[0],t[1],0),o[0]+=r.bearing[0]-a[3],o[1]+=r.bearing[1]-r.extent[1],i.vec3.set(n.tangent(s),r.extent[0],0,0),i.vec3.set(n.up(s),0,r.extent[1],0);const c=n.uvLowerLeft(s);i.vec2.copy(c,r.subTextureOrigin);const h=n.uvUpperRight(s);i.vec2.add(h,r.subTextureOrigin,r.subTextureExtent)}static lineAnchorOffset(e){let t=0;const r=e.fontFace.glyphTexturePadding,i=e.fontFace;switch(e.lineAnchor){case a.Label.LineAnchor.Ascent:t=i.ascent-r[0];break;case a.Label.LineAnchor.Descent:t=i.descent*(1+r[0]/i.ascent);break;case a.Label.LineAnchor.Center:t=i.ascent-r[0]-.5*i.size;break;case a.Label.LineAnchor.Top:t=i.ascent-r[0]+.5*i.lineGap;break;case a.Label.LineAnchor.Bottom:t=i.ascent-r[0]+.5*i.lineGap-i.lineHeight;break;case a.Label.LineAnchor.Baseline:default:t=-r[0]}return t}static advances(e,t){n.assert(void 0!==e.fontFace,"expected a font face for label in order to resolve advances"),void 0===t&&(t=e.text.text);const r=new Float32Array(t.length);for(let i=0;i<t.length;++i){const n=t.charCodeAt(i);r[i]=e.fontFace.glyph(n).advance}return r}static kernings(e,t){if(n.assert(void 0!==e.fontFace,"expected a font face for label in order to resolve kernings"),void 0===t){const t=new Float32Array(e.length);for(let r=0;r<e.length;++r){const i=e.kerningAfter(r);t[r]=isNaN(i)?0:i}return t}const r=new Float32Array(t.length);for(let n=0;n<t.length;++n){const s=(i=n)<0||i>t.length-1?NaN:e.fontFace.kerning(t.charCodeAt(i),t.charCodeAt(i+1));r[n]=isNaN(s)?0:s}var i;return r}static fragments(e){const t=new Array;let r,i=0;for(let n=0;n<e.length;++n){if(r=o.DELIMITERS.indexOf(e.charAt(n))>-1,!r)continue;i<n&&t.push([i,n,o.FragmentType.Word]);const s=e.lineFeedAt(n)?o.FragmentType.LineFeed:o.FragmentType.Delimiter;t.push([n,n+1,s]),i=n+1}return r||t.push([i,e.length,o.FragmentType.Word]),t}static fragmentWidths(e,t,r){const i=new Float32Array(e.length);for(let n=0;n<e.length;++n){const s=e[n];i[n]=t.subarray(s[0],s[1]).reduce(((e,t,i)=>e+t+(i<s[1]?r[i+s[0]]:0)),0)}return i}static elideThresholds(e,t){switch(e.elide){case a.Label.Elide.Right:return[e.lineWidth-t,0];case a.Label.Elide.Middle:const r=e.lineWidth/2-t/2;return[r,r];case a.Label.Elide.Left:return[0,e.lineWidth-t];default:return[0,0]}}static elideFragments(e,t,r,i,n,s){const a=new Array,c=new Array;let h=0,l=0;for(let u=s?t.length-1:0;s?u>-1:u<t.length;s?--u:++u){const d=t[u];if(d[2]!==o.FragmentType.LineFeed){if(!(h+r[u]<e)){if(d[2]===o.FragmentType.Delimiter||h+i[s?d[1]-1:d[0]]>e)break;for(let t=s?d[1]-1:d[0];s?t>=d[0]:t<d[1];s?--t:++t){if(!(h+l+i[t]+n[t]<e)){a.push([s?t+1:d[0],s?d[1]:t,d[2]]),c.push(l);break}l+=i[t]+n[t]}break}h+=r[u],a.push(d),c.push(r[u])}}return[a,c,h+l]}static transformVertices(e,t,r,n){if(void 0!==t&&!i.mat4.equals(e,i.mat4.create()))for(let a=r;a<n;++a){const r=t.origin(a),n=s.v3();i.vec3.transformMat4(n,r,e);const o=s.v3();i.vec3.transformMat4(o,i.vec3.add(o,r,t.tangent(a)),e);const c=s.v3();i.vec3.transformMat4(c,i.vec3.add(c,r,t.up(a)),e),i.vec3.copy(t.origin(a),n),i.vec3.sub(t.tangent(a),o,n),i.vec3.sub(t.up(a),c,n)}}static updateRectangleMinMax(e,t){n.assert(6===e.length&&6===t.length,"expected the rectangles to have 6 values!");let r=0;for(;r<3;r++)e[r]=Math.min(e[r],t[r]);for(;r<6;r++)e[r]=Math.max(e[r],t[r])}static minMax(e,t,r){const n=Math.min(e,...r),s=Math.max(t,...r);return i.vec2.fromValues(n,s)}static getMinMaxVertices(e,t,r){let i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY;for(let l=t;l<r;++l){const t=o.minMax(i,n,[e.origin(l)[0],e.origin(l)[0]+e.up(l)[0],e.origin(l)[0]+e.tangent(l)[0]]);i=t[0],n=t[1];const r=o.minMax(s,a,[e.origin(l)[1],e.origin(l)[1]+e.up(l)[1],e.origin(l)[1]+e.tangent(l)[1]]);s=r[0],a=r[1];const u=o.minMax(c,h,[e.origin(l)[2],e.origin(l)[2]+e.up(l)[2],e.origin(l)[2]+e.tangent(l)[2]]);c=u[0],h=u[1]}return[i,s,c,n,a,h]}static transformAlignment(e,t,r,i,n){if(void 0===r||t===a.Label.Alignment.Left)return;let s=-e;t===a.Label.Alignment.Center&&(s*=.5);for(let e=i;e<n;++e)r.origin(e)[0]+=s}static transform(e,t,r){const n=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const i of r)o.transformAlignment(i[2],e.alignment,t,i[0],i[1]),o.updateRectangleMinMax(n,o.getMinMaxVertices(t,i[0],i[1])),o.transformVertices(e.staticTransform,t,i[0],i[1]);const s=n[3]-n[0],a=n[4]-n[1],c=i.vec4.transformMat4(i.vec4.create(),i.vec4.fromValues(0,0,0,1),e.staticTransform),h=i.vec4.transformMat4(i.vec4.create(),i.vec4.fromValues(s,0,0,1),e.staticTransform),l=i.vec4.transformMat4(i.vec4.create(),i.vec4.fromValues(0,a,0,1),e.staticTransform),u=i.vec2.fromValues(i.vec4.distance(h,c),i.vec4.distance(l,c));e.extent=[u[0],u[1]]}static typeset(e,t){if(0===e.length)return 0;n.assert(void 0!==e.fontFace,"expected a font face for label before typesetting");const r=e.fontFace,s=t=>t<e.length?r.glyph(e.charCodeAt(t)):r.glyph(e.ellipsis.charCodeAt(t-e.length)),c=o.advances(e),h=o.kernings(e),l=o.fragments(e),u=o.fragmentWidths(l,c,h),d=i.vec2.fromValues(0,-o.lineAnchorOffset(e)),_=new Array;let f=0;const p=e.elide!==a.Label.Elide.None,m=(i,n,a=NaN,l=c,u=h,m=0)=>{let v=f;for(let a=0;a<i.length;++a){const c=i[a];if(c[0]>=c[1])continue;const h=!p&&c[2]===o.FragmentType.LineFeed;let g=!1;if(!p&&!h&&e.wrap){const t=c[2]!==o.FragmentType.Delimiter||s(c[0]).depictable(),r=c[2]===o.FragmentType.Word&&a<i.length-1&&i[a+1][2]===o.FragmentType.Delimiter&&s(i[a+1][0]).depictable();g=d[0]+(t?n[a]:0)+(r?n[a+1]:0)>e.lineWidth}if(!h&&!g||(_.push([v,f,d[0]]),v=f,d[0]=0,d[1]-=r.lineHeight,!h))for(let e=c[0];e<c[1];++e)s(e).depictable()&&(o.writeVertex(r,d,s(e),t,f),++f),d[0]+=l[e-m]+u[e-m]}v<f&&_.push([v,f,d[0]])},v=u.reduce(((e,t)=>e+t),0);if(p&&v>e.lineWidth){const t=[[e.length,e.length+e.ellipsis.length,o.FragmentType.Word]],r=o.advances(e,e.ellipsis),i=o.kernings(e,e.ellipsis),s=o.fragmentWidths([[0,e.ellipsis.length,o.FragmentType.Word]],r,i),f=s[0];if(e.lineWidth<f)return 0;const p=o.elideThresholds(e,f),[v,g,b]=o.elideFragments(p[0],l,u,c,h,!1);e.elide===a.Label.Elide.Middle&&(p[1]+=p[0]-b);const[E,y]=o.elideFragments(p[1],l,u,c,h,!0);m(v,new Float32Array(g)),m(t,s,NaN,r,i,e.length),m(E.reverse(),new Float32Array(y.reverse())),n.assert(_.length<4,`expected at most 3-line-yield from advance, given ${_}`),_[0][1]=_[_.length-1][1],_[0][2]=d[0],_.length=1}else m(l,u,e.lineWidth);return o.transform(e,t,_),t.shrink(f),f}}t.Typesetter=o,o.DELIMITERS="\n ,.-/()[]<>",function(e){let t;!function(e){e[e.Word=0]="Word",e[e.Delimiter=1]="Delimiter",e[e.LineFeed=2]="LineFeed"}(t=e.FragmentType||(e.FragmentType={}))}(o=t.Typesetter||(t.Typesetter={}))},6942:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2D=void 0;const n=r(9696),s=r(423),a=r(1030),o=r(2281);class c extends o.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._internalFormat=0,this._format=0,this._type=0,this._mipmap=!1,this._anisotropy=void 0}create(e,t,r,i,s){n.assert(e>0&&t>0,"texture requires valid width and height of greater than zero");const a=this._context.gl,o=this._context.gl2facade;if(this._object=a.createTexture(),this._width=e,this._height=t,this._internalFormat=r,this._format=i,this._type=s,a.bindTexture(a.TEXTURE_2D,this._object),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),void 0===c.MAX_ANISOTROPY)if(this._context.supportsTextureFilterAnisotropic){const e=this._context.textureFilterAnisotropic;c.MAX_ANISOTROPY=a.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else c.MAX_ANISOTROPY=0;return o.texImage2D(a.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),a.bindTexture(a.TEXTURE_2D,c.DEFAULT_TEXTURE),this._valid=a.isTexture(this._object),this.reallocate(),this._object}delete(){n.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0}reallocate(){const e=this.context.gl,t=this._context.gl2facade;let r=this._width*this._height*s.byteSizeOfFormat(this.context,this._internalFormat);this._type===t.HALF_FLOAT&&this._internalFormat!==e.RGBA16F?r*=2:this._type===e.FLOAT&&this._internalFormat!==e.RGBA16F&&(r*=4),this.context.allocationRegister.reallocate(this._identifier,r)}bind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,this._object)}unbind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,c.DEFAULT_TEXTURE)}fetch(e,t=!1,r=!1){const i=this.context.gl;return new Promise(((s,a)=>{const o=new Image;o.onerror=()=>{n.log(n.LogLevel.Error,`loading image from '${o.src}' failed`),a()},o.onload=()=>{this.resize(o.width,o.height),r||i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),this.data(o),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),s()},t&&(o.crossOrigin="anonymous"),o.src=e}))}data(e,t=!0,r=!0){const i=this.context.gl,n=this._context.gl2facade;t&&this.bind(),n.texImage2D(i.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,e),void 0!==this._anisotropy&&this._anisotropy>0?this.maxAnisotropy(this._anisotropy,!1,!1):this._mipmap&&this.generateMipMap(!1,!1),r&&this.unbind(),this.reallocate()}filter(e,t,r=!0,i=!0){const s=this.context.gl;r&&this.bind(),n.logIf(e===s.LINEAR_MIPMAP_LINEAR||e===s.LINEAR_MIPMAP_NEAREST,n.LogLevel.Debug,"magnification does not utilize a MipMap (refer to LINEAR and NEAREST only)"),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,t),this._mipmap=t===s.LINEAR_MIPMAP_LINEAR||t===s.LINEAR_MIPMAP_NEAREST,this._mipmap&&s.generateMipmap(s.TEXTURE_2D),i&&this.unbind()}wrap(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),i&&this.unbind()}reformat(e,t,r,i=!0,s=!0){(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(n.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data(void 0,i,s))}resize(e,t,r=!0,i=!0){e===this._width&&t===this._height||(this._width=e,this._height=t,this.data(void 0,r,i))}generateMipMap(e=!0,t=!0){const r=this.context.gl;e&&this.bind(),r.generateMipmap(r.TEXTURE_2D),t&&this.unbind(),this._mipmap=!0}maxAnisotropy(e,t=!0,r=!0){if(!1===this._context.supportsTextureFilterAnisotropic)return void n.log(n.LogLevel.Debug,"setting anisotropy not supported (EXT_texture_filter_anisotropic missing)");const i=this.context.gl,s=this._context.textureFilterAnisotropic;return this._anisotropy=void 0===e?void 0:Math.max(0,Math.min(c.MAX_ANISOTROPY,e)),n.logIf(e!==this._anisotropy,n.LogLevel.Debug,`value clamped to max supported anisotropy of ${c.MAX_ANISOTROPY}, given ${e}`),t&&this.bind(),i.texParameterf(i.TEXTURE_2D,s.TEXTURE_MAX_ANISOTROPY_EXT,void 0===this._anisotropy?0:this._anisotropy),this.generateMipMap(!1,r),this._anisotropy}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get size(){return this.assertInitialized(),[this._width,this._height]}}c.DEFAULT_TEXTURE=void 0,c.MAX_ANISOTROPY=void 0,i([a.Initializable.assert_initialized()],c.prototype,"bind",null),i([a.Initializable.assert_initialized()],c.prototype,"unbind",null),i([a.Initializable.assert_initialized()],c.prototype,"fetch",null),i([a.Initializable.assert_initialized()],c.prototype,"data",null),i([a.Initializable.assert_initialized()],c.prototype,"filter",null),i([a.Initializable.assert_initialized()],c.prototype,"wrap",null),i([a.Initializable.assert_initialized()],c.prototype,"reformat",null),i([a.Initializable.assert_initialized()],c.prototype,"resize",null),t.Texture2D=c},4850:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture2DArray=void 0;const n=r(9696),s=r(423),a=r(1030),o=r(2281);class c extends o.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(e,t,r,i,s,a){n.assert(this._context.supportsTexImage3D,"expected texImage3D to be supported"),n.assert(e>0&&t>0&&r>0,"texture requires valid width, height, and depth of greater than zero");const o=this._context.gl,h=this._context.gl2facade;return this._object=o.createTexture(),this._width=e,this._height=t,this._depth=r,this._internalFormat=i,this._format=s,this._type=a,o.bindTexture(o.TEXTURE_2D_ARRAY,this._object),o.texParameteri(o.TEXTURE_2D_ARRAY,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D_ARRAY,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D_ARRAY,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D_ARRAY,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D_ARRAY,o.TEXTURE_WRAP_R,o.CLAMP_TO_EDGE),h.texImage3D(o.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),o.bindTexture(o.TEXTURE_2D_ARRAY,c.DEFAULT_TEXTURE),this._valid=o.isTexture(this._object),this.reallocate(),this._object}delete(){n.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const e=this.context.gl,t=this._context.gl2facade;let r=this._width*this._height*this._depth*s.byteSizeOfFormat(this.context,this._internalFormat);this._type===t.HALF_FLOAT&&this._internalFormat!==e.RGBA16F?r*=2:this._type===e.FLOAT&&this._internalFormat!==e.RGBA16F&&(r*=4),this.context.allocationRegister.reallocate(this._identifier,r)}bind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_2D_ARRAY,this._object)}unbind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_2D_ARRAY,c.DEFAULT_TEXTURE)}fetch(e,t,r=!1){return new Promise(((i,s)=>{const a=new Image;a.onerror=()=>{n.log(n.LogLevel.Error,`loading image from '${a.src}' failed`),s()},a.onload=()=>{this.resize(a.width,a.height/t,t),this.data(a),i()},r&&(a.crossOrigin="anonymous"),a.src=e}))}data(e,t=!0,r=!0){const i=this.context.gl,n=this._context.gl2facade;t&&this.bind(),n.texImage3D(i.TEXTURE_2D_ARRAY,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,e),r&&this.unbind(),this.reallocate()}filter(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.texParameteri(n.TEXTURE_2D_ARRAY,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D_ARRAY,n.TEXTURE_MIN_FILTER,t),i&&this.unbind()}wrap(e,t,r,i=!0,n=!0){const s=this.context.gl;i&&this.bind(),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_WRAP_T,t),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_WRAP_R,r),n&&this.unbind()}reformat(e,t,r,i=!0,s=!0){(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(n.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data(void 0,i,s))}resize(e,t,r,i=!0,n=!0){e===this._width&&t===this._height&&r===this._depth||(this._width=e,this._height=t,this._depth=r,this.data(void 0,i,n))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}c.DEFAULT_TEXTURE=void 0,i([a.Initializable.assert_initialized()],c.prototype,"bind",null),i([a.Initializable.assert_initialized()],c.prototype,"unbind",null),i([a.Initializable.assert_initialized()],c.prototype,"fetch",null),i([a.Initializable.assert_initialized()],c.prototype,"data",null),i([a.Initializable.assert_initialized()],c.prototype,"filter",null),i([a.Initializable.assert_initialized()],c.prototype,"wrap",null),i([a.Initializable.assert_initialized()],c.prototype,"reformat",null),i([a.Initializable.assert_initialized()],c.prototype,"resize",null),t.Texture2DArray=c},7344:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Texture3D=void 0;const n=r(9696),s=r(423),a=r(1030),o=r(2281);class c extends o.AbstractObject{constructor(){super(...arguments),this._width=0,this._height=0,this._depth=0,this._internalFormat=0,this._format=0,this._type=0}create(e,t,r,i,s,a){n.assert(this._context.supportsTexImage3D,"expected texImage3D to be supported"),n.assert(e>0&&t>0&&r>0,"texture requires valid width, height, and depth of greater than zero");const o=this._context.gl,h=this._context.gl2facade;return this._object=o.createTexture(),this._width=e,this._height=t,this._depth=r,this._internalFormat=i,this._format=s,this._type=a,o.bindTexture(o.TEXTURE_3D,this._object),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_3D,o.TEXTURE_WRAP_R,o.CLAMP_TO_EDGE),h.texImage3D(o.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type),o.bindTexture(o.TEXTURE_3D,c.DEFAULT_TEXTURE),this._valid=o.isTexture(this._object),this.reallocate(),this._object}delete(){n.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0,this._depth=0}reallocate(){const e=this.context.gl,t=this._context.gl2facade;let r=this._width*this._height*this._depth*s.byteSizeOfFormat(this.context,this._internalFormat);this._type===t.HALF_FLOAT&&this._internalFormat!==e.RGBA16F?r*=2:this._type===e.FLOAT&&this._internalFormat!==e.RGBA16F&&(r*=4),this.context.allocationRegister.reallocate(this._identifier,r)}bind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_3D,this._object)}unbind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_3D,c.DEFAULT_TEXTURE)}load(e,t,r=!1,i=!1){return new Promise(((s,a)=>{const o=new Image;o.onerror=()=>a(),o.onload=()=>{const e=document.createElement("canvas"),r=e.getContext("2d");let a,c,h,l;if(n.assert(void 0!==r,"expected auxiliary 2D context for temporary slicing"),!1===i){n.assert(o.height%t==0&&o.height/t>=1,"expected height to be a multitude of number of slices"),a=o.width,c=Math.floor(o.height/t),h=t,e.width=a,e.height=c,l=new Uint8Array(a*c*h);const i=a*c;for(let e=0;e<t;++e){r.drawImage(o,0,c*e,a,c,0,0,a,c);const t=r.getImageData(0,0,a,c).data;for(let r=0;r<i;++r)l[i*e+r]=t[4*r]}}else{n.assert(o.width%t==0&&o.width/t>=1,"expected width to be a multitude of number of slices"),a=Math.floor(o.width/t),c=o.height,h=t,e.width=a,e.height=c,l=new Uint8Array(a*c*h);const i=a*c;for(let e=0;e<t;++e){r.drawImage(o,a*e,0,a,c,0,0,a,c);const t=r.getImageData(0,0,a,c).data;for(let r=0;r<i;++r)l[i*e+r]=t[4*r]}}this.resize(a,c,h),this.data(l),s()},r&&(o.crossOrigin="anonymous"),o.src=e}))}loadFromSingleImages(e,t,r=!1,i=!1){return new Promise(((s,a)=>{const o=document.createElement("canvas"),c=o.getContext("2d"),h=[];let l,u;for(let t=0;t<e.length;t++){const s=new Image;s.onerror=()=>a();const d=new Promise(((r,a)=>{try{s.onload=()=>{const a=s.width,h=s.height;!1===i?(void 0===l?(l=a*e.length,o.width=l):n.assert(a*e.length===l,"The single images do not have the same width"),void 0===u?(u=h,o.height=u):n.assert(h===u,"The single images do not have the same height"),c.drawImage(s,a*t,0)):(void 0===l?(l=a,o.width=l):n.assert(a===l,"The single images do not have the same width"),void 0===u?(u=h*e.length,o.height=u):n.assert(h*e.length===u,"The single images do not have the same height"),c.drawImage(s,0,h*t)),r()}}catch(e){a(e)}}));h.push(d),r&&(s.crossOrigin="anonymous"),s.src=e[t]}Promise.all(h).then((()=>{const e=o.toDataURL("image/png",1);return this.load(e,t,r,i).then((()=>{s()}))}))}))}data(e,t=!0,r=!0){const i=this.context.gl,n=this._context.gl2facade;t&&this.bind(),n.texImage3D(i.TEXTURE_3D,0,this._internalFormat,this._width,this._height,this._depth,0,this._format,this._type,e),r&&this.unbind(),this.reallocate()}filter(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_3D,n.TEXTURE_MIN_FILTER,t),i&&this.unbind()}wrap(e,t,r,i=!0,n=!0){const s=this.context.gl;i&&this.bind(),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_T,t),s.texParameteri(s.TEXTURE_3D,s.TEXTURE_WRAP_R,r),n&&this.unbind()}reformat(e,t,r,i=!0,s=!0){(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(n.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data(void 0,i,s))}resize(e,t,r,i=!0,n=!0){e===this._width&&t===this._height&&r===this._depth||(this._width=e,this._height=t,this._depth=r,this.data(void 0,i,n))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get width(){return this.assertInitialized(),this._width}get height(){return this.assertInitialized(),this._height}get depth(){return this.assertInitialized(),this._depth}get size(){return this.assertInitialized(),[this._width,this._height,this._depth]}}c.DEFAULT_TEXTURE=void 0,i([a.Initializable.assert_initialized()],c.prototype,"bind",null),i([a.Initializable.assert_initialized()],c.prototype,"unbind",null),i([a.Initializable.assert_initialized()],c.prototype,"load",null),i([a.Initializable.assert_initialized()],c.prototype,"loadFromSingleImages",null),i([a.Initializable.assert_initialized()],c.prototype,"data",null),i([a.Initializable.assert_initialized()],c.prototype,"filter",null),i([a.Initializable.assert_initialized()],c.prototype,"wrap",null),i([a.Initializable.assert_initialized()],c.prototype,"reformat",null),i([a.Initializable.assert_initialized()],c.prototype,"resize",null),t.Texture3D=c},945:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureCube=void 0;const n=r(9696),s=r(423),a=r(1030),o=r(2281);class c extends o.AbstractObject{constructor(){super(...arguments),this._size=0,this._internalFormat=0,this._format=0,this._type=0,this._bytes=[0,0,0,0,0,0]}faceID(e){const t=this._context.gl;switch(e){case t.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case t.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case t.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case t.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case t.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case t.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return n.assert(!1,`expected texture cube map identifier (${t.TEXTURE_CUBE_MAP_POSITIVE_X}, ${t.TEXTURE_CUBE_MAP_NEGATIVE_X}, ${t.TEXTURE_CUBE_MAP_POSITIVE_Y}, ${t.TEXTURE_CUBE_MAP_NEGATIVE_Y}, ${t.TEXTURE_CUBE_MAP_POSITIVE_Z}, or${t.TEXTURE_CUBE_MAP_NEGATIVE_Z}), given ${e}`),-1}}create(e,t,r,i){n.assert(e>0,"texture cube requires valid size (width/height) of greater than zero");const s=this._context.gl,a=this._context.gl2facade;return this._object=s.createTexture(),this._size=e,this._internalFormat=t,this._format=r,this._type=i,s.bindTexture(s.TEXTURE_CUBE_MAP,this._object),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.texImage2D(s.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.texImage2D(s.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.texImage2D(s.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.bindTexture(s.TEXTURE_CUBE_MAP,c.DEFAULT_TEXTURE),this._valid=s.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object}delete(){n.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0}cropImage(e,t,r,i,s){const a=document.createElement("canvas");a.width=i,a.height=s;const o=a.getContext("2d");return o?(o.drawImage(e,t,r,i,s,0,0,i,s),o.getImageData(0,0,i,s)):(console.log(n.LogLevel.Warning,"2D context creation failed when cropping image."),new ImageData(0,0))}extractMipLevelFromAtlas(e,t){const r=this.context.gl,i=e.height/2*Math.pow(.5,t),n=[0,0],s=[e.width,e.height];for(let e=0;e<t;++e)s[0]/=2,s[1]/=2,n[0]+=s[0],n[1]+=s[1];r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);const a=this.cropImage(e,n[0],n[1],i,i);this.data([r.TEXTURE_CUBE_MAP_NEGATIVE_X,a],t);const o=this.cropImage(e,n[0]+i,n[1],i,i);this.data([r.TEXTURE_CUBE_MAP_POSITIVE_Z,o],t);const c=this.cropImage(e,n[0]+2*i,n[1],i,i);this.data([r.TEXTURE_CUBE_MAP_POSITIVE_X,c],t);const h=this.cropImage(e,n[0]+3*i,n[1],i,i);this.data([r.TEXTURE_CUBE_MAP_NEGATIVE_Z,h],t);const l=this.cropImage(e,n[0],n[1]+i,i,i);this.data([r.TEXTURE_CUBE_MAP_POSITIVE_Y,l],t);const u=this.cropImage(e,n[0]+i,n[1]+i,i,i);this.data([r.TEXTURE_CUBE_MAP_NEGATIVE_Y,u],t),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1)}bind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_CUBE_MAP,this._object)}unbind(e){const t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_CUBE_MAP,c.DEFAULT_TEXTURE)}fetch(e,t=!1,r=0){const i=this.context.gl;return new Promise(((s,a)=>{const o=new Array;e.positiveX&&o.push([i.TEXTURE_CUBE_MAP_POSITIVE_X,e.positiveX]),e.negativeX&&o.push([i.TEXTURE_CUBE_MAP_NEGATIVE_X,e.negativeX]),e.positiveY&&o.push([i.TEXTURE_CUBE_MAP_POSITIVE_Y,e.positiveY]),e.negativeY&&o.push([i.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.negativeY]),e.positiveZ&&o.push([i.TEXTURE_CUBE_MAP_POSITIVE_Z,e.positiveZ]),e.negativeZ&&o.push([i.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.negativeZ]);let c=o.length;for(const e of o){const o=new Image;o.crossOrigin="anonymous",o.onerror=()=>a(),o.onload=()=>{const t=this.calculateMipLevelSize(r);o.width===o.height?o.width===t?(i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),this.data([e[0],o],r),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),c-=1,0===c&&s()):n.log(n.LogLevel.Warning,`image ignored, width and height expected to match this texture's size ${t}, given ${o.width}`):n.log(n.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},t&&(o.crossOrigin="anonymous"),o.src=e[1]}}))}fetchMipmapAtlas(e,t=!1){return new Promise(((r,i)=>{const s=new Image;s.onerror=()=>i(),s.onload=()=>{if(s.width!==2*s.height)return void n.log(n.LogLevel.Warning,"Mipmap atlas expected to have dimensions of 2x1.");const e=s.height/2,t=Math.log2(e);for(let e=0;e<t;++e)this.extractMipLevelFromAtlas(s,e);r()},t&&(s.crossOrigin="anonymous"),s.src=e}))}calculateMipLevelSize(e){return this._size*Math.pow(.5,e)}data(e,t=0,r=!0,i=!0){const n=this.context.gl,a=this.context.gl2facade,o=this.calculateMipLevelSize(t);let c=o*o*s.byteSizeOfFormat(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?c*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(c*=4),r&&this.bind(),e instanceof Array&&2===e.length){a.texImage2D(e[0],t,this._internalFormat,o,o,0,this._format,this._type,e[1]);const r=this.faceID(e[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[r]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[r]=c}else{const r=e;void 0!==r.positiveX&&(a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X,t,this._internalFormat,o,o,0,this._format,this._type,r.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[0]=c),void 0!==r.negativeX&&(a.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_X,t,this._internalFormat,o,o,0,this._format,this._type,r.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[1]=c),void 0!==r.positiveY&&(a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Y,t,this._internalFormat,o,o,0,this._format,this._type,r.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[2]=c),void 0!==r.negativeY&&(a.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Y,t,this._internalFormat,o,o,0,this._format,this._type,r.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[3]=c),void 0!==r.positiveZ&&(a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Z,t,this._internalFormat,o,o,0,this._format,this._type,r.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[4]=c),void 0!==r.negativeZ&&(a.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Z,t,this._internalFormat,o,o,0,this._format,this._type,r.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,c),this._bytes[5]=c)}i&&this.unbind()}filter(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,t),i&&this.unbind()}wrap(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_WRAP_T,t),i&&this.unbind()}levels(e,t,r=!0,i=!0){const n=this.context.gl;r&&this.bind(),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_BASE_LEVEL,e),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_LEVEL,t),i&&this.unbind()}reformat(e,t,r,i=!0,s=!0){(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(n.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data({clearOnUndefined:!0},0,i,s))}resize(e,t=!0,r=!0){e!==this._size&&(this._size=e,this.data({clearOnUndefined:!0},0,t,r))}get bytes(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)}get internalFormat(){return this.assertInitialized(),this._internalFormat}get format(){return this.assertInitialized(),this._format}get type(){return this.assertInitialized(),this._type}get size(){return this.assertInitialized(),this._size}}c.DEFAULT_TEXTURE=void 0,i([a.Initializable.assert_initialized()],c.prototype,"bind",null),i([a.Initializable.assert_initialized()],c.prototype,"unbind",null),i([a.Initializable.assert_initialized()],c.prototype,"fetch",null),i([a.Initializable.assert_initialized()],c.prototype,"fetchMipmapAtlas",null),i([a.Initializable.assert_initialized()],c.prototype,"data",null),i([a.Initializable.assert_initialized()],c.prototype,"filter",null),i([a.Initializable.assert_initialized()],c.prototype,"wrap",null),i([a.Initializable.assert_initialized()],c.prototype,"levels",null),i([a.Initializable.assert_initialized()],c.prototype,"reformat",null),i([a.Initializable.assert_initialized()],c.prototype,"resize",null),t.TextureCube=c},339:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TileCameraGenerator=void 0;const i=r(3659),n=r(2111),s=r(9696);class a{constructor(){this._tileSize=[0,0],this._padding=i.vec4.fromValues(0,0,0,0),this._tile=-1,this._algorithm=a.Algorithm.ScanLine,this._offset=[0,0]}static hilbertIndices(e,t,r,i,n,s,a,o,c,h,l){if(h>0)return l=this.hilbertIndices(e,t,r,i,n,o/2,c/2,s/2,a/2,h-1,l),l=this.hilbertIndices(e,t,r,i+s/2,n+a/2,s/2,a/2,o/2,c/2,h-1,l),l=this.hilbertIndices(e,t,r,i+s/2+o/2,n+a/2+c/2,s/2,a/2,o/2,c/2,h-1,l),this.hilbertIndices(e,t,r,i+s/2+o,n+a/2+c,-o/2,-c/2,-s/2,-a/2,h-1,l);if(n+=(a+c-1)/2,(i+=(s+o-1)/2)<t&&n<r){const t=2*l;e[t+0]=i,e[t+1]=n,++l}return l}static generateHilbertIndices(e,t,r){s.assert(e.length===2*t*r,`expected interleaved indices-array of length ${2*t*r}, given ${e.length}`);const i=Math.max(t,r),n=Math.ceil(Math.log2(i)),a=s.upperPowerOfTwo(i);this.hilbertIndices(e,t,r,0,0,a,0,0,a,n,0)}static generateScanLineIndices(e,t,r){s.assert(e.length===2*t*r,`expected interleaved indices-array of length ${2*t*r}, given ${e.length}`);for(let i=0;i<r;++i)for(let r=0;r<t;++r){const n=2*(r+i*t);e[n+0]=r,e[n+1]=i}}static generateZCurveIndices(e,t,r){s.assert(e.length===2*t*r,`expected interleaved indices-array of length ${2*t*r}, given ${e.length}`);const i=Math.max(t,r),n=2*Math.floor(Math.log2(i));let a=0;for(let i=0;i<t*r;++a){let s=0,o=0;for(let e=0;e<n;++e)s+=(a>>2*e&1)<<e,o+=(a>>2*e+1&1)<<e;if(s<t&&o<r){const t=2*i;e[t+0]=s,e[t+1]=o,++i}}}invalidate(e){e&&(this._indices=new Uint16Array(0)),this._valid=!1}ensureValidIterationIndices(){if(!(this._indices.length>0))switch(this._indices=new Uint16Array(2*this.numTiles),this._algorithm){case a.Algorithm.ScanLine:a.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles);break;case a.Algorithm.HilbertCurve:a.generateHilbertIndices(this._indices,this.numXTiles,this.numYTiles);break;case a.Algorithm.ZCurve:a.generateZCurveIndices(this._indices,this.numXTiles,this.numYTiles);break;default:a.generateScanLineIndices(this._indices,this.numXTiles,this.numYTiles)}}tableIndices(){this.ensureValidIterationIndices();const e=2*this.tile;return[this._indices[e+0],this._indices[e+1]]}getPaddedTileSize(){return[this.padding[1]+this.padding[3]+this.tileSize[0],this.padding[0]+this.padding[2]+this.tileSize[1]]}nextTile(){return!(this.tile>=this.numTiles-1||(this.tile<0&&(this.tile=-1),++this.tile,this.update(),0))}hasNextTile(){return this.tile<=this.numTiles-1&&this.tile>=0}reset(){this.tile=-1,this._offset[0]=0,this._offset[1]=0}sourceCameraChanged(){s.assert(void 0!==this._sourceCamera,"expected the unput/source camera to be defined"),this._camera=Object.create(this._sourceCamera)}update(){if(this._valid)return this._offset;if(this.numTiles<=this.tile||0>this.tile)return s.log(s.LogLevel.Warning,`index ${this.tile} is out of bounds ${this.numTiles}, returning first tile`),this._offset;s.assert(void 0!==this._sourceViewport&&void 0!==this._sourceCamera,"expected source camera and source viewport to be defined before updating"),this._valid=!0;const e=this.tableIndices(),t=this.sourceViewport,r=this.getPaddedTileSize(),a=[0,0];a[0]=e[0]*this.tileSize[0]+r[0]/2,a[1]=e[1]*this.tileSize[1]+r[1]/2;const o=[0,0];o[0]=e[0]*this.tileSize[0],o[1]=e[1]*this.tileSize[1];const c=[2*a[0]/t[0]-1,2*a[1]/t[1]-1],h=i.vec3.fromValues(t[0]/r[0],t[1]/r[1],1),l=i.vec3.fromValues(-c[0],-c[1],0),u=i.mat4.scale(n.m4(),i.mat4.identity(n.m4()),h),d=i.mat4.translate(n.m4(),u,l);return this._camera.postViewProjection=d,this._offset=o,o}get valid(){return void 0!==this._camera&&void 0!==this._sourceCamera&&this._valid}get numXTiles(){return s.assert(void 0!==this._sourceViewport,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[0]/this.tileSize[0])}get numYTiles(){return s.assert(void 0!==this._sourceViewport,"expected the source viewport to be defined"),Math.ceil(this.sourceViewport[1]/this.tileSize[1])}get numTiles(){return this.numXTiles*this.numYTiles}get offset(){return this._offset}get camera(){return this._camera}get viewport(){return[this.offset[0],this.offset[1],this.tileSize[0],this.tileSize[1]]}get sourceCamera(){return this._sourceCamera}set sourceCamera(e){void 0!==e?(this._sourceCamera=e,this._camera=Object.create(e),this.invalidate(!1)):this._sourceCamera=this._camera=void 0}get tile(){return this._tile}set tile(e){this._tile!==e&&(this._tile=e,this.invalidate(!1))}get sourceViewport(){return this._sourceViewport}set sourceViewport(e){void 0!==this._sourceViewport&&void 0!==e&&this._sourceViewport[0]===e[0]&&this._sourceViewport[1]===e[1]||(this._sourceViewport=e,this.invalidate(!0))}get tileSize(){return this._tileSize}set tileSize(e){this._tileSize[0]===e[0]&&this._tileSize[1]===e[1]||(this._tileSize=e,this.invalidate(!0))}get padding(){return this._padding}set padding(e){i.vec4.equals(this._padding,e)||(this._padding=i.vec4.clone(e),this.invalidate(!1))}get algorithm(){return this._algorithm}set algorithm(e){this._algorithm!==e&&(this._algorithm=e,this.invalidate(!0))}}t.TileCameraGenerator=a,function(e){let t;!function(e){e.ScanLine="scanline",e.HilbertCurve="hilbertcurve",e.ZCurve="zcurve"}(t=e.Algorithm||(e.Algorithm={}))}(a=t.TileCameraGenerator||(t.TileCameraGenerator={}))},4052:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TouchEventProvider=void 0;const i=r(9130),n=r(9696);class s{constructor(e,t){n.assert(void 0!==e,`expected valid canvas element on initialization, given ${e}`),this._element=e,this._timeframe=t}preventDefaultOnEvent(e,t){n.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()}preventDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)||(this._preventDefaultMask|=t)}allowDefault(...e){for(const t of e)n.bitInBitfield(this._preventDefaultMask,t)&&(this._preventDefaultMask&=~t)}observable(e){switch(e){case s.Type.Start:return this.start$;case s.Type.End:return this.end$;case s.Type.Move:return this.move$;case s.Type.Cancel:return this.cancel$}return n.assert(!1,"Encountered unknown touch event."),new i.Observable}get start$(){return void 0===this._startSubject&&(this._startSubject=new i.ReplaySubject(void 0,this._timeframe),this._startListener=e=>{this.preventDefaultOnEvent(s.Type.Start,e),this._startSubject.next(e)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()}get end$(){return void 0===this._endSubject&&(this._endSubject=new i.ReplaySubject(void 0,this._timeframe),this._endListener=e=>{this.preventDefaultOnEvent(s.Type.End,e),this._endSubject.next(e)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()}get move$(){return void 0===this._moveSubject&&(this._moveSubject=new i.ReplaySubject(void 0,this._timeframe),this._moveListener=e=>{this.preventDefaultOnEvent(s.Type.Move,e),this._moveSubject.next(e)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()}get cancel$(){return void 0===this._cancelSubject&&(this._cancelSubject=new i.ReplaySubject(void 0,this._timeframe),this._cancelListener=e=>{this.preventDefaultOnEvent(s.Type.Cancel,e),this._cancelSubject.next(e)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()}}t.TouchEventProvider=s,function(e){let t;!function(e){e[e.Start=1]="Start",e[e.End=2]="End",e[e.Move=4]="Move",e[e.Cancel=8]="Cancel"}(t=e.Type||(e.Type={}))}(s=t.TouchEventProvider||(t.TouchEventProvider={}))},2763:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackballModifier=void 0;const i=r(3659),n=r(2111),s=r(6491);class a extends s.CameraModifier{constructor(){super(...arguments),this._rotation=i.mat4.create(),this._sensitivity=a.DEFAULT_SENSITIVITY}initiate(e){this._initialPoint=e}process(e){this._currentPoint=e;const t=i.vec2.subtract(n.v2(),this._initialPoint,this._currentPoint);i.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity),i.vec2.copy(this._initialPoint,this._currentPoint);const r=i.vec3.sub(n.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(r,r);const s=i.vec3.normalize(n.v3(),this._reference.up),a=i.vec3.cross(n.v3(),r,s);i.vec3.scale(s,s,t[1]),i.vec3.scale(a,a,t[0]);const o=i.vec3.cross(n.v3(),i.vec3.add(n.v3(),s,a),r);i.vec3.normalize(o,o);const c=i.quat.setAxisAngle(i.quat.create(),o,i.vec2.len(t));i.mat4.multiply(this._rotation,this._rotation,i.mat4.fromQuat(n.m4(),c)),this.update()}update(){if(void 0===this._camera)return;const e=i.mat4.fromTranslation(n.m4(),this._reference.center);i.mat4.multiply(e,e,this._rotation),i.mat4.translate(e,e,i.vec3.negate(n.v3(),this._reference.center));const t=i.vec3.transformMat4(n.v3(),[0,1,0],this._rotation),r=i.vec3.transformMat4(n.v3(),this._reference.eye,e);this._camera.up=t,this._camera.eye=r}set sensitivity(e){this._sensitivity=e}get sensitivity(){return this._sensitivity}}t.TrackballModifier=a,a.DEFAULT_SENSITIVITY=.002},4934:(e,t,r)=>{"use strict";const i=r(3659),n=r(2111),s=r(9696);var a;!function(e){function t(e){return s.assert(2===e.length,`expected length of buffer to be 2, given ${e.length}`),[e[0],e[1]]}function r(e){return s.assert(3===e.length,`expected length of buffer to be 3, given ${e.length}`),[e[0],e[1],e[2]]}function a(e){return s.assert(4===e.length,`expected length of buffer to be 4, given ${e.length}`),[e[0],e[1],e[2],e[3]]}e.tuple2=t,e.tuple3=r,e.tuple4=a,e.clampf=function(e,t){const r=n.clamp(e,0,1);return s.logIf(void 0!==t&&e<0||e>1,s.LogLevel.Info,`${t} clamped to [${r}], given [${e}]`),r},e.clampf2=function(e,r){const a=i.vec2.fromValues(e[0],e[1]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1)&&(n.clamp2(a,a,i.vec2.fromValues(0,0),i.vec2.fromValues(1,1)),s.logIf(void 0!==r,s.LogLevel.Info,`${r} clamped to [${a}], given [${e}]`)),t(a)},e.clampf3=function(e,t){const a=i.vec3.fromValues(e[0],e[1],e[2]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1||e[2]<0||e[2]>1)&&(n.clamp3(a,a,i.vec3.fromValues(0,0,0),i.vec3.fromValues(1,1,1)),s.logIf(void 0!==t,s.LogLevel.Info,`${t} clamped to [${a}], given [${e}]`)),r(a)},e.clampf4=function(e,t){const r=i.vec4.fromValues(e[0],e[1],e[2],e[3]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1||e[2]<0||e[2]>1||e[3]<0||e[3]>1)&&(n.clamp4(r,r,i.vec4.fromValues(0,0,0,0),i.vec4.fromValues(1,1,1,1)),s.logIf(void 0!==t,s.LogLevel.Info,`${t} clamped to [${r}], given [${e}]`)),a(r)},e.duplicate2=function(e){return[e[0],e[1]]},e.duplicate3=function(e){return[e[0],e[1],e[2]]},e.duplicate4=function(e){return[e[0],e[1],e[2],e[3]]},e.equals2=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.equals3=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.equals4=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}}(a||(a={})),e.exports=a},2783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TurntableModifier=void 0;const i=r(3659),n=r(2111),s=r(6491);class a extends s.CameraModifier{constructor(){super(...arguments),this._rotation=n.m4(),this._maxAzimuth=.5*+Math.PI-1e-4,this._minAzimuth=.5*-Math.PI+1e-4,this._xAxisScreenSpace=n.v3(),this._sensitivity=a.DEFAULT_SENSITIVITY}initiate(e){Object.assign(this._reference,this._camera),this._initialPoint=e;const t=i.vec3.sub(n.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(t,t),this._xAxisScreenSpace=i.vec3.cross(n.v3(),[0,1,0],t),this._azimuth=Math.acos(i.vec3.dot(t,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth}process(e){this._currentPoint=e;const t=i.vec2.subtract(n.v2(),this._initialPoint,this._currentPoint);i.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity),Number.isFinite(this._minAzimuth)&&(t[1]=Math.min(this._azimuth-this._minAzimuth,t[1])),Number.isFinite(this._maxAzimuth)&&(t[1]=Math.max(this._azimuth-this._maxAzimuth,t[1])),i.mat4.rotateY(this._rotation,n.m4(),t[0]),i.mat4.rotate(this._rotation,this._rotation,t[1],this._xAxisScreenSpace),this.update()}update(){if(void 0===this._camera)return;const e=i.mat4.fromTranslation(n.m4(),this._reference.center);i.mat4.multiply(e,e,this._rotation),i.mat4.translate(e,e,i.vec3.negate(n.v3(),this._reference.center));const t=i.vec3.transformMat4(n.v3(),[0,1,0],this._rotation),r=i.vec3.transformMat4(n.v3(),this._reference.eye,e);this._camera.up=t,this._camera.eye=r}set sensitivity(e){this._sensitivity=e}get sensitivity(){return this._sensitivity}}t.TurntableModifier=a,a.DEFAULT_SENSITIVITY=.002},1732:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.UnifiedBuffer=void 0;const n=r(6404),s=r(1030);class a extends s.Initializable{constructor(e,t,r,i=0,s){super(),this._updates=new Array,this._cpuBuffer=new ArrayBuffer(t),this._gpuBuffer=new n.Buffer(e,s),this._usage=r,this._mergeThreshold=i}static updatesNeedMerge(e,t,r){return t.begin-e.end<r||-1===r}mergeUpdatesLeft(e){let t=0;const r=this._updates[e];for(let i=e-1;i>=0;i--){const e=this._updates[i];if(!a.updatesNeedMerge(e,r,this._mergeThreshold))break;r.begin=Math.min(r.begin,e.begin),r.end=Math.max(r.end,e.end),t++}return this._updates.splice(e-t,t),t+1}mergeUpdatesRight(e){let t=0;const r=this._updates[e];for(let i=e+1;i<this._updates.length;i++){const e=this._updates[i];if(!a.updatesNeedMerge(r,e,this._mergeThreshold))break;r.begin=Math.min(r.begin,e.begin),r.end=Math.max(r.end,e.end),t++}return this._updates.splice(e+1,t),t+1}addUpdate(e){const t=this._updates.findIndex((t=>e.begin<t.begin));-1===t?(this._updates.push(e),this.mergeUpdatesLeft(this._updates.length-1)):(this._updates.splice(t,0,e),this.mergeUpdatesRight(t),this.mergeUpdatesLeft(t))}initialize(e){return this._gpuBuffer.initialize(e)}uninitialize(){this._gpuBuffer.uninitialize()}bind(){this._gpuBuffer.bind()}unbind(){this._gpuBuffer.unbind()}attribEnable(e,t,r,i=!1,n=0,s=0,a=!0,o=!0){this._gpuBuffer.attribEnable(e,t,r,i,n,s,a,o)}attribDisable(e,t=!0,r=!0){this._gpuBuffer.attribDisable(e,t,r)}mergeSubDataRanges(){let e=0;for(;e<this._updates.length;)e+=this.mergeUpdatesRight(e)}subData(e,t){let r;r=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer).subarray(t.byteOffset,t.byteOffset+t.byteLength),new Uint8Array(this._cpuBuffer).set(r,e),this.addUpdate({begin:e,end:e+r.byteLength})}update(e=!1,t=!1){if(e&&this._gpuBuffer.bind(),this._gpuBuffer.bytes!==this._cpuBuffer.byteLength)this._gpuBuffer.data(this._cpuBuffer,this._usage);else{const e=new Uint8Array(this._cpuBuffer);for(const t of this._updates){const r=e.subarray(t.begin,t.end);this._gpuBuffer.subData(t.begin,r)}}t&&this._gpuBuffer.unbind(),this._updates.length=0}get size(){return this._cpuBuffer.byteLength}set size(e){const t=this._cpuBuffer;this._cpuBuffer=new ArrayBuffer(e);const r=new Uint8Array(t).slice(0,e);new Uint8Array(this._cpuBuffer).set(r)}get target(){return this.assertInitialized(),this._gpuBuffer.target}get usage(){return this._usage}set usage(e){this._usage=e}get mergeThreshold(){return this._mergeThreshold}set mergeThreshold(e){this._mergeThreshold=e}}i([s.Initializable.initialize()],a.prototype,"initialize",null),i([s.Initializable.uninitialize()],a.prototype,"uninitialize",null),i([s.Initializable.assert_initialized()],a.prototype,"bind",null),i([s.Initializable.assert_initialized()],a.prototype,"unbind",null),i([s.Initializable.assert_initialized()],a.prototype,"attribEnable",null),i([s.Initializable.assert_initialized()],a.prototype,"attribDisable",null),i([s.Initializable.assert_initialized()],a.prototype,"update",null),t.UnifiedBuffer=a},1271:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.commit=t.branch=void 0,t.branch="master",t.commit="1d0c2fcc5a5f11dc2c8f6737d0445ddd61e5477c",t.version="1d0c2fc"},5590:function(e,t,r){"use strict";var i=this&&this.__decorate||function(e,t,r,i){var n,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(s<3?n(a):s>3?n(t,r,a):n(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.VertexArray=void 0;const n=r(9696),s=r(1030),a=r(2281);class o extends a.AbstractObject{constructor(){super(...arguments),this._buffersBound=!1}create(e,t){if(this.context.isWebGL2||this.context.supportsVertexArrayObject){const t=this.context.gl2facade;this._object=t.createVertexArray(),this._valid=void 0!==this._object,this._bind=()=>{t.bindVertexArray(this.object),this._buffersBound||(e(),this._buffersBound=!0)},this._unbind=()=>t.bindVertexArray(o.DEFAULT_VERTEX_ARRAY)}else this._bind=()=>e(),this._unbind=()=>t(),this._valid=!0;return this._object}delete(){this.context.isWebGL2||this.context.supportsVertexArrayObject?(n.assert(void 0!==this._object,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1}bind(){this._bind()}unbind(){this._unbind()}invalidate(){this._buffersBound=!1}}o.DEFAULT_VERTEX_ARRAY=void 0,i([s.Initializable.assert_initialized()],o.prototype,"bind",null),i([s.Initializable.assert_initialized()],o.prototype,"unbind",null),t.VertexArray=o},4333:e=>{"use strict";var t;!function(e){e.EventBlocker=class{constructor(e,t){if(this._blockListenerByEvent=new Map,this._element=e,void 0!==t)for(const e of t)this.block(e)}block(e){this._blockListenerByEvent.has(e)||(this._blockListenerByEvent.set(e,(e=>(e.preventDefault(),e.stopPropagation(),!1))),this._element.addEventListener(e,this._blockListenerByEvent.get(e)))}unblock(e){this._blockListenerByEvent.has(e)&&(this._element.removeEventListener(e,this._blockListenerByEvent.get(e)),this._blockListenerByEvent.delete(e))}}}(t||(t={})),e.exports=t},104:(e,t,r)=>{"use strict";const i=r(9696);var n;!function(e){class t{static queryAndCacheAPI(){if(void 0!==t._exit)return;const e=window.document,r=[e.exitFullScreen,e.msExitFullscreen,e.mozCancelFullScreen,e.webkitExitFullscreen,void 0];let n=0;for(;n<r.length&&void 0===r[n];++n);switch(n){case 0:t._exit=()=>e.exitFullScreen(),t._request=e=>e.requestFullscreen(),t._element=()=>e.fullscreenElement,t._event="fullscreenchange";break;case 1:t._exit=()=>e.msExitFullscreen(),t._request=e=>e.msRequestFullscreen(),t._element=()=>e.msFullscreenElement,t._event="msfullscreenchange";break;case 2:t._exit=()=>e.mozCancelFullScreen(),t._request=e=>e.mozRequestFullScreen(),t._element=()=>e.mozFullScreenElement,t._event="mozfullscreenchange";break;case 3:t._exit=()=>e.webkitExitFullscreen(),t._request=e=>e.webkitRequestFullscreen(),t._element=()=>e.webkitFullscreenElement,t._event="webkitfullscreenchange";break;default:i.assert(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}static active(){return void 0!==t._element()&&null!==t._element()}static toggle(e,r){if(void 0===e)return;t.queryAndCacheAPI();const i=t.active();if(!i){const r=getComputedStyle(e);t._size[0]=r.width,t._size[1]=r.height}r&&r(),i?(t._callback=void 0,window.removeEventListener(t._event,t.removeEventListener),e.style.width=t._size[0],e.style.height=t._size[1]):(t._callback=r,window.addEventListener(t._event,t.addEventListener)),i?t._exit():t._request(e)}}t._size=["0","0"],t.addEventListener=()=>{window.removeEventListener(t._event,t.addEventListener),window.addEventListener(t._event,t.removeEventListener)},t.removeEventListener=()=>{t._callback&&(t._callback(),t._callback=void 0),window.removeEventListener(t._event,t.removeEventListener)},e.Fullscreen=t}(n||(n={})),e.exports=n},3613:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.KernelF32=t.RandomSquareKernel=t.AntiAliasingKernel=t.AbstractKernel=t.NdcFillingTriangle=t.NdcFillingRectangle=t.CanvasRecorder=t.WheelZoomModifier=t.PinchZoomModifier=t.TurntableModifier=t.TrackballModifier=t.PointerLock=t.PanModifier=t.FirstPersonModifier=t.Navigation=t.CameraModifier=t.TileCameraGenerator=t.Camera=t.Wizard=t.VertexArray=t.UnifiedBuffer=t.TextureCube=t.Texture2DArray=t.Texture3D=t.Texture2D=t.Shader=t.LoadingStatus=t.Renderer=t.Renderbuffer=t.Program=t.Geometry=t.Framebuffer=t.DefaultFramebuffer=t.ColorScale=t.Color=t.Buffer=t.EventHandler=t.PointerEventProvider=t.TouchEventProvider=t.MouseEventProvider=t.ChangeLookup=t.ExtensionsHash=t.ContextMasquerade=t.Initializable=t.Controller=t.Canvas=t.Context=t.version=t.commit=t.branch=void 0,t.tuples=t.gl_matrix_extensions=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.vec4=t.vec3=t.vec2=t.auxiliaries=t.FrameCapture=t.EyeGazeData=t.EyeGazeEventProvider=t.EyeGazeDataStreams=t.EyeGazeDataStream=t.ShadowPass=t.GaussFilter=t.ReadbackPass=t.EnvironmentTextureType=t.EnvironmentRenderingPass=t.DebugPass=t.BlitPass=t.AccumulatePass=t.KernelUI8=t.KernelUI32=t.KernelI8=t.KernelI32=void 0;var o=r(1271);Object.defineProperty(t,"branch",{enumerable:!0,get:function(){return o.branch}}),Object.defineProperty(t,"commit",{enumerable:!0,get:function(){return o.commit}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return o.version}});var c=r(4518);Object.defineProperty(t,"Context",{enumerable:!0,get:function(){return c.Context}});var h=r(7063);Object.defineProperty(t,"Canvas",{enumerable:!0,get:function(){return h.Canvas}});var l=r(3863);Object.defineProperty(t,"Controller",{enumerable:!0,get:function(){return l.Controller}});var u=r(1030);Object.defineProperty(t,"Initializable",{enumerable:!0,get:function(){return u.Initializable}});var d=r(1985);Object.defineProperty(t,"ContextMasquerade",{enumerable:!0,get:function(){return d.ContextMasquerade}});var _=r(9568);Object.defineProperty(t,"ExtensionsHash",{enumerable:!0,get:function(){return _.ExtensionsHash}});var f=r(4597);Object.defineProperty(t,"ChangeLookup",{enumerable:!0,get:function(){return f.ChangeLookup}});var p=r(4841);Object.defineProperty(t,"MouseEventProvider",{enumerable:!0,get:function(){return p.MouseEventProvider}});var m=r(4052);Object.defineProperty(t,"TouchEventProvider",{enumerable:!0,get:function(){return m.TouchEventProvider}});var v=r(8319);Object.defineProperty(t,"PointerEventProvider",{enumerable:!0,get:function(){return v.PointerEventProvider}});var g=r(7595);Object.defineProperty(t,"EventHandler",{enumerable:!0,get:function(){return g.EventHandler}});var b=r(6404);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return b.Buffer}});var E=r(7677);Object.defineProperty(t,"Color",{enumerable:!0,get:function(){return E.Color}});var y=r(5252);Object.defineProperty(t,"ColorScale",{enumerable:!0,get:function(){return y.ColorScale}});var x=r(6786);Object.defineProperty(t,"DefaultFramebuffer",{enumerable:!0,get:function(){return x.DefaultFramebuffer}});var T=r(9564);Object.defineProperty(t,"Framebuffer",{enumerable:!0,get:function(){return T.Framebuffer}});var A=r(4894);Object.defineProperty(t,"Geometry",{enumerable:!0,get:function(){return A.Geometry}});var S=r(4895);Object.defineProperty(t,"Program",{enumerable:!0,get:function(){return S.Program}});var M=r(7540);Object.defineProperty(t,"Renderbuffer",{enumerable:!0,get:function(){return M.Renderbuffer}});var R=r(3205);Object.defineProperty(t,"Renderer",{enumerable:!0,get:function(){return R.Renderer}}),Object.defineProperty(t,"LoadingStatus",{enumerable:!0,get:function(){return R.LoadingStatus}});var L=r(5263);Object.defineProperty(t,"Shader",{enumerable:!0,get:function(){return L.Shader}});var P=r(6942);Object.defineProperty(t,"Texture2D",{enumerable:!0,get:function(){return P.Texture2D}});var F=r(7344);Object.defineProperty(t,"Texture3D",{enumerable:!0,get:function(){return F.Texture3D}});var w=r(4850);Object.defineProperty(t,"Texture2DArray",{enumerable:!0,get:function(){return w.Texture2DArray}});var O=r(945);Object.defineProperty(t,"TextureCube",{enumerable:!0,get:function(){return O.TextureCube}});var I=r(1732);Object.defineProperty(t,"UnifiedBuffer",{enumerable:!0,get:function(){return I.UnifiedBuffer}});var z=r(5590);Object.defineProperty(t,"VertexArray",{enumerable:!0,get:function(){return z.VertexArray}});var N=r(1284);Object.defineProperty(t,"Wizard",{enumerable:!0,get:function(){return N.Wizard}});var B=r(4082);Object.defineProperty(t,"Camera",{enumerable:!0,get:function(){return B.Camera}});var C=r(339);Object.defineProperty(t,"TileCameraGenerator",{enumerable:!0,get:function(){return C.TileCameraGenerator}});var D=r(6491);Object.defineProperty(t,"CameraModifier",{enumerable:!0,get:function(){return D.CameraModifier}});var G=r(8652);Object.defineProperty(t,"Navigation",{enumerable:!0,get:function(){return G.Navigation}});var j=r(9870);Object.defineProperty(t,"FirstPersonModifier",{enumerable:!0,get:function(){return j.FirstPersonModifier}});var U=r(8287);Object.defineProperty(t,"PanModifier",{enumerable:!0,get:function(){return U.PanModifier}});var k=r(9258);Object.defineProperty(t,"PointerLock",{enumerable:!0,get:function(){return k.PointerLock}});var V=r(2763);Object.defineProperty(t,"TrackballModifier",{enumerable:!0,get:function(){return V.TrackballModifier}});var X=r(2783);Object.defineProperty(t,"TurntableModifier",{enumerable:!0,get:function(){return X.TurntableModifier}});var H=r(8357);Object.defineProperty(t,"PinchZoomModifier",{enumerable:!0,get:function(){return H.PinchZoomModifier}});var W=r(9817);Object.defineProperty(t,"WheelZoomModifier",{enumerable:!0,get:function(){return W.WheelZoomModifier}});var $=r(6233);Object.defineProperty(t,"CanvasRecorder",{enumerable:!0,get:function(){return $.CanvasRecorder}});var q=r(7429);Object.defineProperty(t,"NdcFillingRectangle",{enumerable:!0,get:function(){return q.NdcFillingRectangle}});var Y=r(7570);Object.defineProperty(t,"NdcFillingTriangle",{enumerable:!0,get:function(){return Y.NdcFillingTriangle}});var Z=r(4563);Object.defineProperty(t,"AbstractKernel",{enumerable:!0,get:function(){return Z.AbstractKernel}});var K=r(3411);Object.defineProperty(t,"AntiAliasingKernel",{enumerable:!0,get:function(){return K.AntiAliasingKernel}});var J=r(5785);Object.defineProperty(t,"RandomSquareKernel",{enumerable:!0,get:function(){return J.RandomSquareKernel}});var Q=r(4563);Object.defineProperty(t,"KernelF32",{enumerable:!0,get:function(){return Q.KernelF32}}),Object.defineProperty(t,"KernelI32",{enumerable:!0,get:function(){return Q.KernelI32}}),Object.defineProperty(t,"KernelI8",{enumerable:!0,get:function(){return Q.KernelI8}}),Object.defineProperty(t,"KernelUI32",{enumerable:!0,get:function(){return Q.KernelUI32}}),Object.defineProperty(t,"KernelUI8",{enumerable:!0,get:function(){return Q.KernelUI8}});var ee=r(3666);Object.defineProperty(t,"AccumulatePass",{enumerable:!0,get:function(){return ee.AccumulatePass}});var te=r(4073);Object.defineProperty(t,"BlitPass",{enumerable:!0,get:function(){return te.BlitPass}});var re=r(26);Object.defineProperty(t,"DebugPass",{enumerable:!0,get:function(){return re.DebugPass}});var ie=r(172);Object.defineProperty(t,"EnvironmentRenderingPass",{enumerable:!0,get:function(){return ie.EnvironmentRenderingPass}}),Object.defineProperty(t,"EnvironmentTextureType",{enumerable:!0,get:function(){return ie.EnvironmentTextureType}});var ne=r(9314);Object.defineProperty(t,"ReadbackPass",{enumerable:!0,get:function(){return ne.ReadbackPass}});var se=r(5714);Object.defineProperty(t,"GaussFilter",{enumerable:!0,get:function(){return se.GaussFilter}});var ae=r(6210);Object.defineProperty(t,"ShadowPass",{enumerable:!0,get:function(){return ae.ShadowPass}});var oe=r(378);Object.defineProperty(t,"EyeGazeDataStream",{enumerable:!0,get:function(){return oe.EyeGazeDataStream}}),Object.defineProperty(t,"EyeGazeDataStreams",{enumerable:!0,get:function(){return oe.EyeGazeDataStreams}});var ce=r(5838);Object.defineProperty(t,"EyeGazeEventProvider",{enumerable:!0,get:function(){return ce.EyeGazeEventProvider}});var he=r(2497);Object.defineProperty(t,"EyeGazeData",{enumerable:!0,get:function(){return he.EyeGazeData}});var le=r(9544);Object.defineProperty(t,"FrameCapture",{enumerable:!0,get:function(){return le.FrameCapture}}),s(r(2194),t),s(r(9922),t),s(r(2709),t);const ue=a(r(9696));t.auxiliaries=ue;var de=r(3659);Object.defineProperty(t,"vec2",{enumerable:!0,get:function(){return de.vec2}}),Object.defineProperty(t,"vec3",{enumerable:!0,get:function(){return de.vec3}}),Object.defineProperty(t,"vec4",{enumerable:!0,get:function(){return de.vec4}});var _e=r(3659);Object.defineProperty(t,"mat2",{enumerable:!0,get:function(){return _e.mat2}}),Object.defineProperty(t,"mat2d",{enumerable:!0,get:function(){return _e.mat2d}}),Object.defineProperty(t,"mat3",{enumerable:!0,get:function(){return _e.mat3}}),Object.defineProperty(t,"mat4",{enumerable:!0,get:function(){return _e.mat4}});var fe=r(3659);Object.defineProperty(t,"quat",{enumerable:!0,get:function(){return fe.quat}});const pe=a(r(2111));t.gl_matrix_extensions=pe;const me=a(r(4934));t.tuples=me},9515:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.viewer=t.Benchmark=t.ray_math=t.fetch=t.properties=void 0,s(r(3613),t),s(r(3733),t);const o=a(r(3607));t.properties=o;const c=a(r(6869));t.fetch=c;const h=a(r(3942));t.ray_math=h;var l=r(8744);Object.defineProperty(t,"Benchmark",{enumerable:!0,get:function(){return l.Benchmark}}),s(r(7491),t);const u=a(r(4333)),d=a(r(104));var _;(_=t.viewer||(t.viewer={})).EventBlocker=u.EventBlocker,_.Fullscreen=d.Fullscreen},9817:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WheelZoomModifier=void 0;const i=r(3659),n=r(2111),s=r(6491);class a extends s.CameraModifier{constructor(){super(...arguments),this._sensitivity=a.DEFAULT_SENSITIVITY,this._translation=n.v3()}process(e){Object.assign(this._reference,this._camera);const t=e*this._sensitivity,r=i.vec3.sub(n.v3(),this._reference.center,this._reference.eye);i.vec3.normalize(r,r),this._translation=i.vec3.scale(n.v3(),r,t),this.update()}update(){if(void 0===this._camera)return;const e=i.mat4.fromTranslation(n.m4(),this._translation),t=i.vec3.transformMat4(n.v3(),this._reference.eye,e);this._camera.eye=t}}t.WheelZoomModifier=a,a.DEFAULT_SENSITIVITY=.002},1284:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Wizard=void 0;const i=r(9696);class n{static queryPrecisionSupport(e,t){const r=e.gl,s=e.gl2facade,a=e.isWebGL1&&e.supportsTextureFloat||e.isWebGL2&&e.supportsColorBufferFloat,o=e.isWebGL1&&e.supportsTextureHalfFloat||e.isWebGL2&&e.supportsColorBufferFloat;let c=t;return t in n.Precision||(i.log(i.LogLevel.Warning,`unknown precision '${c}' changed to '${n.Precision.auto}'`),t=n.Precision.auto),t===n.Precision.auto&&(c=a?n.Precision.float:o?n.Precision.half:n.Precision.byte),c===n.Precision.half&&o?(e.isWebGL2?e.colorBufferFloat:e.textureHalfFloat,[c,s.HALF_FLOAT,1]):c!==n.Precision.float&&c!==n.Precision.half||!a?[c,r.UNSIGNED_BYTE,2]:(e.isWebGL2?e.colorBufferFloat:e.textureFloat,[c,r.FLOAT,0])}static queryInternalTextureFormat(e,t,r=n.Precision.auto){const[s,a,o]=this.queryPrecisionSupport(e,r),c=e.gl;if(e.isWebGL1)return i.assert([c.RGB,c.RGBA].includes(t),"target must be gl.RGB or gl.RGBA in WebGL 1"),[t,a,s];switch(t){case c.RGBA:return[[c.RGBA32F,c.RGBA16F,c.RGBA8][o],a,s];case c.RGB:return[[c.RGB32F,c.RGB16F,c.RGB8][o],a,s];case c.RG:return[[c.RG32F,c.RG16F,c.RG8][o],a,s];case c.RED:return[[c.R32F,c.R16F,c.R8][o],a,s];default:i.assert(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[c.NONE,c.NONE,s]}}t.Wizard=n,function(e){let t;!function(e){e.float="float",e.half="half",e.byte="byte",e.auto="auto"}(t=e.Precision||(e.Precision={}))}(n=t.Wizard||(t.Wizard={}))},4760:(e,t,r)=>{"use strict";var i=r(8770);function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(c),l=["%","/","?",";","#"].concat(h),u=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(8139);function g(e,t,r){if(e&&"object"==typeof e&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}n.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),a=-1!==n&&n<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var g=e=c.join(a);if(g=g.trim(),!r&&1===e.split("#").length){var b=o.exec(g);if(b)return this.path=g,this.href=g,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=s.exec(g);if(E){var y=(E=E[0]).toLowerCase();this.protocol=y,g=g.substr(E.length)}if(r||E||g.match(/^\/\/[^@/]+@[^@/]+/)){var x="//"===g.substr(0,2);!x||E&&p[E]||(g=g.substr(2),this.slashes=!0)}if(!p[E]&&(x||E&&!m[E])){for(var T,A,S=-1,M=0;M<u.length;M++)-1!==(R=g.indexOf(u[M]))&&(-1===S||R<S)&&(S=R);for(-1!==(A=-1===S?g.lastIndexOf("@"):g.lastIndexOf("@",S))&&(T=g.slice(0,A),g=g.slice(A+1),this.auth=decodeURIComponent(T)),S=-1,M=0;M<l.length;M++){var R;-1!==(R=g.indexOf(l[M]))&&(-1===S||R<S)&&(S=R)}-1===S&&(S=g.length),this.host=g.slice(0,S),g=g.slice(S),this.parseHost(),this.hostname=this.hostname||"";var L="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!L)for(var P=this.hostname.split(/\./),F=(M=0,P.length);M<F;M++){var w=P[M];if(w&&!w.match(d)){for(var O="",I=0,z=w.length;I<z;I++)w.charCodeAt(I)>127?O+="x":O+=w[I];if(!O.match(d)){var N=P.slice(0,M),B=P.slice(M+1),C=w.match(_);C&&(N.push(C[1]),B.unshift(C[2])),B.length&&(g="/"+B.join(".")+g),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),L||(this.hostname=i.toASCII(this.hostname));var D=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+D,this.href+=this.host,L&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==g[0]&&(g="/"+g))}if(!f[y])for(M=0,F=h.length;M<F;M++){var j=h[M];if(-1!==g.indexOf(j)){var U=encodeURIComponent(j);U===j&&(U=escape(j)),g=g.split(j).join(U)}}var k=g.indexOf("#");-1!==k&&(this.hash=g.substr(k),g=g.slice(0,k));var V=g.indexOf("?");if(-1!==V?(this.search=g.substr(V),this.query=g.substr(V+1),t&&(this.query=v.parse(this.query)),g=g.slice(0,V)):t&&(this.search="",this.query={}),g&&(this.pathname=g),m[y]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){D=this.pathname||"";var X=this.search||"";this.path=D+X}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(s=v.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),t+n+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i},n.prototype.resolve=function(e){return this.resolveObject(g(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if("string"==typeof e){var t=new n;t.parse(e,!1,!0),e=t}for(var r=new n,i=Object.keys(this),s=0;s<i.length;s++){var a=i[s];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),c=0;c<o.length;c++){var h=o[c];"protocol"!==h&&(r[h]=e[h])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var l=Object.keys(e),u=0;u<l.length;u++){var d=l[u];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||p[e.protocol])r.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),r.pathname=_.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var f=r.pathname||"",v=r.search||"";r.path=f+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=b||g||r.host&&e.pathname,y=E,x=r.pathname&&r.pathname.split("/")||[],T=(_=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(T&&(r.hostname="",r.port=null,r.host&&(""===x[0]?x[0]=r.host:x.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),E=E&&(""===_[0]||""===x[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,x=_;else if(_.length)x||(x=[]),x.pop(),x=x.concat(_),r.search=e.search,r.query=e.query;else if(null!=e.search)return T&&(r.host=x.shift(),r.hostname=r.host,(L=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=L.shift(),r.hostname=L.shift(),r.host=r.hostname)),r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!x.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var A=x.slice(-1)[0],S=(r.host||e.host||x.length>1)&&("."===A||".."===A)||""===A,M=0,R=x.length;R>=0;R--)"."===(A=x[R])?x.splice(R,1):".."===A?(x.splice(R,1),M++):M&&(x.splice(R,1),M--);if(!E&&!y)for(;M--;M)x.unshift("..");!E||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),S&&"/"!==x.join("/").substr(-1)&&x.push("");var L,P=""===x[0]||x[0]&&"/"===x[0].charAt(0);return T&&(r.hostname=P?"":x.length?x.shift():"",r.host=r.hostname,(L=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=L.shift(),r.hostname=L.shift(),r.host=r.hostname)),(E=E||r.host&&x.length)&&!P&&x.unshift(""),x.length>0?r.pathname=x.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=g,t.resolve=function(e,t){return g(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?g(e,!1,!0).resolveObject(t):t},t.format=function(e){return"string"==typeof e&&(e=g(e)),e instanceof n?e.format():n.prototype.format.call(e)},t.Url=n},9587:e=>{e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n    #extension GL_OES_standard_derivatives : enable\n#else \n    layout(location = 0) out vec4 fragColor;\n#endif\n\nuniform int u_frameNumber;\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\n    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\n\n    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\n    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\n    if(!any(bvec2(cstep))) {\n        discard;\n    }\n    fragColor = vec4(color, 1.0); \n}\n"},354:e=>{e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\nvoid ndcOffset(inout vec4 vertex, in vec2 offset) {\n    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\n}\n\n\n\n#if __VERSION__ == 100\n    attribute vec2 a_vertex;\n#else \n    layout(location = 0) in vec2 a_vertex;\n#endif\n\nuniform vec2 u_ndcOffset;\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    v_uv = a_vertex.xy * 0.5 + 0.5;\n\n    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\n    ndcOffset(vertex, u_ndcOffset);\n\n    gl_Position = vertex;\n}\n"},6277:e=>{e.exports="precision highp float;\n\n// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\n// References:\n// [1] Real Shading in Unreal Engine 4\n//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\n// [2] Physically Based Shading at Disney\n//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\n// [3] README.md - Environment Maps\n//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\n// [4] \"An Inexpensive BRDF Model for Physically based Rendering\" by Christophe Schlick\n//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n#endif\n\nconst int HAS_NORMALS           = 1;\nconst int HAS_TANGENTS          = 1 << 1;\nconst int HAS_UV                = 1 << 2;\nconst int HAS_COLORS            = 1 << 3;\nconst int USE_IBL               = 1 << 4;\nconst int HAS_BASECOLORMAP      = 1 << 5;\nconst int HAS_NORMALMAP         = 1 << 6;\nconst int HAS_EMISSIVEMAP       = 1 << 7;\nconst int HAS_METALROUGHNESSMAP = 1 << 8;\nconst int HAS_OCCLUSIONMAP      = 1 << 9;\nconst int USE_TEX_LOD           = 1 << 10;\n\nconst vec3 u_LightDirection = vec3(0.2, 1.0, 0.2);\nconst vec3 u_LightColor = vec3(1, 1, 1);\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nuniform sampler2D u_baseColor;\nuniform sampler2D u_metallicRoughness;\nuniform sampler2D u_normal;\nuniform sampler2D u_emissive;\nuniform sampler2D u_occlusion;\n\nuniform samplerCube u_specularEnvironment;\nuniform sampler2D u_brdfLUT;\n\nuniform int u_baseColorTexCoord;\nuniform int u_normalTexCoord;\nuniform int u_metallicRoughnessTexCoord;\nuniform int u_occlusionTexCoord;\nuniform int u_emissiveTexCoord;\n\nuniform vec4 u_baseColorFactor;\nuniform float u_metallicFactor;\nuniform float u_roughnessFactor;\nuniform vec3 u_emissiveFactor;\nuniform float u_normalScale;\nuniform int u_blendMode;\nuniform float u_blendCutoff;\n\nuniform mediump int u_geometryFlags;\nuniform mediump int u_pbrFlags;\nuniform vec3 u_eye;\n\nvarying vec2 v_uv[3];\nvarying vec4 v_color;\nvarying vec3 v_position;\n\nvarying mat3 v_TBN;\nvarying vec3 v_normal;\n\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo\n{\n    float NdotL;                  // cos angle between normal and light direction\n    float NdotV;                  // cos angle between normal and view direction\n    float NdotH;                  // cos angle between normal and half vector\n    float LdotH;                  // cos angle between light direction and half vector\n    float VdotH;                  // cos angle between view direction and half vector\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n    float metalness;              // metallic value at the surface\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\n    vec3 reflectance90;           // reflectance color at grazing angle\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n    vec3 diffuseColor;            // color contribution from diffuse lighting\n    vec3 specularColor;           // color contribution from specular lighting\n};\n\nbool checkGeometryFlag(int flag) {\n    return (u_geometryFlags & flag) == flag;\n}\n\nbool checkFlag(int flag) {\n    return (u_pbrFlags & flag) == flag;\n}\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n    #ifdef MANUAL_SRGB\n    #ifdef SRGB_FAST_APPROXIMATION\n    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n    #else //SRGB_FAST_APPROXIMATION\n    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n    #endif //SRGB_FAST_APPROXIMATION\n    return vec4(linOut,srgbIn.w);;\n    #else //MANUAL_SRGB\n    return srgbIn;\n    #endif //MANUAL_SRGB\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n    // Retrieve the tangent space matrix\n    mat3 tbn;\n    if (!checkGeometryFlag(HAS_TANGENTS)) {\n        vec3 pos_dx = dFdx(v_position);\n        vec3 pos_dy = dFdy(v_position);\n        vec3 tex_dx = dFdx(vec3(v_uv[0], 0.0));\n        vec3 tex_dy = dFdy(vec3(v_uv[0], 0.0));\n        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n        vec3 ng;\n        if (checkGeometryFlag(HAS_NORMALS))\n            ng = normalize(v_normal);\n        else\n            ng = cross(pos_dx, pos_dy);\n\n            t = normalize(t - ng * dot(ng, t));\n            vec3 b = normalize(cross(ng, t));\n            tbn = mat3(t, b, ng);\n        }\n    else { // HAS_TANGENTS\n        tbn = v_TBN;\n    }\n\n    vec3 n;\n    if (checkFlag(HAS_NORMALMAP)) {\n        n = texture(u_normal, v_uv[u_normalTexCoord]).rgb;\n        n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_normalScale, u_normalScale, 1.0)));\n    } else {\n        // The tbn matrix is linearly interpolated, so we need to re-normalize\n        n = normalize(tbn[2].xyz);\n    }\n\n    // reverse backface normals\n    n *= (2.0 * float(gl_FrontFacing) - 1.0);\n\n    return n;\n}\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(PBRInfo pbrInputs)\n{\n    return pbrInputs.diffuseColor / M_PI;\n}\n\n // The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n // This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n    float NdotL = pbrInputs.NdotL;\n    float NdotV = pbrInputs.NdotV;\n    float r = pbrInputs.alphaRoughness;\n\n    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n    return attenuationL * attenuationV;\n}\n\n // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n    return roughnessSq / (M_PI * f * f);\n}\n\nvec3 getIBLContribution(vec3 n, vec3 v, PBRInfo pbrInfo)\n{\n    float NdotV = clamp(dot(n, v), 0.0, 1.0);\n\n    // TODO: pass uniform for mip count\n    const float MIP_COUNT = 8.0;\n    float lod = clamp(pbrInfo.perceptualRoughness * MIP_COUNT, 0.0, MIP_COUNT);\n    vec3 reflection = normalize(reflect(-v, n));\n\n    vec2 brdfSamplePoint = vec2(NdotV, pbrInfo.perceptualRoughness);\n    vec2 brdf = texture(u_brdfLUT, brdfSamplePoint).rg;\n\n    // vec4 diffuseSample = textureCube(u_DiffuseEnvSampler, n);\n    vec4 specularSample = textureLod(u_specularEnvironment, reflection, lod);\n\n    // vec3 diffuseLight = SRGBtoLINEAR(diffuseSample).rgb;\n    vec3 specularLight = SRGBtoLINEAR(specularSample).rgb;\n\n    // vec3 diffuse = diffuseLight * pbrInfo.diffuseColor;\n    vec3 specular = specularLight * (pbrInfo.specularColor * brdf.x + brdf.y);\n\n    return specular;\n    // return diffuse + specular;\n}\n\nvoid main(void)\n{\n    float perceptualRoughness = u_roughnessFactor;\n    float metallic = u_metallicFactor;\n    if (checkFlag(HAS_METALROUGHNESSMAP)) {\n        // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n        // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n        vec4 mrSample = texture(u_metallicRoughness, v_uv[u_metallicRoughnessTexCoord]);\n        perceptualRoughness = mrSample.g * perceptualRoughness;\n        metallic = mrSample.b * metallic;\n    }\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n     // The albedo may be defined from a base texture or a flat color\n    vec4 baseColor;\n    if (checkFlag(HAS_BASECOLORMAP)) {\n        baseColor = SRGBtoLINEAR(texture(u_baseColor, v_uv[u_baseColorTexCoord])) * u_baseColorFactor;\n    } else {\n        baseColor = u_baseColorFactor;\n    }\n\n    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\n    // TODO!: distinguish vec3/vec4 colors...\n    baseColor *= vec4(v_color.rgb, 1.0);\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n    // Compute reflectance.\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\n    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();                         // normal at surface point\n    vec3 v = normalize(u_eye - v_position);        // Vector from surface point to camera\n    vec3 l = normalize(u_LightDirection);          // Vector from surface point to light\n    vec3 h = normalize(l+v);                       // Half vector between both l and v\n    vec3 reflection = -normalize(reflect(v, n));\n\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = abs(dot(n, v)) + 0.001;\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    PBRInfo pbrInputs = PBRInfo(\n        NdotL,\n        NdotV,\n        NdotH,\n        LdotH,\n        VdotH,\n        perceptualRoughness,\n        metallic,\n        specularEnvironmentR0,\n        specularEnvironmentR90,\n        alphaRoughness,\n        diffuseColor,\n        specularColor\n    );\n\n     // Calculate the shading terms for the microfacet specular shading model\n    vec3 F = specularReflection(pbrInputs);\n    float G = geometricOcclusion(pbrInputs);\n    float D = microfacetDistribution(pbrInputs);\n\n     // Calculation of analytical lighting contribution\n    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\n    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\n\n    vec3 environmentLight = getIBLContribution(n, v, pbrInputs);\n    color += environmentLight;\n\n    if (checkFlag(HAS_EMISSIVEMAP)) {\n        vec3 emissive = SRGBtoLINEAR(texture(u_emissive, v_uv[u_emissiveTexCoord])).rgb * u_emissiveFactor;\n        color += emissive;\n    }\n\n    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\n    float alpha = 1.0;\n    if (u_blendMode == 1) {\n        if (baseColor.a < u_blendCutoff) {\n            discard;\n        }\n    }\n    else if (u_blendMode == 2) {\n        alpha = baseColor.a;\n    }\n\n    fragColor = vec4(pow(color, vec3(1.0/2.2)), alpha);\n}\n"},6263:e=>{e.exports="precision highp float;\n\n// Adapted from https://github.com/KhronosGroup/glTF-WebGL-PBR\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\nconst int HAS_NORMALS           = 1;\nconst int HAS_TANGENTS          = 1 << 1;\nconst int HAS_UV                = 1 << 2;\nconst int HAS_COLORS            = 1 << 3;\n\n#if __VERSION__ == 100\n    attribute vec4 a_position;\n    attribute vec4 a_normal;\n    attribute vec4 a_tangent;\n    attribute vec2 a_texcoord_0;\n    attribute vec2 a_texcoord_1;\n    attribute vec2 a_texcoord_2;\n    attribute vec4 a_joints;\n    attribute vec4 a_weights;\n    attribute vec4 a_color;\n#else\n    layout (location = 0) in vec4 a_position;\n    layout (location = 1) in vec3 a_normal;\n    layout (location = 2) in vec4 a_tangent;\n    layout (location = 3) in vec2 a_texcoord_0;\n    layout (location = 4) in vec2 a_texcoord_1;\n    layout (location = 5) in vec2 a_texcoord_2;\n    layout (location = 6) in vec4 a_joints;\n    layout (location = 7) in vec4 a_weights;\n    layout (location = 8) in vec4 a_color;\n#endif\n\nuniform mat4 u_model;\nuniform mat4 u_viewProjection;\nuniform mat3 u_normalMatrix;\n\nuniform mediump int u_geometryFlags;\n\nvarying vec2 v_uv[3];\nvarying vec4 v_color;\nvarying vec3 v_position;\n\nvarying mat3 v_TBN;\nvarying vec3 v_normal;\n\nbool checkFlag(int flag) {\n    return (u_geometryFlags & flag) == flag;\n}\n\nvoid main(void)\n{\n    vec4 pos = u_model * a_position;\n    v_position = vec3(pos.xyz) / pos.w;\n\n    if (checkFlag(HAS_NORMALS)) {\n        if (checkFlag(HAS_TANGENTS)) {\n            vec3 normalW = normalize(vec3(u_normalMatrix * a_normal));\n            vec3 tangentW = normalize(vec3(u_model * vec4(a_tangent.xyz, 0.0)));\n            vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\n            v_TBN = mat3(tangentW, bitangentW, normalW);\n        } else { // HAS_TANGENTS != 1\n            v_normal = normalize(vec3(u_model * vec4(a_normal.xyz, 0.0)));\n        }\n    }\n\n    if (checkFlag(HAS_UV)) {\n        v_uv[0] = a_texcoord_0;\n        v_uv[1] = a_texcoord_1;\n        v_uv[2] = a_texcoord_2;\n    } else {\n        v_uv[0] = vec2(0., 0.);\n        v_uv[1] = vec2(0., 0.);\n        v_uv[2] = vec2(0., 0.);\n    }\n\n    if (checkFlag(HAS_COLORS)) {\n        v_color = a_color;\n    } else {\n        v_color = vec4(1.0);\n    }\n\n    gl_Position = u_viewProjection * u_model * a_position;\n}\n"},3170:e=>{e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n#endif\n\n\nuniform float u_weight;\nuniform sampler2D u_accumulationTexture;\nuniform sampler2D u_currentFrameTexture;\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\n    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\n    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\n}\n"},3717:e=>{e.exports="\nprecision highp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n#endif\n\n\nuniform sampler2D u_source;\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    fragColor = texture(u_source, v_uv);\n}\n"},985:e=>{e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\n\n#if __VERSION__ == 100\n    attribute vec2 a_vertex;\n#else\n    layout(location = 0) in vec2 a_vertex;\n#endif\n\nuniform vec4 u_srcBounds; // normalized\nuniform vec4 u_dstBounds; // normalized\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    vec2 uv = a_vertex * 0.5 + 0.5;\n\n    v_uv = mix(u_srcBounds.xy, u_srcBounds.zw, uv);\n    gl_Position = vec4(a_vertex.xy, 0.0, 1.0);\n}\n"},8356:e=>{e.exports="\nprecision highp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\nconst float one255ths = 1.0 / 255.0;\n\nvec3 float24x1_to_uint8x3(const in float f) {\n    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\n    return floor(uint8x3 * 256.0) * one255ths;\n}\n\nvec4 float24x1_to_uint8x4(const in float f) {\n    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\n    return floor(uint8x4 * 256.0) * one255ths;\n}\n\nconst vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\nfloat uint8x3_to_float24x1(const in vec3 v) {\n    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\n}\n\nconst vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\nfloat uint8x4_to_float32x1(const in vec4 v) {\n    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\n}\n\n\nfloat linearizeDepth(float zInNDC, float near, float far) {\n    float zLinear = 2.0 * near;\n    zLinear /= far + near - zInNDC * (far - near);\n    return zLinear;\n}\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n#endif\n\n\nuniform sampler2D u_source;\n\nuniform int u_mode; /* Debug mode. */\nuniform vec2 u_linearize; /* [ zNear, zFar ] */\n\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    vec4 source = texture(u_source, v_uv);\n\n    /* u_mode == 0                 None */\n\n    if(u_mode == 1) {           /* Depth */\n        source.rgb = vec3(source[0]);\n\n    } else if (u_mode == 2) {   /* DepthLinear */\n        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\n        source.rgb = vec3(zLinear);\n\n    } else if(u_mode == 3) {    /* DepthPacked */\n        source.rgb = float24x1_to_uint8x3(source[0]);\n\n    } else if (u_mode == 4) {   /* DepthLinearPacked */\n        float zLinear = linearizeDepth(source[0], u_linearize[0], u_linearize[1]);\n        source.rgb = float24x1_to_uint8x3(zLinear);\n    }\n\n    fragColor = source;\n}\n"},4965:e=>{e.exports="precision highp float;\nprecision highp int;\n\n/**\n  To be replaced via Shader.replace();\n */\n#define PROJECTION_TYPE\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n#endif\n\n\nuniform int u_mode;\nuniform bool u_skipLod;\n\n#if defined(CUBE_MAP)\n    uniform samplerCube u_cubemap;\n#elif defined(EQUI_MAP)\n    uniform sampler2D u_equirectmap;\n#elif defined(SPHERE_MAP)\n    uniform sampler2D u_spheremap;\n#elif defined(POLAR_MAP)\n    uniform sampler2D u_polarmap[2];\n#endif\n\nvarying vec2 v_uv;\nvarying vec4 v_ray;\n\n\nconst float PI = 3.141592653589793;\nconst float OneOver2PI = 0.1591549430918953357688837633725;\nconst float OneOverPI  = 0.3183098861837906715377675267450;\n\n\nvoid main(void)\n{\n    vec2 uv = v_uv;\n    vec3 ray = normalize(v_ray.xyz);\n\n    #if defined(CUBE_MAP)\n        #if __VERSION__ == 100\n            fragColor = u_skipLod ? textureCubeLod(u_cubemap, vec3(ray), 0.0) : textureCube(u_cubemap, vec3(ray));\n        #else\n            fragColor = u_skipLod ? textureLod(u_cubemap, vec3(ray), 0.0) : texture(u_cubemap, vec3(ray));\n        #endif\n    #endif\n\n    #if defined(EQUI_MAP)\n        float v = acos(-ray.y) * OneOverPI;\n        float m = atan(-ray.x, ray.z);\n        uv = vec2(m * OneOver2PI + 0.5, v);\n\n        fragColor = texture(u_equirectmap, uv);\n    #endif\n\n    #if defined(SPHERE_MAP)\n        ray = -ray.xzy;\n        ray.y *= -1.0;\n        ray.z += +1.0;\n        uv = 0.5 + 0.5 * ray.xy / length(ray);\n\n        fragColor = texture(u_spheremap, uv);\n    #endif\n\n    #if defined(POLAR_MAP)\n        ray.xz /= abs(ray.y) + 1.0;\n        ray.xz = ray.xz * 0.5 + 0.5;\n        ray.x *= -1.0;\n\n        fragColor = mix(texture(u_polarmap[1], ray.xz),\n                        texture(u_polarmap[0], vec2(1.0, -1.0) * ray.xz),\n                        step(0.0, ray.y));\n    #endif\n}\n"},8170:e=>{e.exports="precision highp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\n\n#if __VERSION__ == 100\n    attribute vec2 a_vertex;\n#else\n    in vec2 a_vertex;\n#endif\n\n\nuniform mat4 u_viewProjectionInverse;\n\n\nvarying vec2 v_uv;\nvarying vec4 v_ray;\n\n\nvoid main(void)\n{\n    v_uv = a_vertex * 0.5 + 0.5;\n    v_ray = u_viewProjectionInverse * vec4(a_vertex, 1.0, 1.0);\n\n    gl_Position = vec4(a_vertex.xy, 1.0 - 1e-6, 1.0);\n}\n"},4472:e=>{e.exports="\nprecision lowp float;\nprecision lowp int;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n#if __VERSION__ == 100\n  #define fragColor gl_FragColor\n#else\n  layout(location = 0) out vec4 fragColor;\n#endif\n\n\nuniform float u_weights[32];\nuniform vec2 u_delta;\n\nuniform sampler2D u_texture;\n\nvarying vec2 v_texCoords;\n\n\nvoid main()\n{\n    vec4 result = u_weights[0] * texture(u_texture, v_texCoords);\n    for (int i = 1; i <= $KERNEL_HALF_SIZE; i++)\n    {\n        result += u_weights[i] * texture(u_texture, v_texCoords + float(i) * u_delta);\n        result += u_weights[i] * texture(u_texture, v_texCoords - float(i) * u_delta);\n    }\n\n    fragColor = result;\n}\n"},1622:e=>{e.exports="\nprecision lowp float;\nprecision lowp int;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\n#if __VERSION__ == 100\n  attribute vec2 a_vertex;\n#else\n  layout(location = 0) in vec2 a_vertex;\n#endif\n\n\nvarying vec2 v_texCoords;\n\n\nvoid main()\n{\n    v_texCoords = a_vertex * 0.5 + 0.5;\n    gl_Position = vec4(a_vertex, 0.0, 1.0);\n}\n"},3643:e=>{e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\n\n#if __VERSION__ == 100\n    attribute vec2 a_vertex;\n#else\n    layout(location = 0) in vec2 a_vertex;\n#endif\n\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    v_uv = a_vertex * 0.5 + 0.5;\n\n    gl_Position = vec4(a_vertex, 0.0, 1.0);\n}\n"},5081:e=>{e.exports="\nprecision highp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\nconst float one255ths = 1.0 / 255.0;\n\nvec3 float24x1_to_uint8x3(const in float f) {\n    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\n    return floor(uint8x3 * 256.0) * one255ths;\n}\n\nvec4 float24x1_to_uint8x4(const in float f) {\n    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\n    return floor(uint8x4 * 256.0) * one255ths;\n}\n\nconst vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\nfloat uint8x3_to_float24x1(const in vec3 v) {\n    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\n}\n\nconst vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\nfloat uint8x4_to_float32x1(const in vec4 v) {\n    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\n}\n\n\n\n#if __VERSION__ == 100\n    #define fragDepth gl_FragColor\n#else \n    layout(location = 0) out vec4 fragDepth;\n#endif\n\n\nuniform sampler2D u_texture;\nuniform vec2 u_offset;\nuniform vec2 u_scale;\n\nvarying vec2 v_uv;\n\n\n\nvoid main(void)\n{\n    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\n    float depth = texture(u_texture, uv).r;\n\n    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\n}\n"},9761:e=>{e.exports="precision mediump float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n\n    #ifdef GL_OES_standard_derivatives\n        #extension GL_OES_standard_derivatives : enable\n        #define AASTEP\n    #endif\n\n#else\n    layout(location = 0) out vec4 fragColor;\n\n    #define AASTEP\n\n#endif\n\n\nuniform sampler2D u_glyphs;\nuniform vec4 u_color;\nuniform float u_aaStepScale;\nuniform int u_aaSampling;\n\nvarying vec2 v_uv;\n\nconst int channel = 0;\n\n\nfloat aastep(float t, float value)\n{\n#ifdef AASTEP\n    /* float afwidth = length(vec2(dFdx(value), dFdy(value))) * u_aaStepScale; */\n    float afwidth = fwidth(value) * u_aaStepScale;\n    /* The aa step scale is more of a hack to provide seemingly smoother (e.g., >= 1.0) or crisper (e.g., between 0.0\n     * and 1.0) contours without specific sampling. It's just scaling the outcome of the derivatives.\n     */\n\n    return smoothstep(t - afwidth, t + afwidth, value);\n#else\n    return step(t, value);\n#endif\n}\n\nfloat texStep(float t, vec2 uv)\n{\n    /*\n     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\n     * https://issuetracker.google.com/u/1/issues/146041290\n     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\n     */\n    float distanceValue = texture(u_glyphs, uv)[channel];\n    return step(t, distanceValue);\n}\n\nfloat texSmooth(float t, vec2 uv)\n{\n    /*\n     * This is a workaround for a known bug in Chrome software rendering (SwiftShader), for updates follow\n     * https://issuetracker.google.com/u/1/issues/146041290\n     * Workaround: Storing the result of the texture access into another variable that then is passed as parameter.\n     */\n    float distanceValue = texture(u_glyphs, uv)[channel];\n    return aastep(t, distanceValue);\n}\n\n#ifdef AASTEP\n\nfloat aastep3h(float t, vec2 uv)\n{\n    float x = dFdy(uv.x) * 1.0 / 3.0;\n\n    float v = texSmooth(t, uv + vec2( -x, 0.0))\n            + texSmooth(t, uv + vec2(0.0, 0.0))\n            + texSmooth(t, uv + vec2( +x, 0.0));\n\n    return v / 3.0;\n}\n\nfloat aastep3v(float t, vec2 uv)\n{\n    float y = dFdy(uv.y) * 1.0 / 3.0;\n\n    float v = texSmooth(t, uv + vec2( 0.0,  -y))\n            + texSmooth(t, uv + vec2( 0.0, 0.0))\n            + texSmooth(t, uv + vec2( 0.0,  +y));\n\n    return v / 3.0;\n}\n\nfloat aastep3x3(float t, vec2 uv)\n{\n    float x = dFdx(uv.x) * 1.0 / 3.0;\n    float y = dFdy(uv.y) * 1.0 / 3.0;\n\n    float v = texSmooth(t, uv + vec2(  -x, -y)) + texSmooth(t, uv + vec2(  -x, 0.0)) + texSmooth(t, uv + vec2(  -x, +y))\n            + texSmooth(t, uv + vec2( 0.0, -y)) + texSmooth(t, uv + vec2( 0.0, 0.0)) + texSmooth(t, uv + vec2( 0.0, +y))\n            + texSmooth(t, uv + vec2(  +x, -y)) + texSmooth(t, uv + vec2(  +x, 0.0)) + texSmooth(t, uv + vec2(  +x, +y));\n\n    return v / 9.0;\n}\n\nfloat aastep4x4(float t, vec2 uv)\n{\n    float x0 = dFdx(uv.x);\n    float y0 = dFdx(uv.y);\n    float x1 = x0 * 1.0 / 8.0;\n    float y1 = y0 * 1.0 / 8.0;\n    float x2 = x0 * 3.0 / 8.0;\n    float y2 = y0 * 3.0 / 8.0;\n\n    float v = texSmooth(t, uv + vec2(-x2,-y2)) + texSmooth(t, uv + vec2(-x2,-y1))\n            + texSmooth(t, uv + vec2(-x2,+y1)) + texSmooth(t, uv + vec2(-x2,+y2))\n\n            + texSmooth(t, uv + vec2(-x1,-y2)) + texSmooth(t, uv + vec2(-x1,-y1))\n            + texSmooth(t, uv + vec2(-x1,+y1)) + texSmooth(t, uv + vec2(-x1,+y2))\n\n            + texSmooth(t, uv + vec2(+x1,-y2)) + texSmooth(t, uv + vec2(+x1,-y1))\n            + texSmooth(t, uv + vec2(+x1,+y1)) + texSmooth(t, uv + vec2(+x1,+y2))\n\n            + texSmooth(t, uv + vec2(+x2,-y2)) + texSmooth(t, uv + vec2(+x2,-y1))\n            + texSmooth(t, uv + vec2(+x2,+y1)) + texSmooth(t, uv + vec2(+x2,+y2));\n\n    return v / 16.0;\n}\n\n// vec4 subpix(float r, float g, float b, vec4 fore, vec4 back)\n// {\n//     return vec4(mix(back.rgb, fore.rgb, vec3(r, g, b)), mix(back.a, fore.a, (r + b + g) / 3.0));\n// }\n\n#endif\n\nvoid main(void)\n{\n    /** @todo mipmap access? */\n\n    float a = 0.0;\n    /* When using multiframe sampling, might not be necessary and even tends to add more blur */\n#ifdef AASTEP\n    if(u_aaSampling == 0) {         // LabelRenderPass.Sampling.None\n#endif\n\n        a = texStep(0.5, v_uv);\n\n#ifdef AASTEP\n    } else if(u_aaSampling == 1) {  // LabelRenderPass.Sampling.Smooth\n        a = texSmooth(0.5, v_uv);\n    } else if(u_aaSampling == 2) {  // LabelRenderPass.Sampling.Horizontal3\n        a = aastep3h(0.5, v_uv);\n    } else if(u_aaSampling == 3) {  // LabelRenderPass.Sampling.Vertical3\n        a = aastep3v(0.5, v_uv);\n    } else if(u_aaSampling == 4) {  // LabelRenderPass.Sampling.Grid3x3\n        a = aastep3x3(0.5, v_uv);\n    } else if(u_aaSampling == 5) {  // LabelRenderPass.Sampling.Grid4x4\n        a = aastep4x4(0.5, v_uv);\n    }\n#endif\n\n    /**\n     * @todo - design decision: Don't discard fragments?, as we might need them for an id-buffer for\n     * clicking-interaction. Furthermore, using if-statement and discard can slow down performance:\n     * it's bad for IMR, TBR, TBDR and early-Z optimization\n     * https://stackoverflow.com/questions/8509051/is-discard-bad-for-program-performance-in-opengl\n     */\n    if(a <= 0.0) {\n        discard;\n    }\n    fragColor = vec4(u_color.rgb, u_color.a * a);\n\n    /* use when pre-multiplied color is required. */\n    /* fragColor = vec4(u_color.rgb * u_color.a * a, u_color.a * a); */\n}\n"},1176:e=>{e.exports="precision mediump float;\nprecision lowp int;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else\n    #define varying out\n#endif\n\n\n\n#if __VERSION__ == 100\n\n#extension GL_EXT_draw_buffers : enable\nattribute vec2 a_vertex;\n/* [ texture ll: vec2, ur: vec2 ] */\nattribute vec4 a_texCoord;\nattribute vec3 a_origin;\nattribute vec3 a_tangent;\nattribute vec3 a_up;\n\n#else\n\nin vec2 a_vertex;\n/* [ texture ll: vec2, ur: vec2 ]*/\nin vec4 a_texCoord;\nin vec3 a_origin;\nin vec3 a_tangent;\nin vec3 a_up;\n\n#endif\n\n\nuniform mat4 u_viewProjection;\nuniform vec2 u_ndcOffset;\nuniform mat4 u_transform;\nuniform bool u_dynamic;\n\nvarying vec2 v_uv;\n\n\nvoid ndcOffset(inout vec4 vertex, in vec2 offset) {\n    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\n}\n\n\n\nvoid main(void)\n{\n    /* TEXTURE COORDS */\n\n    /* flip y-coordinates */\n    vec2 texExt = vec2(a_texCoord[2] - a_texCoord[0], a_texCoord[1] - a_texCoord[3]);\n\n    v_uv = a_vertex * texExt + vec2(a_texCoord[0], 1.0 - a_texCoord[1]);\n\n    /* POSITIONING */\n    /* quad data as flat array: [0, 0,  0, 1,  1, 0,  1, 1] (a_vertex), which translates to ll, lr, ul, ur corners.\n     * 2-------4\n     * |  \\    |\n     * |    \\  |\n     * 1-------3\n     * The current vertex is calculated based on the current quad corners and the tangent attributes.\n     * The following lines are optimized for MAD optimization.\n     */\n    vec3 tangentDirection = a_origin + a_vertex.x * a_tangent;\n    vec4 vertex = vec4(tangentDirection + a_vertex.y * a_up, 1.0);\n\n    if(u_dynamic) {\n        vertex = u_transform * vertex;\n    }\n    vertex = u_viewProjection * vertex;\n\n    ndcOffset(vertex, u_ndcOffset);\n    gl_Position = vertex;\n}\n"},9130:t=>{"use strict";t.exports=e},5094:e=>{"use strict";e.exports=JSON.parse('{"id":"/ColorScalePresets","title":"Color Scale Presets Schema","description":"JSON schema for a color scale presets data, used in the webgl-operate module for validation.","type":"array","items":{"type":"object","properties":{"identifier":{"type":"string"},"type":{"type":"string","enum":["sequential","diverging","qualitative"]},"format":{"type":"string","enum":["rgb","rgbf"]},"colors":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}},"positions":{"type":"array","items":{"type":"array","items":{"type":["integer","number"]}}}},"required":["identifier","format","colors"],"additionalProperties":false}}')},5901:e=>{"use strict";e.exports=JSON.parse('{"kernel":[[[[0.201114,0.016597],[-0.090682,-0.219471],[-0.180852,0.162495],[0.055216,0.398563],[-0.41692,-0.073573],[0.291284,-0.365369],[0.437182,0.252665],[-0.32675,-0.455539]]]],"size":{"depth":1,"height":1,"width":8}}')},8646:e=>{"use strict";e.exports=JSON.parse('{"kernel":[[[[-0.992216,-0.610879],[-0.975957,0.625189],[-0.965904,-0.138743],[-0.949645,-0.902675],[-0.933385,0.333393],[-0.923332,-0.430539],[-0.907073,0.805529],[-0.89702,0.0415974],[-0.88076,-0.722335],[-0.864501,0.513733],[-0.854448,-0.250199],[-0.838189,0.985869],[-0.811876,0.221937],[-0.795617,-0.541995],[-0.785564,0.694073],[-0.769305,-0.0698586],[-0.753045,-0.833791],[-0.742992,0.402277],[-0.726733,-0.361655],[-0.70042,0.874413],[-0.684161,0.110482],[-0.674108,-0.65345],[-0.657849,0.582618],[-0.631536,-0.181314],[-0.615277,-0.945246],[-0.605224,0.290822],[-0.588964,-0.47311],[-0.572705,0.762958],[-0.562652,-0.000974417],[-0.546393,-0.764906],[-0.52008,0.471162],[-0.503821,-0.29277],[-0.493768,0.943298],[-0.477509,0.179366],[-0.461249,-0.584566],[-0.451196,0.651502],[-0.434937,-0.11243],[-0.424884,-0.876362],[-0.408624,0.359706],[-0.392365,-0.404226],[-0.382312,0.831842],[-0.366053,0.0679097],[-0.33974,-0.696022],[-0.323481,0.540046],[-0.313428,-0.223886],[-0.297168,-0.987818],[-0.280909,0.24825],[-0.270856,-0.515682],[-0.254597,0.720386],[-0.228284,-0.0435462],[-0.212025,-0.807478],[-0.201972,0.42859],[-0.185713,-0.335342],[-0.169453,0.900726],[-0.1594,0.136794],[-0.143141,-0.627138],[-0.133088,0.60893],[-0.116828,-0.155002],[-0.100569,-0.918934],[-0.0905161,0.317134],[-0.0742567,-0.446798],[-0.0479443,0.78927],[-0.0316849,0.0253379],[-0.021632,-0.738594],[-0.00537252,0.497474],[0.0108869,-0.266458],[0.0209398,0.96961],[0.0371993,0.205678],[0.0635116,-0.558254],[0.079771,0.677814],[0.089824,-0.086118],[0.106083,-0.85005],[0.132396,0.386018],[0.148655,-0.377914],[0.158708,0.858154],[0.174968,0.0942221],[0.191227,-0.66971],[0.20128,0.566358],[0.217539,-0.197574],[0.243852,-0.961506],[0.260111,0.274562],[0.270164,-0.48937],[0.286423,0.746698],[0.302683,-0.0172338],[0.312736,-0.781166],[0.328995,0.454902],[0.339048,-0.30903],[0.355308,0.927038],[0.371567,0.163106],[0.38162,-0.600826],[0.397879,0.635242],[0.424192,-0.12869],[0.440451,-0.892622],[0.450504,0.343446],[0.466763,-0.420486],[0.483023,0.815582],[0.493076,0.0516503],[0.509335,-0.712282],[0.535648,0.523786],[0.551907,-0.240146],[0.56196,0.995922],[0.578219,0.23199],[0.604532,-0.531942],[0.620791,0.704126],[0.630844,-0.0598056],[0.647104,-0.823738],[0.663363,0.41233],[0.673416,-0.351602],[0.689675,0.884466],[0.715988,0.120534],[0.732247,-0.643398],[0.7423,0.59267],[0.758559,-0.171262],[0.774819,-0.935194],[0.784872,0.300874],[0.801131,-0.463058],[0.811184,0.77301],[0.827444,0.0090785],[0.843703,-0.754853],[0.853756,0.481215],[0.870015,-0.282717],[0.896328,0.953351],[0.912587,0.189419],[0.92264,-0.574513],[0.9389,0.661555],[0.955159,-0.102377],[0.965212,-0.866309],[0.981471,0.369759]]]],"size":{"depth":1,"height":1,"width":128}}')},7355:e=>{"use strict";e.exports=JSON.parse('{"kernel":[[[[-0.058976,0.021042],[0.065636,-0.034686],[0.023064,0.111212],[-0.011378,-0.124856],[-0.122834,-0.069128],[0.155806,0.055484],[-0.170432,0.07677],[-0.101548,0.16694],[0.190248,-0.090414],[0.121364,-0.180584],[0.100078,0.201382],[-0.080262,-0.215026],[-0.247446,-0.0134],[-0.024534,0.25711],[-0.204874,-0.159298],[0.267262,-0.000244],[0.22469,0.145654],[0.031194,-0.270754],[-0.213004,0.222668],[-0.303174,0.132498],[0.245976,-0.236312],[-0.13599,0.312838],[0.177092,0.291552],[-0.157276,-0.305196],[0.31486,-0.146142],[0.04435,0.34728],[-0.337616,-0.10357],[-0.04582,-0.360924],[0.168962,-0.326482],[0.357432,0.089926],[-0.372058,0.042328],[-0.281888,-0.249468],[0.301704,0.235824],[-0.067106,0.403008],[0.40503,-0.055972],[0.078792,-0.416652],[-0.350772,0.278396],[-0.4065,-0.19374],[-0.260602,0.368566],[-0.449072,-0.047842],[-0.22616,-0.395366],[0.13452,0.43745],[0.259132,0.381722],[0.426316,0.180096],[-0.114704,-0.451094],[-0.427786,0.188226],[0.370588,-0.29204],[0.280418,-0.38221],[0.482044,0.034198],[0.447602,-0.20187],[0.009908,0.493178],[-0.358902,-0.339638],[-0.191718,0.458736],[-0.49667,0.098056],[0.391874,0.325994],[0.211534,-0.47238],[-0.483514,-0.28391],[-0.462228,0.334124],[-0.393344,0.424294],[0.336146,0.471892],[-0.31633,-0.485536],[0.41316,-0.437938],[-0.440942,-0.429808],[0.460758,0.416164]]]],"size":{"depth":1,"height":1,"width":64}}')},6799:e=>{"use strict";e.exports=JSON.parse('[{"identifier":"chrome-63","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{"identifier":"edge-41","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{"identifier":"ie-11","backend":"webgl1","extensions_strive":["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{"identifier":"firefox-57","backend":"webgl2","extensions_strive":["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{"identifier":"safari-10.1","backend":"webgl1","extensions_strive":["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],"functions_undefine":["readBuffer"]},{"identifier":"no-WEBGL_draw_buffers","backend":"webgl1","extensions_conceal":["WEBGL_draw_buffers"]},{"identifier":"no-readBuffer","extensions_hash":"100000","functions_undefine":["readBuffer"]},{"identifier":"webgl1","extensions_hash":"1+++++"},{"identifier":"webgl2","extensions_hash":"2+++++"}]')}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var s=r[e]={exports:{}};return t[e].call(s.exports,s,s.exports,i),s.exports}return i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(5254),i(9515)})()));
//# sourceMappingURL=webgl-operate.js.map