{"version":3,"file":"canvassize-example.js","mappings":"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","sources":["webpack:///webpack/universalModuleDefinition","webpack:///./example.ts","webpack:///external umd \"gloperate\"","webpack:///webpack/bootstrap","webpack:///./canvassize-example.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"gloperate\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"gloperate\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"gloperate\")) : factory(root[\"gloperate\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__4160__) => {\nreturn ","\n/* spellchecker: disable */\n\nimport {\n    Canvas,\n    Initializable,\n    LoadingStatus,\n    Renderer,\n    viewer,\n} from 'webgl-operate';\n\n/* spellchecker: enable */\n\n\nexport abstract class Example extends Initializable {\n\n    /**\n     * Hide the loading spinner.\n     */\n    protected showSpinner(): void {\n        const spinnerElement = document.getElementsByClassName('spinner').item(0)!;\n        (spinnerElement as HTMLElement).style.display = 'inline';\n    }\n\n    /**\n     * Hide the loading spinner.\n     */\n    protected hideSpinner(): void {\n        const spinnerElement = document.getElementsByClassName('spinner').item(0)!;\n        (spinnerElement as HTMLElement).style.display = 'none';\n    }\n\n    protected expose(): void {\n\n        (window as any)['canvas'] = this.canvas;\n        (window as any)['context'] = this.canvas.context;\n        (window as any)['controller'] = this.canvas.controller;\n\n        (window as any)['renderer'] = this.renderer;\n    }\n\n    initialize(element: HTMLCanvasElement | string): boolean {\n        const result = this.onInitialize(element);\n\n        this.renderer.loadingStatus$.subscribe((status: LoadingStatus) => {\n            if (status === LoadingStatus.Finished) {\n                this.hideSpinner();\n            } else if (status === LoadingStatus.Started) {\n                this.showSpinner();\n            }\n        });\n\n        this.expose();\n\n        return result;\n    }\n\n    uninitialize(): void {\n        this.onUninitialize();\n    }\n\n    abstract onInitialize(element: HTMLCanvasElement | string): boolean;\n\n    abstract onUninitialize(): void;\n\n    abstract get renderer(): Renderer;\n\n    abstract get canvas(): Canvas;\n\n    enableFullscreenOnCtrlClick(): void {\n\n        const e = this.canvas.element;\n        e.addEventListener('click', (event) => {\n            if (event.ctrlKey) { viewer.Fullscreen.toggle(e); }\n        });\n    }\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__4160__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\n/* spellchecker: disable */\n\nimport {\n    Canvas,\n    Context,\n    DefaultFramebuffer,\n    Invalidate,\n    NdcFillingTriangle,\n    Program,\n    Shader,\n    Renderer,\n    Wizard,\n} from 'webgl-operate';\n\nimport { Example } from './example';\n\n/* spellchecker: enable */\n\n// tslint:disable:max-classes-per-file\n\n\nclass CanvasSizeRenderer extends Renderer {\n\n    protected static readonly SHADER_SOURCE_VERT: string =\n        `precision lowp float;\n\n#if __VERSION__ == 100\n    attribute vec2 a_vertex;\n#else\n    in vec2 a_vertex;\n    #define varying out\n#endif\n\nvarying vec2 v_uv;\n\nvoid main(void)\n{\n    v_uv = a_vertex * 0.5 + 0.5;\n    gl_Position = vec4(a_vertex, 0.0, 1.0);\n}\n`;\n\n    protected static readonly SHADER_SOURCE_FRAG: string =\n        `precision highp float;\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n    #define varying in\n#endif\n\nvarying vec2 v_uv;\n\nconst float CELL_WIDTH = 1.0 / 64.0;\n\nvoid main(void)\n{\n    vec3 x3 = vec3(gl_FragCoord.x) + vec3(0.0, 1.0, 2.0);\n    vec3 y3 = vec3(gl_FragCoord.y) + vec3(0.0, 1.0, 2.0);\n\n    vec3 x = step(mod(x3, vec3(3.0)), vec3(1.0));\n    vec3 y = step(mod(y3, vec3(3.0)), vec3(1.0));\n\n    float cell = step(mod(gl_FragCoord.x * CELL_WIDTH + floor(gl_FragCoord.y * CELL_WIDTH), 2.0), 1.0);\n    fragColor = vec4(mix(x, y, cell), 1.0);\n}\n`;\n\n\n    protected _extensions = false;\n\n    protected _defaultFBO: DefaultFramebuffer;\n\n    protected _ndcTriangle: NdcFillingTriangle;\n\n    protected _program: Program;\n\n\n    /**\n     * Initializes and sets up rendering passes, navigation, loads a font face and links shaders with program.\n     * @param context - valid context to create the object for.\n     * @param identifier - meaningful name for identification of this instance.\n     * @param mouseEventProvider - required for mouse interaction\n     * @returns - whether initialization was successful\n     */\n    protected onInitialize(context: Context, callback: Invalidate,\n        /* eventProvider: EventProvider */): boolean {\n\n        /* Create framebuffers, textures, and render buffers. */\n\n        this._defaultFBO = new DefaultFramebuffer(this._context, 'DefaultFBO');\n        this._defaultFBO.initialize();\n        this._defaultFBO.bind();\n\n        /* Create and configure canvas-size test pattern pass. */\n\n        const gl = this._context.gl;\n\n        this._ndcTriangle = new NdcFillingTriangle(this._context, 'NdcFillingTriangle');\n        this._ndcTriangle.initialize();\n\n        const vert = new Shader(this._context, gl.VERTEX_SHADER, 'ndcvertices (in-line)');\n        vert.initialize(CanvasSizeRenderer.SHADER_SOURCE_VERT);\n        const frag = new Shader(this._context, gl.FRAGMENT_SHADER, 'pattern (in-line)');\n        frag.initialize(CanvasSizeRenderer.SHADER_SOURCE_FRAG);\n\n        this._program = new Program(this._context, 'CanvasSizeProgram');\n        this._program.initialize([vert, frag], false);\n\n        this._program.attribute('a_vertex', this._ndcTriangle.vertexLocation);\n        this._program.link();\n\n        this.finishLoading();\n\n        return true;\n    }\n\n    /**\n     * Uninitializes Buffers, Textures, and Program.\n     */\n    protected onUninitialize(): void {\n        super.uninitialize();\n\n        this._ndcTriangle.uninitialize();\n        this._program.uninitialize();\n\n        this._defaultFBO.uninitialize();\n    }\n\n    protected onDiscarded(): void {\n        this._altered.alter('canvasSize');\n        this._altered.alter('clearColor');\n        this._altered.alter('frameSize');\n    }\n\n    /**\n     * This is invoked in order to check if rendering of a frame is required by means of implementation specific\n     * evaluation (e.g., lazy non continuous rendering). Regardless of the return value a new frame (preparation,\n     * frame, swap) might be invoked anyway, e.g., when update is forced or canvas or context properties have\n     * changed or the renderer was invalidated @see{@link invalidate}.\n     * @returns whether to redraw\n     */\n    protected onUpdate(): boolean {\n\n        return this._altered.any;\n    }\n\n    /**\n     * This is invoked in order to prepare rendering of one or more frames, regarding multi-frame rendering and\n     * camera-updates.\n     */\n    protected onPrepare(): void {\n\n        // if (this._altered.canvasSize) {\n        //     this._camera.aspect = this._canvasSize[0] / this._canvasSize[1];\n        //     this._camera.viewport = this._canvasSize;\n        // }\n\n        if (this._altered.clearColor) {\n            this._defaultFBO.clearColor(this._clearColor);\n        }\n\n        this._altered.reset();\n    }\n\n    /**\n     * After (1) update and (2) preparation are invoked, a frame is invoked. Renders both 2D and 3D labels.\n     * @param frameNumber - for intermediate frames in accumulation rendering\n     */\n    protected onFrame(/*frameNumber: number*/): void {\n        const gl = this._context.gl;\n\n        gl.viewport(0, 0, this._canvasSize[0], this._canvasSize[1]);\n\n        this._defaultFBO.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT, false, false);\n\n        this._program.bind();\n\n        this._ndcTriangle.bind();\n        this._ndcTriangle.draw();\n        this._ndcTriangle.unbind();\n\n    }\n\n}\n\n\nexport class CanvasSizeExample extends Example {\n\n    private _canvas: Canvas;\n    private _renderer: CanvasSizeRenderer;\n\n    onInitialize(element: HTMLCanvasElement | string): boolean {\n\n        this._canvas = new Canvas(element, { antialias: false });\n        this._canvas.controller.multiFrameNumber = 1;\n        this._canvas.framePrecision = Wizard.Precision.byte;\n        this._canvas.frameScale = [1.0, 1.0];\n\n        this._renderer = new CanvasSizeRenderer();\n        this._canvas.renderer = this._renderer;\n\n        return true;\n    }\n\n    onUninitialize(): void {\n        this._canvas.dispose();\n        (this._renderer as Renderer).uninitialize();\n    }\n\n    get canvas(): Canvas {\n        return this._canvas;\n    }\n\n    get renderer(): CanvasSizeRenderer {\n        return this._renderer;\n    }\n\n}\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__4160__","Example","Initializable","showSpinner","document","getElementsByClassName","item","style","display","hideSpinner","expose","window","this","canvas","context","controller","renderer","initialize","element","result","onInitialize","loadingStatus$","subscribe","status","LoadingStatus","Finished","Started","uninitialize","onUninitialize","enableFullscreenOnCtrlClick","e","addEventListener","event","ctrlKey","viewer","Fullscreen","toggle","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","CanvasSizeRenderer","Renderer","_extensions","callback","_defaultFBO","DefaultFramebuffer","_context","bind","gl","_ndcTriangle","NdcFillingTriangle","vert","Shader","VERTEX_SHADER","SHADER_SOURCE_VERT","frag","FRAGMENT_SHADER","SHADER_SOURCE_FRAG","_program","Program","attribute","vertexLocation","link","finishLoading","super","onDiscarded","_altered","alter","onUpdate","any","onPrepare","clearColor","_clearColor","reset","onFrame","viewport","_canvasSize","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","draw","unbind","CanvasSizeExample","_canvas","Canvas","antialias","multiFrameNumber","framePrecision","Wizard","Precision","byte","frameScale","_renderer","dispose"],"sourceRoot":""}